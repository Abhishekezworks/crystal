%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/relay/conditionNodeId"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 16, 19, 18, 144, 124<br /><br />ROOT Connectionᐸ12ᐳ[18]<br />1: PgSelect[52]<br />ᐳ: Access[145]<br />2: PgSelectRows[60]"):::bucket
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 16, 30, 29, 148, 124<br /><br />ROOT Connectionᐸ26ᐳ[29]<br />1: PgSelect[54]<br />ᐳ: Access[149]<br />2: PgSelectRows[63]"):::bucket
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 16, 39, 38, 156, 124<br /><br />ROOT Connectionᐸ35ᐳ[38]<br />1: PgSelect[56]<br />ᐳ: Access[157]<br />2: PgSelectRows[66]"):::bucket
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 16, 50, 49, 152, 124<br /><br />ROOT Connectionᐸ46ᐳ[49]<br />1: PgSelect[58]<br />ᐳ: Access[153]<br />2: PgSelectRows[69]"):::bucket
    Bucket5("Bucket 5 (listItem)<br />Deps: 145, 124<br /><br />ROOT __Item{5}ᐸ60ᐳ[61]"):::bucket
    Bucket6("Bucket 6 (listItem)<br />Deps: 149, 124<br /><br />ROOT __Item{6}ᐸ63ᐳ[64]"):::bucket
    Bucket7("Bucket 7 (listItem)<br />Deps: 157, 124<br /><br />ROOT __Item{7}ᐸ66ᐳ[67]"):::bucket
    Bucket8("Bucket 8 (listItem)<br />Deps: 153, 124<br /><br />ROOT __Item{8}ᐸ69ᐳ[70]"):::bucket
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 62, 145, 124<br /><br />ROOT PgSelectSingle{5}ᐸpostᐳ[62]<br />1: <br />ᐳ: 84, 146, 147<br />2: PgSelectRows[81]<br />ᐳ: First[80], PgSelectSingle[83]"):::bucket
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 65, 149, 124<br /><br />ROOT PgSelectSingle{6}ᐸpostᐳ[65]<br />1: <br />ᐳ: 97, 150, 151<br />2: PgSelectRows[94]<br />ᐳ: First[93], PgSelectSingle[96]"):::bucket
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 68, 157, 124<br /><br />ROOT PgSelectSingle{7}ᐸpostᐳ[68]<br />1: <br />ᐳ: 110, 158, 159<br />2: PgSelectRows[107]<br />ᐳ: First[106], PgSelectSingle[109]"):::bucket
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 71, 153, 124<br /><br />ROOT PgSelectSingle{8}ᐸpostᐳ[71]<br />1: <br />ᐳ: 123, 154, 155<br />2: PgSelectRows[120]<br />ᐳ: First[119], PgSelectSingle[122]"):::bucket
    Bucket13("Bucket 13 (nullableBoundary)<br />Deps: 83, 124<br /><br />ROOT PgSelectSingle{9}ᐸpersonᐳ[83]"):::bucket
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 96, 124<br /><br />ROOT PgSelectSingle{10}ᐸpersonᐳ[96]"):::bucket
    Bucket15("Bucket 15 (nullableBoundary)<br />Deps: 109, 124<br /><br />ROOT PgSelectSingle{11}ᐸpersonᐳ[109]"):::bucket
    Bucket16("Bucket 16 (nullableBoundary)<br />Deps: 122, 124<br /><br />ROOT PgSelectSingle{12}ᐸpersonᐳ[122]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4
    Bucket1 --> Bucket5
    Bucket2 --> Bucket6
    Bucket3 --> Bucket7
    Bucket4 --> Bucket8
    Bucket5 --> Bucket9
    Bucket6 --> Bucket10
    Bucket7 --> Bucket11
    Bucket8 --> Bucket12
    Bucket9 --> Bucket13
    Bucket10 --> Bucket14
    Bucket11 --> Bucket15
    Bucket12 --> Bucket16

    %% plan dependencies
    __InputObject7{{"__InputObject[7∈0] ➊"}}:::plan
    Access8{{"Access[8∈0] ➊<br />ᐸ0.undefinedᐳ"}}:::plan
    Access8 --> __InputObject7
    Object16{{"Object[16∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access15{{"Access[15∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access13 & Access15 --> Object16
    __InputObject21{{"__InputObject[21∈0] ➊"}}:::plan
    Access22{{"Access[22∈0] ➊<br />ᐸ0.aliceᐳ"}}:::plan
    Access22 --> __InputObject21
    __InputObject32{{"__InputObject[32∈0] ➊"}}:::plan
    Constant33{{"Constant[33∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant33 --> __InputObject32
    __InputObject41{{"__InputObject[41∈0] ➊"}}:::plan
    Access42{{"Access[42∈0] ➊<br />ᐸ0.post3ᐳ"}}:::plan
    Access42 --> __InputObject41
    __Value0["__Value[0∈0] ➊<br />ᐸvariableValuesᐳ"]:::plan
    __Value0 --> Access8
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access13
    __Value2 --> Access15
    ApplyInput19{{"ApplyInput[19∈0] ➊"}}:::plan
    __InputObject7 --> ApplyInput19
    __Value0 --> Access22
    ApplyInput30{{"ApplyInput[30∈0] ➊"}}:::plan
    __InputObject21 --> ApplyInput30
    ApplyInput39{{"ApplyInput[39∈0] ➊"}}:::plan
    __InputObject32 --> ApplyInput39
    __Value0 --> Access42
    ApplyInput50{{"ApplyInput[50∈0] ➊"}}:::plan
    __InputObject41 --> ApplyInput50
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Connection18{{"Connection[18∈0] ➊<br />ᐸ12ᐳ"}}:::plan
    Connection29{{"Connection[29∈0] ➊<br />ᐸ26ᐳ"}}:::plan
    Connection38{{"Connection[38∈0] ➊<br />ᐸ35ᐳ"}}:::plan
    Connection49{{"Connection[49∈0] ➊<br />ᐸ46ᐳ"}}:::plan
    Constant124{{"Constant[124∈0] ➊<br />ᐸ'people'ᐳ"}}:::plan
    PgSelectInlineApply144["PgSelectInlineApply[144∈0] ➊"]:::plan
    PgSelectInlineApply148["PgSelectInlineApply[148∈0] ➊"]:::plan
    PgSelectInlineApply152["PgSelectInlineApply[152∈0] ➊"]:::plan
    PgSelectInlineApply156["PgSelectInlineApply[156∈0] ➊"]:::plan
    PgSelect52[["PgSelect[52∈1] ➊<br />ᐸpostᐳ"]]:::plan
    Object16 & ApplyInput19 & Connection18 & PgSelectInlineApply144 --> PgSelect52
    PgSelectRows60[["PgSelectRows[60∈1] ➊"]]:::plan
    PgSelect52 --> PgSelectRows60
    Access145{{"Access[145∈1] ➊<br />ᐸ52.m.joinDetailsFor73ᐳ"}}:::plan
    PgSelect52 --> Access145
    __Item61[/"__Item[61∈5]<br />ᐸ60ᐳ"\]:::itemplan
    PgSelectRows60 ==> __Item61
    PgSelectSingle62{{"PgSelectSingle[62∈5]<br />ᐸpostᐳ"}}:::plan
    __Item61 --> PgSelectSingle62
    List146{{"List[146∈9]<br />ᐸ145,62ᐳ"}}:::plan
    Access145 & PgSelectSingle62 --> List146
    First80{{"First[80∈9]"}}:::plan
    PgSelectRows81[["PgSelectRows[81∈9]"]]:::plan
    PgSelectRows81 --> First80
    Lambda147{{"Lambda[147∈9]<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda147 --> PgSelectRows81
    PgSelectSingle83{{"PgSelectSingle[83∈9]<br />ᐸpersonᐳ"}}:::plan
    First80 --> PgSelectSingle83
    PgClassExpression84{{"PgClassExpression[84∈9]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle62 --> PgClassExpression84
    List146 --> Lambda147
    List126{{"List[126∈13]<br />ᐸ124,125ᐳ"}}:::plan
    PgClassExpression125{{"PgClassExpression[125∈13]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant124 & PgClassExpression125 --> List126
    PgSelectSingle83 --> PgClassExpression125
    Lambda127{{"Lambda[127∈13]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List126 --> Lambda127
    PgSelect54[["PgSelect[54∈2] ➊<br />ᐸpostᐳ"]]:::plan
    Object16 & ApplyInput30 & Connection29 & PgSelectInlineApply148 --> PgSelect54
    PgSelectRows63[["PgSelectRows[63∈2] ➊"]]:::plan
    PgSelect54 --> PgSelectRows63
    Access149{{"Access[149∈2] ➊<br />ᐸ54.m.joinDetailsFor86ᐳ"}}:::plan
    PgSelect54 --> Access149
    __Item64[/"__Item[64∈6]<br />ᐸ63ᐳ"\]:::itemplan
    PgSelectRows63 ==> __Item64
    PgSelectSingle65{{"PgSelectSingle[65∈6]<br />ᐸpostᐳ"}}:::plan
    __Item64 --> PgSelectSingle65
    List150{{"List[150∈10]<br />ᐸ149,65ᐳ"}}:::plan
    Access149 & PgSelectSingle65 --> List150
    First93{{"First[93∈10]"}}:::plan
    PgSelectRows94[["PgSelectRows[94∈10]"]]:::plan
    PgSelectRows94 --> First93
    Lambda151{{"Lambda[151∈10]<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda151 --> PgSelectRows94
    PgSelectSingle96{{"PgSelectSingle[96∈10]<br />ᐸpersonᐳ"}}:::plan
    First93 --> PgSelectSingle96
    PgClassExpression97{{"PgClassExpression[97∈10]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression97
    List150 --> Lambda151
    List131{{"List[131∈14]<br />ᐸ124,130ᐳ"}}:::plan
    PgClassExpression130{{"PgClassExpression[130∈14]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant124 & PgClassExpression130 --> List131
    PgSelectSingle96 --> PgClassExpression130
    Lambda132{{"Lambda[132∈14]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List131 --> Lambda132
    PgSelect56[["PgSelect[56∈3] ➊<br />ᐸpostᐳ"]]:::plan
    Object16 & ApplyInput39 & Connection38 & PgSelectInlineApply156 --> PgSelect56
    PgSelectRows66[["PgSelectRows[66∈3] ➊"]]:::plan
    PgSelect56 --> PgSelectRows66
    Access157{{"Access[157∈3] ➊<br />ᐸ56.m.joinDetailsFor99ᐳ"}}:::plan
    PgSelect56 --> Access157
    __Item67[/"__Item[67∈7]<br />ᐸ66ᐳ"\]:::itemplan
    PgSelectRows66 ==> __Item67
    PgSelectSingle68{{"PgSelectSingle[68∈7]<br />ᐸpostᐳ"}}:::plan
    __Item67 --> PgSelectSingle68
    List158{{"List[158∈11]<br />ᐸ157,68ᐳ"}}:::plan
    Access157 & PgSelectSingle68 --> List158
    First106{{"First[106∈11]"}}:::plan
    PgSelectRows107[["PgSelectRows[107∈11]"]]:::plan
    PgSelectRows107 --> First106
    Lambda159{{"Lambda[159∈11]<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda159 --> PgSelectRows107
    PgSelectSingle109{{"PgSelectSingle[109∈11]<br />ᐸpersonᐳ"}}:::plan
    First106 --> PgSelectSingle109
    PgClassExpression110{{"PgClassExpression[110∈11]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression110
    List158 --> Lambda159
    List136{{"List[136∈15]<br />ᐸ124,135ᐳ"}}:::plan
    PgClassExpression135{{"PgClassExpression[135∈15]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant124 & PgClassExpression135 --> List136
    PgSelectSingle109 --> PgClassExpression135
    Lambda137{{"Lambda[137∈15]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List136 --> Lambda137
    PgSelect58[["PgSelect[58∈4] ➊<br />ᐸpostᐳ"]]:::plan
    Object16 & ApplyInput50 & Connection49 & PgSelectInlineApply152 --> PgSelect58
    PgSelectRows69[["PgSelectRows[69∈4] ➊"]]:::plan
    PgSelect58 --> PgSelectRows69
    Access153{{"Access[153∈4] ➊<br />ᐸ58.m.joinDetailsFor112ᐳ"}}:::plan
    PgSelect58 --> Access153
    __Item70[/"__Item[70∈8]<br />ᐸ69ᐳ"\]:::itemplan
    PgSelectRows69 ==> __Item70
    PgSelectSingle71{{"PgSelectSingle[71∈8]<br />ᐸpostᐳ"}}:::plan
    __Item70 --> PgSelectSingle71
    List154{{"List[154∈12]<br />ᐸ153,71ᐳ"}}:::plan
    Access153 & PgSelectSingle71 --> List154
    First119{{"First[119∈12]"}}:::plan
    PgSelectRows120[["PgSelectRows[120∈12]"]]:::plan
    PgSelectRows120 --> First119
    Lambda155{{"Lambda[155∈12]<br />ᐸpgInlineViaJoinTransformᐳ"}}:::plan
    Lambda155 --> PgSelectRows120
    PgSelectSingle122{{"PgSelectSingle[122∈12]<br />ᐸpersonᐳ"}}:::plan
    First119 --> PgSelectSingle122
    PgClassExpression123{{"PgClassExpression[123∈12]<br />ᐸ__post__.”body”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression123
    List154 --> Lambda155
    List141{{"List[141∈16]<br />ᐸ124,140ᐳ"}}:::plan
    PgClassExpression140{{"PgClassExpression[140∈16]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    Constant124 & PgClassExpression140 --> List141
    PgSelectSingle122 --> PgClassExpression140
    Lambda142{{"Lambda[142∈16]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List141 --> Lambda142

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value2,__Value4,__InputObject7,Access8,Access13,Access15,Object16,Connection18,ApplyInput19,__InputObject21,Access22,Connection29,ApplyInput30,__InputObject32,Constant33,Connection38,ApplyInput39,__InputObject41,Access42,Connection49,ApplyInput50,Constant124,PgSelectInlineApply144,PgSelectInlineApply148,PgSelectInlineApply152,PgSelectInlineApply156 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect52,PgSelectRows60,Access145 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgSelect54,PgSelectRows63,Access149 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect56,PgSelectRows66,Access157 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect58,PgSelectRows69,Access153 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item61,PgSelectSingle62 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item64,PgSelectSingle65 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item67,PgSelectSingle68 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item70,PgSelectSingle71 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,First80,PgSelectRows81,PgSelectSingle83,PgClassExpression84,List146,Lambda147 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,First93,PgSelectRows94,PgSelectSingle96,PgClassExpression97,List150,Lambda151 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,First106,PgSelectRows107,PgSelectSingle109,PgClassExpression110,List158,Lambda159 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12,First119,PgSelectRows120,PgSelectSingle122,PgClassExpression123,List154,Lambda155 bucket12
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgClassExpression125,List126,Lambda127 bucket13
    classDef bucket14 stroke:#a52a2a
    class Bucket14,PgClassExpression130,List131,Lambda132 bucket14
    classDef bucket15 stroke:#ff00ff
    class Bucket15,PgClassExpression135,List136,Lambda137 bucket15
    classDef bucket16 stroke:#f5deb3
    class Bucket16,PgClassExpression140,List141,Lambda142 bucket16

