%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef sideeffectplan fill:#f00,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% define steps
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    __InputStaticLeaf17["__InputStaticLeaf[17∈0]"]:::plan
    Access21["Access[21∈0]<br />ᐸ3.pgSettingsᐳ"]:::plan
    Access22["Access[22∈0]<br />ᐸ3.withPgClientᐳ"]:::plan
    Object23["Object[23∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"]:::plan
    Connection24["Connection[24∈0]<br />ᐸ20ᐳ"]:::plan
    PgPageInfo25["PgPageInfo[25∈0]"]:::plan
    PgSelect26[["PgSelect[26∈0]<br />ᐸnetworkᐳ"]]:::plan
    First27["First[27∈0]"]:::plan
    PgSelectSingle28["PgSelectSingle[28∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression30["PgClassExpression[30∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List31["List[31∈0]<br />ᐸ30ᐳ"]:::plan
    PgCursor29["PgCursor[29∈0]"]:::plan
    Last33["Last[33∈0]"]:::plan
    PgSelectSingle34["PgSelectSingle[34∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression36["PgClassExpression[36∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List37["List[37∈0]<br />ᐸ36ᐳ"]:::plan
    PgCursor35["PgCursor[35∈0]"]:::plan
    Constant38["Constant[38∈0]"]:::plan
    Constant39["Constant[39∈0]"]:::plan
    PgSelect40[["PgSelect[40∈0]<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    First41["First[41∈0]"]:::plan
    PgSelectSingle42["PgSelectSingle[42∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression43["PgClassExpression[43∈0]<br />ᐸcount(*)ᐳ"]:::plan
    __Item45>"__Item[45∈1]<br />ᐸ26ᐳ"]:::itemplan
    PgSelectSingle46["PgSelectSingle[46∈1]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression48["PgClassExpression[48∈1]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List49["List[49∈1]<br />ᐸ48ᐳ"]:::plan
    PgCursor47["PgCursor[47∈1]"]:::plan
    PgClassExpression51["PgClassExpression[51∈1]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression52["PgClassExpression[52∈1]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression53["PgClassExpression[53∈1]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan
    __InputStaticLeaf65["__InputStaticLeaf[65∈0]"]:::plan
    Connection71["Connection[71∈0]<br />ᐸ67ᐳ"]:::plan
    PgPageInfo72["PgPageInfo[72∈0]"]:::plan
    PgSelect73[["PgSelect[73∈0]<br />ᐸnetworkᐳ"]]:::plan
    First74["First[74∈0]"]:::plan
    PgSelectSingle75["PgSelectSingle[75∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression77["PgClassExpression[77∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List78["List[78∈0]<br />ᐸ77ᐳ"]:::plan
    PgCursor76["PgCursor[76∈0]"]:::plan
    Last80["Last[80∈0]"]:::plan
    PgSelectSingle81["PgSelectSingle[81∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression83["PgClassExpression[83∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List84["List[84∈0]<br />ᐸ83ᐳ"]:::plan
    PgCursor82["PgCursor[82∈0]"]:::plan
    Constant85["Constant[85∈0]"]:::plan
    Constant86["Constant[86∈0]"]:::plan
    PgSelect87[["PgSelect[87∈0]<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    First88["First[88∈0]"]:::plan
    PgSelectSingle89["PgSelectSingle[89∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression90["PgClassExpression[90∈0]<br />ᐸcount(*)ᐳ"]:::plan
    __Item92>"__Item[92∈2]<br />ᐸ73ᐳ"]:::itemplan
    PgSelectSingle93["PgSelectSingle[93∈2]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression95["PgClassExpression[95∈2]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List96["List[96∈2]<br />ᐸ95ᐳ"]:::plan
    PgCursor94["PgCursor[94∈2]"]:::plan
    PgClassExpression98["PgClassExpression[98∈2]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression99["PgClassExpression[99∈2]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression100["PgClassExpression[100∈2]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan
    __InputStaticLeaf113["__InputStaticLeaf[113∈0]"]:::plan
    Connection118["Connection[118∈0]<br />ᐸ114ᐳ"]:::plan
    PgPageInfo119["PgPageInfo[119∈0]"]:::plan
    PgSelect120[["PgSelect[120∈0]<br />ᐸnetworkᐳ"]]:::plan
    First121["First[121∈0]"]:::plan
    PgSelectSingle122["PgSelectSingle[122∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression124["PgClassExpression[124∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List125["List[125∈0]<br />ᐸ124ᐳ"]:::plan
    PgCursor123["PgCursor[123∈0]"]:::plan
    Last127["Last[127∈0]"]:::plan
    PgSelectSingle128["PgSelectSingle[128∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression130["PgClassExpression[130∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List131["List[131∈0]<br />ᐸ130ᐳ"]:::plan
    PgCursor129["PgCursor[129∈0]"]:::plan
    Constant132["Constant[132∈0]"]:::plan
    Constant133["Constant[133∈0]"]:::plan
    PgSelect134[["PgSelect[134∈0]<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    First135["First[135∈0]"]:::plan
    PgSelectSingle136["PgSelectSingle[136∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression137["PgClassExpression[137∈0]<br />ᐸcount(*)ᐳ"]:::plan
    __Item139>"__Item[139∈3]<br />ᐸ120ᐳ"]:::itemplan
    PgSelectSingle140["PgSelectSingle[140∈3]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression142["PgClassExpression[142∈3]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List143["List[143∈3]<br />ᐸ142ᐳ"]:::plan
    PgCursor141["PgCursor[141∈3]"]:::plan
    PgClassExpression145["PgClassExpression[145∈3]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression146["PgClassExpression[146∈3]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression147["PgClassExpression[147∈3]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan

    %% plan dependencies
    __Value3 --> Access21
    __Value3 --> Access22
    Access21 & Access22 --> Object23
    Object23 & __InputStaticLeaf17 & Connection24 --> PgSelect26
    PgSelect26 --> First27
    First27 --> PgSelectSingle28
    PgSelectSingle28 --> PgClassExpression30
    PgClassExpression30 --> List31
    List31 --> PgCursor29
    PgSelect26 --> Last33
    Last33 --> PgSelectSingle34
    PgSelectSingle34 --> PgClassExpression36
    PgClassExpression36 --> List37
    List37 --> PgCursor35
    Object23 & __InputStaticLeaf17 & Connection24 --> PgSelect40
    PgSelect40 --> First41
    First41 --> PgSelectSingle42
    PgSelectSingle42 --> PgClassExpression43
    PgSelect26 ==> __Item45
    __Item45 --> PgSelectSingle46
    PgSelectSingle46 --> PgClassExpression48
    PgClassExpression48 --> List49
    List49 --> PgCursor47
    PgSelectSingle46 --> PgClassExpression51
    PgSelectSingle46 --> PgClassExpression52
    PgSelectSingle46 --> PgClassExpression53
    Object23 & __InputStaticLeaf65 & Connection71 --> PgSelect73
    PgSelect73 --> First74
    First74 --> PgSelectSingle75
    PgSelectSingle75 --> PgClassExpression77
    PgClassExpression77 --> List78
    List78 --> PgCursor76
    PgSelect73 --> Last80
    Last80 --> PgSelectSingle81
    PgSelectSingle81 --> PgClassExpression83
    PgClassExpression83 --> List84
    List84 --> PgCursor82
    Object23 & __InputStaticLeaf65 & Connection71 --> PgSelect87
    PgSelect87 --> First88
    First88 --> PgSelectSingle89
    PgSelectSingle89 --> PgClassExpression90
    PgSelect73 ==> __Item92
    __Item92 --> PgSelectSingle93
    PgSelectSingle93 --> PgClassExpression95
    PgClassExpression95 --> List96
    List96 --> PgCursor94
    PgSelectSingle93 --> PgClassExpression98
    PgSelectSingle93 --> PgClassExpression99
    PgSelectSingle93 --> PgClassExpression100
    Object23 & __InputStaticLeaf113 & Connection118 --> PgSelect120
    PgSelect120 --> First121
    First121 --> PgSelectSingle122
    PgSelectSingle122 --> PgClassExpression124
    PgClassExpression124 --> List125
    List125 --> PgCursor123
    PgSelect120 --> Last127
    Last127 --> PgSelectSingle128
    PgSelectSingle128 --> PgClassExpression130
    PgClassExpression130 --> List131
    List131 --> PgCursor129
    Object23 & __InputStaticLeaf113 & Connection118 --> PgSelect134
    PgSelect134 --> First135
    First135 --> PgSelectSingle136
    PgSelectSingle136 --> PgClassExpression137
    PgSelect120 ==> __Item139
    __Item139 --> PgSelectSingle140
    PgSelectSingle140 --> PgClassExpression142
    PgClassExpression142 --> List143
    List143 --> PgCursor141
    PgSelectSingle140 --> PgClassExpression145
    PgSelectSingle140 --> PgClassExpression146
    PgSelectSingle140 --> PgClassExpression147

    subgraph "Buckets for queries/v4/network_types"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value3,__Value5,__InputStaticLeaf17,Access21,Access22,Object23,Connection24,PgPageInfo25,PgSelect26,First27,PgSelectSingle28,PgCursor29,PgClassExpression30,List31,Last33,PgSelectSingle34,PgCursor35,PgClassExpression36,List37,Constant38,Constant39,PgSelect40,First41,PgSelectSingle42,PgClassExpression43,__InputStaticLeaf65,Connection71,PgPageInfo72,PgSelect73,First74,PgSelectSingle75,PgCursor76,PgClassExpression77,List78,Last80,PgSelectSingle81,PgCursor82,PgClassExpression83,List84,Constant85,Constant86,PgSelect87,First88,PgSelectSingle89,PgClassExpression90,__InputStaticLeaf113,Connection118,PgPageInfo119,PgSelect120,First121,PgSelectSingle122,PgCursor123,PgClassExpression124,List125,Last127,PgSelectSingle128,PgCursor129,PgClassExpression130,List131,Constant132,Constant133,PgSelect134,First135,PgSelectSingle136,PgClassExpression137 bucket0
    Bucket1("Bucket 1 (listItem)<br />ROOT __Item{1}ᐸ26ᐳ[45]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item45,PgSelectSingle46,PgCursor47,PgClassExpression48,List49,PgClassExpression51,PgClassExpression52,PgClassExpression53 bucket1
    Bucket2("Bucket 2 (listItem)<br />ROOT __Item{2}ᐸ73ᐳ[92]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item92,PgSelectSingle93,PgCursor94,PgClassExpression95,List96,PgClassExpression98,PgClassExpression99,PgClassExpression100 bucket2
    Bucket3("Bucket 3 (listItem)<br />ROOT __Item{3}ᐸ120ᐳ[139]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item139,PgSelectSingle140,PgCursor141,PgClassExpression142,List143,PgClassExpression145,PgClassExpression146,PgClassExpression147 bucket3
    Bucket0 --> Bucket1 & Bucket2 & Bucket3
    end
