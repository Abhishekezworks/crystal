%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/network_types"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 14, 17, 16, 6<br /><br />ROOT Connectionᐸ10ᐳ[16]<br />1: PgSelect[37], PgSelect[40]<br />ᐳ: 39, 88, 102, 104, 105, 111, 112<br />2: PgSelectRows[43], PgSelectRows[73]<br />ᐳ: 42, 45, 46, 84, 87, 90, 93, 95, 98"):::bucket
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 14, 26, 25, 6<br /><br />ROOT Connectionᐸ22ᐳ[25]<br />1: PgSelect[49], PgSelect[52]<br />ᐳ: 51, 120, 134, 136, 137, 143, 144<br />2: PgSelectRows[55], PgSelectRows[76]<br />ᐳ: 54, 57, 58, 116, 119, 122, 125, 127, 130"):::bucket
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 14, 35, 34, 6<br /><br />ROOT Connectionᐸ31ᐳ[34]<br />1: PgSelect[61], PgSelect[64]<br />ᐳ: 63, 152, 166, 168, 169, 175, 176<br />2: PgSelectRows[67], PgSelectRows[79]<br />ᐳ: 66, 69, 70, 148, 151, 154, 157, 159, 162"):::bucket
    Bucket4("Bucket 4 (listItem)<br />Deps: 88<br /><br />ROOT __Item{4}ᐸ73ᐳ[74]"):::bucket
    Bucket5("Bucket 5 (listItem)<br />Deps: 120<br /><br />ROOT __Item{5}ᐸ76ᐳ[77]"):::bucket
    Bucket6("Bucket 6 (listItem)<br />Deps: 152<br /><br />ROOT __Item{6}ᐸ79ᐳ[80]"):::bucket
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 75, 88<br /><br />ROOT PgSelectSingle{4}ᐸnetworkᐳ[75]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 78, 120<br /><br />ROOT PgSelectSingle{5}ᐸnetworkᐳ[78]"):::bucket
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 81, 152<br /><br />ROOT PgSelectSingle{6}ᐸnetworkᐳ[81]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3
    Bucket1 --> Bucket4
    Bucket2 --> Bucket5
    Bucket3 --> Bucket6
    Bucket4 --> Bucket7
    Bucket5 --> Bucket8
    Bucket6 --> Bucket9

    %% plan dependencies
    __InputObject7{{"__InputObject[7∈0] ➊"}}:::plan
    Constant199{{"Constant[199∈0] ➊<br />ᐸ'192.168.0.0'ᐳ"}}:::plan
    Constant199 --> __InputObject7
    Object14{{"Object[14∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access13 --> Object14
    __InputObject19{{"__InputObject[19∈0] ➊"}}:::plan
    Constant200{{"Constant[200∈0] ➊<br />ᐸ'192.168.0.0/16'ᐳ"}}:::plan
    Constant200 --> __InputObject19
    __InputObject28{{"__InputObject[28∈0] ➊"}}:::plan
    Constant201{{"Constant[201∈0] ➊<br />ᐸ'08:00:2b:01:02:03'ᐳ"}}:::plan
    Constant201 --> __InputObject28
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access13
    ApplyInput17{{"ApplyInput[17∈0] ➊"}}:::plan
    __InputObject7 --> ApplyInput17
    ApplyInput26{{"ApplyInput[26∈0] ➊"}}:::plan
    __InputObject19 --> ApplyInput26
    ApplyInput35{{"ApplyInput[35∈0] ➊"}}:::plan
    __InputObject28 --> ApplyInput35
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Connection16{{"Connection[16∈0] ➊<br />ᐸ10ᐳ"}}:::plan
    Connection25{{"Connection[25∈0] ➊<br />ᐸ22ᐳ"}}:::plan
    Connection34{{"Connection[34∈0] ➊<br />ᐸ31ᐳ"}}:::plan
    Object111{{"Object[111∈1] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access102{{"Access[102∈1] ➊<br />ᐸ37.hasMoreᐳ"}}:::plan
    Access102 --> Object111
    PgSelect37[["PgSelect[37∈1] ➊<br />ᐸnetwork+1ᐳ"]]:::plan
    Object14 & ApplyInput17 & Connection16 --> PgSelect37
    PgSelect40[["PgSelect[40∈1] ➊<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    Object14 & ApplyInput17 & Connection16 --> PgSelect40
    Object104{{"Object[104∈1] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Access102 --> Object104
    PgCursor90{{"PgCursor[90∈1] ➊"}}:::plan
    PgSelectSingle87{{"PgSelectSingle[87∈1] ➊<br />ᐸnetworkᐳ"}}:::plan
    Access88{{"Access[88∈1] ➊<br />ᐸ37.cursorDetailsᐳ"}}:::plan
    PgSelectSingle87 & Access88 --> PgCursor90
    PgCursor98{{"PgCursor[98∈1] ➊"}}:::plan
    PgSelectSingle95{{"PgSelectSingle[95∈1] ➊<br />ᐸnetworkᐳ"}}:::plan
    PgSelectSingle95 & Access88 --> PgCursor98
    PgPageInfo39{{"PgPageInfo[39∈1] ➊"}}:::plan
    Connection16 --> PgPageInfo39
    First42{{"First[42∈1] ➊"}}:::plan
    PgSelectRows43[["PgSelectRows[43∈1] ➊"]]:::plan
    PgSelectRows43 --> First42
    PgSelect40 --> PgSelectRows43
    PgSelectSingle45{{"PgSelectSingle[45∈1] ➊<br />ᐸnetworkᐳ"}}:::plan
    First42 --> PgSelectSingle45
    PgClassExpression46{{"PgClassExpression[46∈1] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression46
    PgSelectRows73[["PgSelectRows[73∈1] ➊"]]:::plan
    PgSelect37 --> PgSelectRows73
    First84{{"First[84∈1] ➊"}}:::plan
    PgSelectRows73 --> First84
    First84 --> PgSelectSingle87
    PgSelect37 --> Access88
    Last93{{"Last[93∈1] ➊"}}:::plan
    PgSelectRows73 --> Last93
    Last93 --> PgSelectSingle95
    PgSelect37 --> Access102
    Lambda105{{"Lambda[105∈1] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object104 --> Lambda105
    Lambda112{{"Lambda[112∈1] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object111 --> Lambda112
    __Item74[/"__Item[74∈4]<br />ᐸ73ᐳ"\]:::itemplan
    PgSelectRows73 ==> __Item74
    PgSelectSingle75{{"PgSelectSingle[75∈4]<br />ᐸnetworkᐳ"}}:::plan
    __Item74 --> PgSelectSingle75
    PgCursor180{{"PgCursor[180∈7]"}}:::plan
    PgSelectSingle75 & Access88 --> PgCursor180
    PgClassExpression187{{"PgClassExpression[187∈7]<br />ᐸ__network__.”id”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression187
    PgClassExpression188{{"PgClassExpression[188∈7]<br />ᐸ__network__.”inet”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression188
    PgClassExpression189{{"PgClassExpression[189∈7]<br />ᐸ__network__.”cidr”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression189
    PgClassExpression190{{"PgClassExpression[190∈7]<br />ᐸ__network__.”macaddr”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression190
    Object143{{"Object[143∈2] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access134{{"Access[134∈2] ➊<br />ᐸ49.hasMoreᐳ"}}:::plan
    Access134 --> Object143
    PgSelect49[["PgSelect[49∈2] ➊<br />ᐸnetwork+1ᐳ"]]:::plan
    Object14 & ApplyInput26 & Connection25 --> PgSelect49
    PgSelect52[["PgSelect[52∈2] ➊<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    Object14 & ApplyInput26 & Connection25 --> PgSelect52
    Object136{{"Object[136∈2] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Access134 --> Object136
    PgCursor122{{"PgCursor[122∈2] ➊"}}:::plan
    PgSelectSingle119{{"PgSelectSingle[119∈2] ➊<br />ᐸnetworkᐳ"}}:::plan
    Access120{{"Access[120∈2] ➊<br />ᐸ49.cursorDetailsᐳ"}}:::plan
    PgSelectSingle119 & Access120 --> PgCursor122
    PgCursor130{{"PgCursor[130∈2] ➊"}}:::plan
    PgSelectSingle127{{"PgSelectSingle[127∈2] ➊<br />ᐸnetworkᐳ"}}:::plan
    PgSelectSingle127 & Access120 --> PgCursor130
    PgPageInfo51{{"PgPageInfo[51∈2] ➊"}}:::plan
    Connection25 --> PgPageInfo51
    First54{{"First[54∈2] ➊"}}:::plan
    PgSelectRows55[["PgSelectRows[55∈2] ➊"]]:::plan
    PgSelectRows55 --> First54
    PgSelect52 --> PgSelectRows55
    PgSelectSingle57{{"PgSelectSingle[57∈2] ➊<br />ᐸnetworkᐳ"}}:::plan
    First54 --> PgSelectSingle57
    PgClassExpression58{{"PgClassExpression[58∈2] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle57 --> PgClassExpression58
    PgSelectRows76[["PgSelectRows[76∈2] ➊"]]:::plan
    PgSelect49 --> PgSelectRows76
    First116{{"First[116∈2] ➊"}}:::plan
    PgSelectRows76 --> First116
    First116 --> PgSelectSingle119
    PgSelect49 --> Access120
    Last125{{"Last[125∈2] ➊"}}:::plan
    PgSelectRows76 --> Last125
    Last125 --> PgSelectSingle127
    PgSelect49 --> Access134
    Lambda137{{"Lambda[137∈2] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object136 --> Lambda137
    Lambda144{{"Lambda[144∈2] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object143 --> Lambda144
    __Item77[/"__Item[77∈5]<br />ᐸ76ᐳ"\]:::itemplan
    PgSelectRows76 ==> __Item77
    PgSelectSingle78{{"PgSelectSingle[78∈5]<br />ᐸnetworkᐳ"}}:::plan
    __Item77 --> PgSelectSingle78
    PgCursor183{{"PgCursor[183∈8]"}}:::plan
    PgSelectSingle78 & Access120 --> PgCursor183
    PgClassExpression191{{"PgClassExpression[191∈8]<br />ᐸ__network__.”id”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression191
    PgClassExpression192{{"PgClassExpression[192∈8]<br />ᐸ__network__.”inet”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression192
    PgClassExpression193{{"PgClassExpression[193∈8]<br />ᐸ__network__.”cidr”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression193
    PgClassExpression194{{"PgClassExpression[194∈8]<br />ᐸ__network__.”macaddr”ᐳ"}}:::plan
    PgSelectSingle78 --> PgClassExpression194
    Object175{{"Object[175∈3] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access166{{"Access[166∈3] ➊<br />ᐸ61.hasMoreᐳ"}}:::plan
    Access166 --> Object175
    PgSelect61[["PgSelect[61∈3] ➊<br />ᐸnetwork+1ᐳ"]]:::plan
    Object14 & ApplyInput35 & Connection34 --> PgSelect61
    PgSelect64[["PgSelect[64∈3] ➊<br />ᐸnetwork(aggregate)ᐳ"]]:::plan
    Object14 & ApplyInput35 & Connection34 --> PgSelect64
    Object168{{"Object[168∈3] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Access166 --> Object168
    PgCursor154{{"PgCursor[154∈3] ➊"}}:::plan
    PgSelectSingle151{{"PgSelectSingle[151∈3] ➊<br />ᐸnetworkᐳ"}}:::plan
    Access152{{"Access[152∈3] ➊<br />ᐸ61.cursorDetailsᐳ"}}:::plan
    PgSelectSingle151 & Access152 --> PgCursor154
    PgCursor162{{"PgCursor[162∈3] ➊"}}:::plan
    PgSelectSingle159{{"PgSelectSingle[159∈3] ➊<br />ᐸnetworkᐳ"}}:::plan
    PgSelectSingle159 & Access152 --> PgCursor162
    PgPageInfo63{{"PgPageInfo[63∈3] ➊"}}:::plan
    Connection34 --> PgPageInfo63
    First66{{"First[66∈3] ➊"}}:::plan
    PgSelectRows67[["PgSelectRows[67∈3] ➊"]]:::plan
    PgSelectRows67 --> First66
    PgSelect64 --> PgSelectRows67
    PgSelectSingle69{{"PgSelectSingle[69∈3] ➊<br />ᐸnetworkᐳ"}}:::plan
    First66 --> PgSelectSingle69
    PgClassExpression70{{"PgClassExpression[70∈3] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression70
    PgSelectRows79[["PgSelectRows[79∈3] ➊"]]:::plan
    PgSelect61 --> PgSelectRows79
    First148{{"First[148∈3] ➊"}}:::plan
    PgSelectRows79 --> First148
    First148 --> PgSelectSingle151
    PgSelect61 --> Access152
    Last157{{"Last[157∈3] ➊"}}:::plan
    PgSelectRows79 --> Last157
    Last157 --> PgSelectSingle159
    PgSelect61 --> Access166
    Lambda169{{"Lambda[169∈3] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object168 --> Lambda169
    Lambda176{{"Lambda[176∈3] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object175 --> Lambda176
    __Item80[/"__Item[80∈6]<br />ᐸ79ᐳ"\]:::itemplan
    PgSelectRows79 ==> __Item80
    PgSelectSingle81{{"PgSelectSingle[81∈6]<br />ᐸnetworkᐳ"}}:::plan
    __Item80 --> PgSelectSingle81
    PgCursor186{{"PgCursor[186∈9]"}}:::plan
    PgSelectSingle81 & Access152 --> PgCursor186
    PgClassExpression195{{"PgClassExpression[195∈9]<br />ᐸ__network__.”id”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression195
    PgClassExpression196{{"PgClassExpression[196∈9]<br />ᐸ__network__.”inet”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression196
    PgClassExpression197{{"PgClassExpression[197∈9]<br />ᐸ__network__.”cidr”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression197
    PgClassExpression198{{"PgClassExpression[198∈9]<br />ᐸ__network__.”macaddr”ᐳ"}}:::plan
    PgSelectSingle81 --> PgClassExpression198

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,__InputObject7,Access11,Access13,Object14,Connection16,ApplyInput17,__InputObject19,Connection25,ApplyInput26,__InputObject28,Connection34,ApplyInput35,Constant199,Constant200,Constant201 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect37,PgPageInfo39,PgSelect40,First42,PgSelectRows43,PgSelectSingle45,PgClassExpression46,PgSelectRows73,First84,PgSelectSingle87,Access88,PgCursor90,Last93,PgSelectSingle95,PgCursor98,Access102,Object104,Lambda105,Object111,Lambda112 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgSelect49,PgPageInfo51,PgSelect52,First54,PgSelectRows55,PgSelectSingle57,PgClassExpression58,PgSelectRows76,First116,PgSelectSingle119,Access120,PgCursor122,Last125,PgSelectSingle127,PgCursor130,Access134,Object136,Lambda137,Object143,Lambda144 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect61,PgPageInfo63,PgSelect64,First66,PgSelectRows67,PgSelectSingle69,PgClassExpression70,PgSelectRows79,First148,PgSelectSingle151,Access152,PgCursor154,Last157,PgSelectSingle159,PgCursor162,Access166,Object168,Lambda169,Object175,Lambda176 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item74,PgSelectSingle75 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item77,PgSelectSingle78 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item80,PgSelectSingle81 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgCursor180,PgClassExpression187,PgClassExpression188,PgClassExpression189,PgClassExpression190 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgCursor183,PgClassExpression191,PgClassExpression192,PgClassExpression193,PgClassExpression194 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgCursor186,PgClassExpression195,PgClassExpression196,PgClassExpression197,PgClassExpression198 bucket9

