%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 9, 45, 117, 118, 119, 120, 10, 22, 26, 28, 32, 44, 48<br />2: 7, 12, 15, 19, 24, 30, 35, 38, 41, 46, 51<br />3: 54, 57, 60, 63, 66, 69, 72, 75, 78, 81, 84"):::bucket
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ54ᐳ[55]"):::bucket
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ57ᐳ[58]"):::bucket
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ60ᐳ[61]"):::bucket
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ63ᐳ[64]"):::bucket
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ66ᐳ[67]"):::bucket
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ69ᐳ[70]"):::bucket
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ72ᐳ[73]"):::bucket
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ75ᐳ[76]"):::bucket
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ78ᐳ[79]"):::bucket
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ81ᐳ[82]"):::bucket
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ84ᐳ[85]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11

    %% plan dependencies
    PgSelect30[["PgSelect[30∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object10{{"Object[10∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant117{{"Constant[117∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput32{{"ApplyInput[32∈0] ➊"}}:::plan
    Object10 & Constant117 & ApplyInput32 --> PgSelect30
    PgSelect35[["PgSelect[35∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant118{{"Constant[118∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    Constant119{{"Constant[119∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object10 & Constant118 & Constant119 --> PgSelect35
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access9{{"Access[9∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access9 --> Object10
    PgSelect12[["PgSelect[12∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 & Constant117 --> PgSelect12
    __InputObject22{{"__InputObject[22∈0] ➊"}}:::plan
    Constant117 --> __InputObject22
    PgSelect24[["PgSelect[24∈0] ➊<br />ᐸpostᐳ"]]:::plan
    ApplyInput26{{"ApplyInput[26∈0] ➊"}}:::plan
    Object10 & ApplyInput26 --> PgSelect24
    __InputObject28{{"__InputObject[28∈0] ➊"}}:::plan
    Constant117 --> __InputObject28
    PgSelect38[["PgSelect[38∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant120{{"Constant[120∈0] ➊<br />ᐸ0ᐳ"}}:::plan
    Object10 & Constant120 --> PgSelect38
    __InputObject44{{"__InputObject[44∈0] ➊"}}:::plan
    Constant45{{"Constant[45∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant45 --> __InputObject44
    PgSelect46[["PgSelect[46∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput48{{"ApplyInput[48∈0] ➊"}}:::plan
    Object10 & ApplyInput48 --> PgSelect46
    PgSelect51[["PgSelect[51∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object10 & Constant118 --> PgSelect51
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect7
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access9
    PgSelect15[["PgSelect[15∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect15
    PgSelect19[["PgSelect[19∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect19
    __InputObject22 --> ApplyInput26
    __InputObject28 --> ApplyInput32
    PgSelect41[["PgSelect[41∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object10 --> PgSelect41
    __InputObject44 --> ApplyInput48
    PgSelectRows54[["PgSelectRows[54∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows54
    PgSelectRows57[["PgSelectRows[57∈0] ➊"]]:::plan
    PgSelect12 --> PgSelectRows57
    PgSelectRows60[["PgSelectRows[60∈0] ➊"]]:::plan
    PgSelect15 --> PgSelectRows60
    PgSelectRows63[["PgSelectRows[63∈0] ➊"]]:::plan
    PgSelect19 --> PgSelectRows63
    PgSelectRows66[["PgSelectRows[66∈0] ➊"]]:::plan
    PgSelect24 --> PgSelectRows66
    PgSelectRows69[["PgSelectRows[69∈0] ➊"]]:::plan
    PgSelect30 --> PgSelectRows69
    PgSelectRows72[["PgSelectRows[72∈0] ➊"]]:::plan
    PgSelect35 --> PgSelectRows72
    PgSelectRows75[["PgSelectRows[75∈0] ➊"]]:::plan
    PgSelect38 --> PgSelectRows75
    PgSelectRows78[["PgSelectRows[78∈0] ➊"]]:::plan
    PgSelect41 --> PgSelectRows78
    PgSelectRows81[["PgSelectRows[81∈0] ➊"]]:::plan
    PgSelect46 --> PgSelectRows81
    PgSelectRows84[["PgSelectRows[84∈0] ➊"]]:::plan
    PgSelect51 --> PgSelectRows84
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item55[/"__Item[55∈1]<br />ᐸ54ᐳ"\]:::itemplan
    PgSelectRows54 ==> __Item55
    PgSelectSingle56{{"PgSelectSingle[56∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item55 --> PgSelectSingle56
    PgClassExpression87{{"PgClassExpression[87∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression87
    PgClassExpression88{{"PgClassExpression[88∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression88
    PgClassExpression89{{"PgClassExpression[89∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression89
    __Item58[/"__Item[58∈2]<br />ᐸ57ᐳ"\]:::itemplan
    PgSelectRows57 ==> __Item58
    PgSelectSingle59{{"PgSelectSingle[59∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item58 --> PgSelectSingle59
    PgClassExpression90{{"PgClassExpression[90∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression90
    PgClassExpression91{{"PgClassExpression[91∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression91
    PgClassExpression92{{"PgClassExpression[92∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle59 --> PgClassExpression92
    __Item61[/"__Item[61∈3]<br />ᐸ60ᐳ"\]:::itemplan
    PgSelectRows60 ==> __Item61
    PgSelectSingle62{{"PgSelectSingle[62∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item61 --> PgSelectSingle62
    PgClassExpression93{{"PgClassExpression[93∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle62 --> PgClassExpression93
    PgClassExpression94{{"PgClassExpression[94∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle62 --> PgClassExpression94
    PgClassExpression95{{"PgClassExpression[95∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle62 --> PgClassExpression95
    __Item64[/"__Item[64∈4]<br />ᐸ63ᐳ"\]:::itemplan
    PgSelectRows63 ==> __Item64
    PgSelectSingle65{{"PgSelectSingle[65∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item64 --> PgSelectSingle65
    PgClassExpression96{{"PgClassExpression[96∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression96
    PgClassExpression97{{"PgClassExpression[97∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression97
    PgClassExpression98{{"PgClassExpression[98∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle65 --> PgClassExpression98
    __Item67[/"__Item[67∈5]<br />ᐸ66ᐳ"\]:::itemplan
    PgSelectRows66 ==> __Item67
    PgSelectSingle68{{"PgSelectSingle[68∈5]<br />ᐸpostᐳ"}}:::plan
    __Item67 --> PgSelectSingle68
    PgClassExpression99{{"PgClassExpression[99∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression99
    PgClassExpression100{{"PgClassExpression[100∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression100
    __Item70[/"__Item[70∈6]<br />ᐸ69ᐳ"\]:::itemplan
    PgSelectRows69 ==> __Item70
    PgSelectSingle71{{"PgSelectSingle[71∈6]<br />ᐸpostᐳ"}}:::plan
    __Item70 --> PgSelectSingle71
    PgClassExpression101{{"PgClassExpression[101∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression101
    PgClassExpression102{{"PgClassExpression[102∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression102
    __Item73[/"__Item[73∈7]<br />ᐸ72ᐳ"\]:::itemplan
    PgSelectRows72 ==> __Item73
    PgSelectSingle74{{"PgSelectSingle[74∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item73 --> PgSelectSingle74
    PgClassExpression103{{"PgClassExpression[103∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression103
    PgClassExpression104{{"PgClassExpression[104∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression104
    PgClassExpression105{{"PgClassExpression[105∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression105
    __Item76[/"__Item[76∈8]<br />ᐸ75ᐳ"\]:::itemplan
    PgSelectRows75 ==> __Item76
    PgSelectSingle77{{"PgSelectSingle[77∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item76 --> PgSelectSingle77
    PgClassExpression106{{"PgClassExpression[106∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression106
    PgClassExpression107{{"PgClassExpression[107∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression107
    PgClassExpression108{{"PgClassExpression[108∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression108
    __Item79[/"__Item[79∈9]<br />ᐸ78ᐳ"\]:::itemplan
    PgSelectRows78 ==> __Item79
    PgSelectSingle80{{"PgSelectSingle[80∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item79 --> PgSelectSingle80
    PgClassExpression109{{"PgClassExpression[109∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression109
    PgClassExpression110{{"PgClassExpression[110∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression110
    PgClassExpression111{{"PgClassExpression[111∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression111
    __Item82[/"__Item[82∈10]<br />ᐸ81ᐳ"\]:::itemplan
    PgSelectRows81 ==> __Item82
    PgSelectSingle83{{"PgSelectSingle[83∈10]<br />ᐸpersonᐳ"}}:::plan
    __Item82 --> PgSelectSingle83
    PgClassExpression112{{"PgClassExpression[112∈10]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression112
    PgClassExpression113{{"PgClassExpression[113∈10]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression113
    PgClassExpression114{{"PgClassExpression[114∈10]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression114
    __Item85[/"__Item[85∈11]<br />ᐸ84ᐳ"\]:::itemplan
    PgSelectRows84 ==> __Item85
    PgSelectSingle86{{"PgSelectSingle[86∈11]<br />ᐸpostᐳ"}}:::plan
    __Item85 --> PgSelectSingle86
    PgClassExpression115{{"PgClassExpression[115∈11]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression115
    PgClassExpression116{{"PgClassExpression[116∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression116

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect7,Access8,Access9,Object10,PgSelect12,PgSelect15,PgSelect19,__InputObject22,PgSelect24,ApplyInput26,__InputObject28,PgSelect30,ApplyInput32,PgSelect35,PgSelect38,PgSelect41,__InputObject44,Constant45,PgSelect46,ApplyInput48,PgSelect51,PgSelectRows54,PgSelectRows57,PgSelectRows60,PgSelectRows63,PgSelectRows66,PgSelectRows69,PgSelectRows72,PgSelectRows75,PgSelectRows78,PgSelectRows81,PgSelectRows84,Constant117,Constant118,Constant119,Constant120 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item55,PgSelectSingle56,PgClassExpression87,PgClassExpression88,PgClassExpression89 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item58,PgSelectSingle59,PgClassExpression90,PgClassExpression91,PgClassExpression92 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item61,PgSelectSingle62,PgClassExpression93,PgClassExpression94,PgClassExpression95 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item64,PgSelectSingle65,PgClassExpression96,PgClassExpression97,PgClassExpression98 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item67,PgSelectSingle68,PgClassExpression99,PgClassExpression100 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item70,PgSelectSingle71,PgClassExpression101,PgClassExpression102 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item73,PgSelectSingle74,PgClassExpression103,PgClassExpression104,PgClassExpression105 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item76,PgSelectSingle77,PgClassExpression106,PgClassExpression107,PgClassExpression108 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item79,PgSelectSingle80,PgClassExpression109,PgClassExpression110,PgClassExpression111 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item82,PgSelectSingle83,PgClassExpression112,PgClassExpression113,PgClassExpression114 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item85,PgSelectSingle86,PgClassExpression115,PgClassExpression116 bucket11

