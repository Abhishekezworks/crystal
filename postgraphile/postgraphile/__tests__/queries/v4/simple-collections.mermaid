%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% define steps
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    Access27{{"Access[27∈0]<br />ᐸ3.pgSettingsᐳ"}}:::plan
    Access28{{"Access[28∈0]<br />ᐸ3.withPgClientᐳ"}}:::plan
    Object29{{"Object[29∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    PgSelect26[["PgSelect[26∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item30[/"__Item[30∈1]<br />ᐸ26ᐳ"\]:::itemplan
    PgSelectSingle31{{"PgSelectSingle[31∈1]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression32{{"PgClassExpression[32∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression33{{"PgClassExpression[33∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression34{{"PgClassExpression[34∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect54[["PgSelect[54∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item58[/"__Item[58∈2]<br />ᐸ54ᐳ"\]:::itemplan
    PgSelectSingle59{{"PgSelectSingle[59∈2]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression60{{"PgClassExpression[60∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression61{{"PgClassExpression[61∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression62{{"PgClassExpression[62∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect83[["PgSelect[83∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item87[/"__Item[87∈3]<br />ᐸ83ᐳ"\]:::itemplan
    PgSelectSingle88{{"PgSelectSingle[88∈3]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression89{{"PgClassExpression[89∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression90{{"PgClassExpression[90∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression91{{"PgClassExpression[91∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect112[["PgSelect[112∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item116[/"__Item[116∈4]<br />ᐸ112ᐳ"\]:::itemplan
    PgSelectSingle117{{"PgSelectSingle[117∈4]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression118{{"PgClassExpression[118∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression119{{"PgClassExpression[119∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression120{{"PgClassExpression[120∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    __InputStaticLeaf129{{"__InputStaticLeaf[129∈0]"}}:::plan
    PgSelect137[["PgSelect[137∈0]<br />ᐸpostᐳ"]]:::plan
    __Item141[/"__Item[141∈5]<br />ᐸ137ᐳ"\]:::itemplan
    PgSelectSingle142{{"PgSelectSingle[142∈5]<br />ᐸpostᐳ"}}:::plan
    PgClassExpression143{{"PgClassExpression[143∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgClassExpression144{{"PgClassExpression[144∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    __InputStaticLeaf153{{"__InputStaticLeaf[153∈0]"}}:::plan
    PgSelect161[["PgSelect[161∈0]<br />ᐸpostᐳ"]]:::plan
    __Item165[/"__Item[165∈6]<br />ᐸ161ᐳ"\]:::itemplan
    PgSelectSingle166{{"PgSelectSingle[166∈6]<br />ᐸpostᐳ"}}:::plan
    PgClassExpression167{{"PgClassExpression[167∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgClassExpression168{{"PgClassExpression[168∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelect188[["PgSelect[188∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item192[/"__Item[192∈7]<br />ᐸ188ᐳ"\]:::itemplan
    PgSelectSingle193{{"PgSelectSingle[193∈7]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression194{{"PgClassExpression[194∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression195{{"PgClassExpression[195∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression196{{"PgClassExpression[196∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect216[["PgSelect[216∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item220[/"__Item[220∈8]<br />ᐸ216ᐳ"\]:::itemplan
    PgSelectSingle221{{"PgSelectSingle[221∈8]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression222{{"PgClassExpression[222∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression223{{"PgClassExpression[223∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression224{{"PgClassExpression[224∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect272[["PgSelect[272∈0]<br />ᐸpersonᐳ"]]:::plan
    __Item276[/"__Item[276∈9]<br />ᐸ272ᐳ"\]:::itemplan
    PgSelectSingle277{{"PgSelectSingle[277∈9]<br />ᐸpersonᐳ"}}:::plan
    PgClassExpression278{{"PgClassExpression[278∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgClassExpression279{{"PgClassExpression[279∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgClassExpression280{{"PgClassExpression[280∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelect299[["PgSelect[299∈0]<br />ᐸpostᐳ"]]:::plan
    __Item303[/"__Item[303∈10]<br />ᐸ299ᐳ"\]:::itemplan
    PgSelectSingle304{{"PgSelectSingle[304∈10]<br />ᐸpostᐳ"}}:::plan
    PgClassExpression305{{"PgClassExpression[305∈10]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgClassExpression306{{"PgClassExpression[306∈10]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan

    %% plan dependencies
    __Value3 --> Access27
    __Value3 --> Access28
    Access27 & Access28 --> Object29
    Object29 --> PgSelect26
    PgSelect26 ==> __Item30
    __Item30 --> PgSelectSingle31
    PgSelectSingle31 --> PgClassExpression32
    PgSelectSingle31 --> PgClassExpression33
    PgSelectSingle31 --> PgClassExpression34
    Object29 --> PgSelect54
    PgSelect54 ==> __Item58
    __Item58 --> PgSelectSingle59
    PgSelectSingle59 --> PgClassExpression60
    PgSelectSingle59 --> PgClassExpression61
    PgSelectSingle59 --> PgClassExpression62
    Object29 --> PgSelect83
    PgSelect83 ==> __Item87
    __Item87 --> PgSelectSingle88
    PgSelectSingle88 --> PgClassExpression89
    PgSelectSingle88 --> PgClassExpression90
    PgSelectSingle88 --> PgClassExpression91
    Object29 --> PgSelect112
    PgSelect112 ==> __Item116
    __Item116 --> PgSelectSingle117
    PgSelectSingle117 --> PgClassExpression118
    PgSelectSingle117 --> PgClassExpression119
    PgSelectSingle117 --> PgClassExpression120
    Object29 & __InputStaticLeaf129 --> PgSelect137
    PgSelect137 ==> __Item141
    __Item141 --> PgSelectSingle142
    PgSelectSingle142 --> PgClassExpression143
    PgSelectSingle142 --> PgClassExpression144
    Object29 & __InputStaticLeaf153 --> PgSelect161
    PgSelect161 ==> __Item165
    __Item165 --> PgSelectSingle166
    PgSelectSingle166 --> PgClassExpression167
    PgSelectSingle166 --> PgClassExpression168
    Object29 --> PgSelect188
    PgSelect188 ==> __Item192
    __Item192 --> PgSelectSingle193
    PgSelectSingle193 --> PgClassExpression194
    PgSelectSingle193 --> PgClassExpression195
    PgSelectSingle193 --> PgClassExpression196
    Object29 --> PgSelect216
    PgSelect216 ==> __Item220
    __Item220 --> PgSelectSingle221
    PgSelectSingle221 --> PgClassExpression222
    PgSelectSingle221 --> PgClassExpression223
    PgSelectSingle221 --> PgClassExpression224
    Object29 --> PgSelect272
    PgSelect272 ==> __Item276
    __Item276 --> PgSelectSingle277
    PgSelectSingle277 --> PgClassExpression278
    PgSelectSingle277 --> PgClassExpression279
    PgSelectSingle277 --> PgClassExpression280
    Object29 --> PgSelect299
    PgSelect299 ==> __Item303
    __Item303 --> PgSelectSingle304
    PgSelectSingle304 --> PgClassExpression305
    PgSelectSingle304 --> PgClassExpression306

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br />1:  / Access[27],Access[28],__InputStaticLeaf[129],__InputStaticLeaf[153],Object[29]<br />2: PgSelect[26], PgSelect[54], PgSelect[83], PgSelect[112], PgSelect[137], PgSelect[161], PgSelect[188], PgSelect[216], PgSelect[272], PgSelect[299]"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value3,__Value5,PgSelect26,Access27,Access28,Object29,PgSelect54,PgSelect83,PgSelect112,__InputStaticLeaf129,PgSelect137,__InputStaticLeaf153,PgSelect161,PgSelect188,PgSelect216,PgSelect272,PgSelect299 bucket0
    Bucket1("Bucket 1 (listItem)<br />ROOT __Item{1}ᐸ26ᐳ[30]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item30,PgSelectSingle31,PgClassExpression32,PgClassExpression33,PgClassExpression34 bucket1
    Bucket2("Bucket 2 (listItem)<br />ROOT __Item{2}ᐸ54ᐳ[58]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item58,PgSelectSingle59,PgClassExpression60,PgClassExpression61,PgClassExpression62 bucket2
    Bucket3("Bucket 3 (listItem)<br />ROOT __Item{3}ᐸ83ᐳ[87]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item87,PgSelectSingle88,PgClassExpression89,PgClassExpression90,PgClassExpression91 bucket3
    Bucket4("Bucket 4 (listItem)<br />ROOT __Item{4}ᐸ112ᐳ[116]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item116,PgSelectSingle117,PgClassExpression118,PgClassExpression119,PgClassExpression120 bucket4
    Bucket5("Bucket 5 (listItem)<br />ROOT __Item{5}ᐸ137ᐳ[141]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item141,PgSelectSingle142,PgClassExpression143,PgClassExpression144 bucket5
    Bucket6("Bucket 6 (listItem)<br />ROOT __Item{6}ᐸ161ᐳ[165]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item165,PgSelectSingle166,PgClassExpression167,PgClassExpression168 bucket6
    Bucket7("Bucket 7 (listItem)<br />ROOT __Item{7}ᐸ188ᐳ[192]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,__Item192,PgSelectSingle193,PgClassExpression194,PgClassExpression195,PgClassExpression196 bucket7
    Bucket8("Bucket 8 (listItem)<br />ROOT __Item{8}ᐸ216ᐳ[220]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item220,PgSelectSingle221,PgClassExpression222,PgClassExpression223,PgClassExpression224 bucket8
    Bucket9("Bucket 9 (listItem)<br />ROOT __Item{9}ᐸ272ᐳ[276]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item276,PgSelectSingle277,PgClassExpression278,PgClassExpression279,PgClassExpression280 bucket9
    Bucket10("Bucket 10 (listItem)<br />ROOT __Item{10}ᐸ299ᐳ[303]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item303,PgSelectSingle304,PgClassExpression305,PgClassExpression306 bucket10
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10
    end
