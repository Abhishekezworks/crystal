%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/simple-collections"
    Bucket0("Bucket 0 (root)<br /><br />1: <br />ᐳ: 6, 8, 10, 55, 129, 130, 131, 132, 11, 27, 32, 34, 39, 54, 59<br />2: 7, 14, 18, 23, 29, 36, 42, 46, 50, 56, 62<br />3: 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96"):::bucket
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ66ᐳ[67]"):::bucket
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ69ᐳ[70]"):::bucket
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ72ᐳ[73]"):::bucket
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ75ᐳ[76]"):::bucket
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ78ᐳ[79]"):::bucket
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ81ᐳ[82]"):::bucket
    Bucket7("Bucket 7 (listItem)<br /><br />ROOT __Item{7}ᐸ84ᐳ[85]"):::bucket
    Bucket8("Bucket 8 (listItem)<br /><br />ROOT __Item{8}ᐸ87ᐳ[88]"):::bucket
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ90ᐳ[91]"):::bucket
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ93ᐳ[94]"):::bucket
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ96ᐳ[97]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7 & Bucket8 & Bucket9 & Bucket10 & Bucket11

    %% plan dependencies
    PgSelect36[["PgSelect[36∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object11{{"Object[11∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant129{{"Constant[129∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    ApplyInput39{{"ApplyInput[39∈0] ➊"}}:::plan
    Object11 & Constant129 & ApplyInput39 --> PgSelect36
    PgSelect42[["PgSelect[42∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant130{{"Constant[130∈0] ➊<br />ᐸ3ᐳ"}}:::plan
    Constant131{{"Constant[131∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Object11 & Constant130 & Constant131 --> PgSelect42
    Access8{{"Access[8∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access8 & Access10 --> Object11
    PgSelect14[["PgSelect[14∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object11 & Constant129 --> PgSelect14
    __InputObject27{{"__InputObject[27∈0] ➊"}}:::plan
    Constant129 --> __InputObject27
    PgSelect29[["PgSelect[29∈0] ➊<br />ᐸpostᐳ"]]:::plan
    ApplyInput32{{"ApplyInput[32∈0] ➊"}}:::plan
    Object11 & ApplyInput32 --> PgSelect29
    __InputObject34{{"__InputObject[34∈0] ➊"}}:::plan
    Constant129 --> __InputObject34
    PgSelect46[["PgSelect[46∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Constant132{{"Constant[132∈0] ➊<br />ᐸ0ᐳ"}}:::plan
    Object11 & Constant132 --> PgSelect46
    __InputObject54{{"__InputObject[54∈0] ➊"}}:::plan
    Constant55{{"Constant[55∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant55 --> __InputObject54
    PgSelect56[["PgSelect[56∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    ApplyInput59{{"ApplyInput[59∈0] ➊"}}:::plan
    Object11 & ApplyInput59 --> PgSelect56
    PgSelect62[["PgSelect[62∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object11 & Constant130 --> PgSelect62
    PgSelect7[["PgSelect[7∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object11 --> PgSelect7
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access8
    __Value2 --> Access10
    PgSelect18[["PgSelect[18∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object11 --> PgSelect18
    PgSelect23[["PgSelect[23∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object11 --> PgSelect23
    __InputObject27 --> ApplyInput32
    __InputObject34 --> ApplyInput39
    PgSelect50[["PgSelect[50∈0] ➊<br />ᐸpersonᐳ"]]:::plan
    Object11 --> PgSelect50
    __InputObject54 --> ApplyInput59
    PgSelectRows66[["PgSelectRows[66∈0] ➊"]]:::plan
    PgSelect7 --> PgSelectRows66
    PgSelectRows69[["PgSelectRows[69∈0] ➊"]]:::plan
    PgSelect14 --> PgSelectRows69
    PgSelectRows72[["PgSelectRows[72∈0] ➊"]]:::plan
    PgSelect18 --> PgSelectRows72
    PgSelectRows75[["PgSelectRows[75∈0] ➊"]]:::plan
    PgSelect23 --> PgSelectRows75
    PgSelectRows78[["PgSelectRows[78∈0] ➊"]]:::plan
    PgSelect29 --> PgSelectRows78
    PgSelectRows81[["PgSelectRows[81∈0] ➊"]]:::plan
    PgSelect36 --> PgSelectRows81
    PgSelectRows84[["PgSelectRows[84∈0] ➊"]]:::plan
    PgSelect42 --> PgSelectRows84
    PgSelectRows87[["PgSelectRows[87∈0] ➊"]]:::plan
    PgSelect46 --> PgSelectRows87
    PgSelectRows90[["PgSelectRows[90∈0] ➊"]]:::plan
    PgSelect50 --> PgSelectRows90
    PgSelectRows93[["PgSelectRows[93∈0] ➊"]]:::plan
    PgSelect56 --> PgSelectRows93
    PgSelectRows96[["PgSelectRows[96∈0] ➊"]]:::plan
    PgSelect62 --> PgSelectRows96
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item67[/"__Item[67∈1]<br />ᐸ66ᐳ"\]:::itemplan
    PgSelectRows66 ==> __Item67
    PgSelectSingle68{{"PgSelectSingle[68∈1]<br />ᐸpersonᐳ"}}:::plan
    __Item67 --> PgSelectSingle68
    PgClassExpression99{{"PgClassExpression[99∈1]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression99
    PgClassExpression100{{"PgClassExpression[100∈1]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression100
    PgClassExpression101{{"PgClassExpression[101∈1]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle68 --> PgClassExpression101
    __Item70[/"__Item[70∈2]<br />ᐸ69ᐳ"\]:::itemplan
    PgSelectRows69 ==> __Item70
    PgSelectSingle71{{"PgSelectSingle[71∈2]<br />ᐸpersonᐳ"}}:::plan
    __Item70 --> PgSelectSingle71
    PgClassExpression102{{"PgClassExpression[102∈2]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression102
    PgClassExpression103{{"PgClassExpression[103∈2]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression103
    PgClassExpression104{{"PgClassExpression[104∈2]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression104
    __Item73[/"__Item[73∈3]<br />ᐸ72ᐳ"\]:::itemplan
    PgSelectRows72 ==> __Item73
    PgSelectSingle74{{"PgSelectSingle[74∈3]<br />ᐸpersonᐳ"}}:::plan
    __Item73 --> PgSelectSingle74
    PgClassExpression105{{"PgClassExpression[105∈3]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression105
    PgClassExpression106{{"PgClassExpression[106∈3]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression106
    PgClassExpression107{{"PgClassExpression[107∈3]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle74 --> PgClassExpression107
    __Item76[/"__Item[76∈4]<br />ᐸ75ᐳ"\]:::itemplan
    PgSelectRows75 ==> __Item76
    PgSelectSingle77{{"PgSelectSingle[77∈4]<br />ᐸpersonᐳ"}}:::plan
    __Item76 --> PgSelectSingle77
    PgClassExpression108{{"PgClassExpression[108∈4]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression108
    PgClassExpression109{{"PgClassExpression[109∈4]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression109
    PgClassExpression110{{"PgClassExpression[110∈4]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle77 --> PgClassExpression110
    __Item79[/"__Item[79∈5]<br />ᐸ78ᐳ"\]:::itemplan
    PgSelectRows78 ==> __Item79
    PgSelectSingle80{{"PgSelectSingle[80∈5]<br />ᐸpostᐳ"}}:::plan
    __Item79 --> PgSelectSingle80
    PgClassExpression111{{"PgClassExpression[111∈5]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression111
    PgClassExpression112{{"PgClassExpression[112∈5]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle80 --> PgClassExpression112
    __Item82[/"__Item[82∈6]<br />ᐸ81ᐳ"\]:::itemplan
    PgSelectRows81 ==> __Item82
    PgSelectSingle83{{"PgSelectSingle[83∈6]<br />ᐸpostᐳ"}}:::plan
    __Item82 --> PgSelectSingle83
    PgClassExpression113{{"PgClassExpression[113∈6]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression113
    PgClassExpression114{{"PgClassExpression[114∈6]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression114
    __Item85[/"__Item[85∈7]<br />ᐸ84ᐳ"\]:::itemplan
    PgSelectRows84 ==> __Item85
    PgSelectSingle86{{"PgSelectSingle[86∈7]<br />ᐸpersonᐳ"}}:::plan
    __Item85 --> PgSelectSingle86
    PgClassExpression115{{"PgClassExpression[115∈7]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression115
    PgClassExpression116{{"PgClassExpression[116∈7]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression116
    PgClassExpression117{{"PgClassExpression[117∈7]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression117
    __Item88[/"__Item[88∈8]<br />ᐸ87ᐳ"\]:::itemplan
    PgSelectRows87 ==> __Item88
    PgSelectSingle89{{"PgSelectSingle[89∈8]<br />ᐸpersonᐳ"}}:::plan
    __Item88 --> PgSelectSingle89
    PgClassExpression118{{"PgClassExpression[118∈8]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression118
    PgClassExpression119{{"PgClassExpression[119∈8]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression119
    PgClassExpression120{{"PgClassExpression[120∈8]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle89 --> PgClassExpression120
    __Item91[/"__Item[91∈9]<br />ᐸ90ᐳ"\]:::itemplan
    PgSelectRows90 ==> __Item91
    PgSelectSingle92{{"PgSelectSingle[92∈9]<br />ᐸpersonᐳ"}}:::plan
    __Item91 --> PgSelectSingle92
    PgClassExpression121{{"PgClassExpression[121∈9]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle92 --> PgClassExpression121
    PgClassExpression122{{"PgClassExpression[122∈9]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle92 --> PgClassExpression122
    PgClassExpression123{{"PgClassExpression[123∈9]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle92 --> PgClassExpression123
    __Item94[/"__Item[94∈10]<br />ᐸ93ᐳ"\]:::itemplan
    PgSelectRows93 ==> __Item94
    PgSelectSingle95{{"PgSelectSingle[95∈10]<br />ᐸpersonᐳ"}}:::plan
    __Item94 --> PgSelectSingle95
    PgClassExpression124{{"PgClassExpression[124∈10]<br />ᐸ__person__.”id”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression124
    PgClassExpression125{{"PgClassExpression[125∈10]<br />ᐸ__person__...full_name”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression125
    PgClassExpression126{{"PgClassExpression[126∈10]<br />ᐸ__person__.”email”ᐳ"}}:::plan
    PgSelectSingle95 --> PgClassExpression126
    __Item97[/"__Item[97∈11]<br />ᐸ96ᐳ"\]:::itemplan
    PgSelectRows96 ==> __Item97
    PgSelectSingle98{{"PgSelectSingle[98∈11]<br />ᐸpostᐳ"}}:::plan
    __Item97 --> PgSelectSingle98
    PgClassExpression127{{"PgClassExpression[127∈11]<br />ᐸ__post__.”headline”ᐳ"}}:::plan
    PgSelectSingle98 --> PgClassExpression127
    PgClassExpression128{{"PgClassExpression[128∈11]<br />ᐸ__post__.”author_id”ᐳ"}}:::plan
    PgSelectSingle98 --> PgClassExpression128

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect7,Access8,Access10,Object11,PgSelect14,PgSelect18,PgSelect23,__InputObject27,PgSelect29,ApplyInput32,__InputObject34,PgSelect36,ApplyInput39,PgSelect42,PgSelect46,PgSelect50,__InputObject54,Constant55,PgSelect56,ApplyInput59,PgSelect62,PgSelectRows66,PgSelectRows69,PgSelectRows72,PgSelectRows75,PgSelectRows78,PgSelectRows81,PgSelectRows84,PgSelectRows87,PgSelectRows90,PgSelectRows93,PgSelectRows96,Constant129,Constant130,Constant131,Constant132 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item67,PgSelectSingle68,PgClassExpression99,PgClassExpression100,PgClassExpression101 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item70,PgSelectSingle71,PgClassExpression102,PgClassExpression103,PgClassExpression104 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item73,PgSelectSingle74,PgClassExpression105,PgClassExpression106,PgClassExpression107 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item76,PgSelectSingle77,PgClassExpression108,PgClassExpression109,PgClassExpression110 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item79,PgSelectSingle80,PgClassExpression111,PgClassExpression112 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item82,PgSelectSingle83,PgClassExpression113,PgClassExpression114 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item85,PgSelectSingle86,PgClassExpression115,PgClassExpression116,PgClassExpression117 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,__Item88,PgSelectSingle89,PgClassExpression118,PgClassExpression119,PgClassExpression120 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item91,PgSelectSingle92,PgClassExpression121,PgClassExpression122,PgClassExpression123 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item94,PgSelectSingle95,PgClassExpression124,PgClassExpression125,PgClassExpression126 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item97,PgSelectSingle98,PgClassExpression127,PgClassExpression128 bucket11

