%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/connections.boolean"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 12, 13, 94, 7<br /><br />ROOT Connectionᐸ9ᐳ[13]<br />1: PgSelect[22], PgSelect[24]<br />ᐳ: 23, 44, 53, 54, 55, 58, 59<br />2: PgSelectRows[26], PgSelectRows[38]<br />ᐳ: 25, 27, 28, 41, 43, 45, 47, 49, 51"):::bucket
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 12, 19, 20, 94, 7<br /><br />ROOT Connectionᐸ17ᐳ[19]<br />1: PgSelect[30], PgSelect[32]<br />ᐳ: 31, 66, 75, 76, 77, 80, 81<br />2: PgSelectRows[34], PgSelectRows[39]<br />ᐳ: 33, 35, 36, 63, 65, 67, 69, 71, 73"):::bucket
    Bucket3("Bucket 3 (listItem)<br />Deps: 44<br /><br />ROOT __Item{3}ᐸ38ᐳ[60]"):::bucket
    Bucket4("Bucket 4 (listItem)<br />Deps: 66<br /><br />ROOT __Item{4}ᐸ39ᐳ[82]"):::bucket
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 61, 44<br /><br />ROOT PgSelectSingle{3}ᐸcompound_keyᐳ[61]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 83, 66<br /><br />ROOT PgSelectSingle{4}ᐸcompound_keyᐳ[83]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2
    Bucket1 --> Bucket3
    Bucket2 --> Bucket4
    Bucket3 --> Bucket5
    Bucket4 --> Bucket6

    %% plan dependencies
    Object12{{"Object[12∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access10 & Access11 --> Object12
    Connection19{{"Connection[19∈0] ➊<br />ᐸ17ᐳ"}}:::plan
    Constant94{{"Constant[94∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    Lambda20{{"Lambda[20∈0] ➊<br />ᐸparseCursorᐳ"}}:::plan
    Constant94 & Lambda20 --> Connection19
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access10
    __Value2 --> Access11
    Connection13{{"Connection[13∈0] ➊<br />ᐸ9ᐳ"}}:::plan
    Constant94 --> Connection13
    Constant95{{"Constant[95∈0] ➊<br />ᐸ'WyIzNjY0MzE3ZDgwIixmYWxzZSwyLDFd'ᐳ"}}:::plan
    Constant95 --> Lambda20
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Object58{{"Object[58∈1] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access53{{"Access[53∈1] ➊<br />ᐸ22.hasMoreᐳ"}}:::plan
    Constant94 & Access53 --> Object58
    PgSelect22[["PgSelect[22∈1] ➊<br />ᐸcompound_key+1ᐳ"]]:::plan
    Object12 & Connection13 & Constant94 --> PgSelect22
    Object54{{"Object[54∈1] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Constant94 & Access53 --> Object54
    PgSelect24[["PgSelect[24∈1] ➊<br />ᐸcompound_key(aggregate)ᐳ"]]:::plan
    Object12 & Connection13 --> PgSelect24
    PgCursor45{{"PgCursor[45∈1] ➊"}}:::plan
    PgSelectSingle43{{"PgSelectSingle[43∈1] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    Access44{{"Access[44∈1] ➊<br />ᐸ22.cursorDetailsᐳ"}}:::plan
    PgSelectSingle43 & Access44 --> PgCursor45
    PgCursor51{{"PgCursor[51∈1] ➊"}}:::plan
    PgSelectSingle49{{"PgSelectSingle[49∈1] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    PgSelectSingle49 & Access44 --> PgCursor51
    PgPageInfo23{{"PgPageInfo[23∈1] ➊"}}:::plan
    Connection13 --> PgPageInfo23
    First25{{"First[25∈1] ➊"}}:::plan
    PgSelectRows26[["PgSelectRows[26∈1] ➊"]]:::plan
    PgSelectRows26 --> First25
    PgSelect24 --> PgSelectRows26
    PgSelectSingle27{{"PgSelectSingle[27∈1] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    First25 --> PgSelectSingle27
    PgClassExpression28{{"PgClassExpression[28∈1] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle27 --> PgClassExpression28
    PgSelectRows38[["PgSelectRows[38∈1] ➊"]]:::plan
    PgSelect22 --> PgSelectRows38
    First41{{"First[41∈1] ➊"}}:::plan
    PgSelectRows38 --> First41
    First41 --> PgSelectSingle43
    PgSelect22 --> Access44
    Last47{{"Last[47∈1] ➊"}}:::plan
    PgSelectRows38 --> Last47
    Last47 --> PgSelectSingle49
    PgSelect22 --> Access53
    Lambda55{{"Lambda[55∈1] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object54 --> Lambda55
    Lambda59{{"Lambda[59∈1] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object58 --> Lambda59
    PgSelect30[["PgSelect[30∈2] ➊<br />ᐸcompound_key+1ᐳ"]]:::plan
    Object12 & Connection19 & Lambda20 & Constant94 --> PgSelect30
    Object80{{"Object[80∈2] ➊<br />ᐸ{first,last,offset,hasMore}ᐳ"}}:::plan
    Access75{{"Access[75∈2] ➊<br />ᐸ30.hasMoreᐳ"}}:::plan
    Constant94 & Access75 --> Object80
    Object76{{"Object[76∈2] ➊<br />ᐸ{first,last,hasMore}ᐳ"}}:::plan
    Constant94 & Access75 --> Object76
    PgSelect32[["PgSelect[32∈2] ➊<br />ᐸcompound_key(aggregate)ᐳ"]]:::plan
    Object12 & Connection19 --> PgSelect32
    PgCursor67{{"PgCursor[67∈2] ➊"}}:::plan
    PgSelectSingle65{{"PgSelectSingle[65∈2] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    Access66{{"Access[66∈2] ➊<br />ᐸ30.cursorDetailsᐳ"}}:::plan
    PgSelectSingle65 & Access66 --> PgCursor67
    PgCursor73{{"PgCursor[73∈2] ➊"}}:::plan
    PgSelectSingle71{{"PgSelectSingle[71∈2] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    PgSelectSingle71 & Access66 --> PgCursor73
    PgPageInfo31{{"PgPageInfo[31∈2] ➊"}}:::plan
    Connection19 --> PgPageInfo31
    First33{{"First[33∈2] ➊"}}:::plan
    PgSelectRows34[["PgSelectRows[34∈2] ➊"]]:::plan
    PgSelectRows34 --> First33
    PgSelect32 --> PgSelectRows34
    PgSelectSingle35{{"PgSelectSingle[35∈2] ➊<br />ᐸcompound_keyᐳ"}}:::plan
    First33 --> PgSelectSingle35
    PgClassExpression36{{"PgClassExpression[36∈2] ➊<br />ᐸcount(*)ᐳ"}}:::plan
    PgSelectSingle35 --> PgClassExpression36
    PgSelectRows39[["PgSelectRows[39∈2] ➊"]]:::plan
    PgSelect30 --> PgSelectRows39
    First63{{"First[63∈2] ➊"}}:::plan
    PgSelectRows39 --> First63
    First63 --> PgSelectSingle65
    PgSelect30 --> Access66
    Last69{{"Last[69∈2] ➊"}}:::plan
    PgSelectRows39 --> Last69
    Last69 --> PgSelectSingle71
    PgSelect30 --> Access75
    Lambda77{{"Lambda[77∈2] ➊<br />ᐸhasNextPageCbᐳ"}}:::plan
    Object76 --> Lambda77
    Lambda81{{"Lambda[81∈2] ➊<br />ᐸhasPreviousPageCbᐳ"}}:::plan
    Object80 --> Lambda81
    __Item60[/"__Item[60∈3]<br />ᐸ38ᐳ"\]:::itemplan
    PgSelectRows38 ==> __Item60
    PgSelectSingle61{{"PgSelectSingle[61∈3]<br />ᐸcompound_keyᐳ"}}:::plan
    __Item60 --> PgSelectSingle61
    __Item82[/"__Item[82∈4]<br />ᐸ39ᐳ"\]:::itemplan
    PgSelectRows39 ==> __Item82
    PgSelectSingle83{{"PgSelectSingle[83∈4]<br />ᐸcompound_keyᐳ"}}:::plan
    __Item82 --> PgSelectSingle83
    PgCursor85{{"PgCursor[85∈5]"}}:::plan
    PgSelectSingle61 & Access44 --> PgCursor85
    PgClassExpression88{{"PgClassExpression[88∈5]<br />ᐸ__compound...__.”extra”ᐳ"}}:::plan
    PgSelectSingle61 --> PgClassExpression88
    PgClassExpression89{{"PgClassExpression[89∈5]<br />ᐸ__compound...rson_id_1”ᐳ"}}:::plan
    PgSelectSingle61 --> PgClassExpression89
    PgClassExpression90{{"PgClassExpression[90∈5]<br />ᐸ__compound...rson_id_2”ᐳ"}}:::plan
    PgSelectSingle61 --> PgClassExpression90
    PgCursor87{{"PgCursor[87∈6]"}}:::plan
    PgSelectSingle83 & Access66 --> PgCursor87
    PgClassExpression91{{"PgClassExpression[91∈6]<br />ᐸ__compound...__.”extra”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression91
    PgClassExpression92{{"PgClassExpression[92∈6]<br />ᐸ__compound...rson_id_1”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression92
    PgClassExpression93{{"PgClassExpression[93∈6]<br />ᐸ__compound...rson_id_2”ᐳ"}}:::plan
    PgSelectSingle83 --> PgClassExpression93

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access10,Access11,Object12,Connection13,Connection19,Lambda20,Constant94,Constant95 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect22,PgPageInfo23,PgSelect24,First25,PgSelectRows26,PgSelectSingle27,PgClassExpression28,PgSelectRows38,First41,PgSelectSingle43,Access44,PgCursor45,Last47,PgSelectSingle49,PgCursor51,Access53,Object54,Lambda55,Object58,Lambda59 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgSelect30,PgPageInfo31,PgSelect32,First33,PgSelectRows34,PgSelectSingle35,PgClassExpression36,PgSelectRows39,First63,PgSelectSingle65,Access66,PgCursor67,Last69,PgSelectSingle71,PgCursor73,Access75,Object76,Lambda77,Object80,Lambda81 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item60,PgSelectSingle61 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item82,PgSelectSingle83 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgCursor85,PgClassExpression88,PgClassExpression89,PgClassExpression90 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgCursor87,PgClassExpression91,PgClassExpression92,PgClassExpression93 bucket6

