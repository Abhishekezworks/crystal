%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/v4/simple-procedure-query"
    Bucket0("Bucket 0 (root)<br /><br />1: PgSelectInlineApply[102]<br />ᐳ: 7, 9, 11, 90, 108, 109, 110, 111, 12, 27<br />2: 8, 14, 19, 24, 31, 34, 38<br />ᐳ: Access[103]<br />3: 41, 44, 47, 50, 54, 58, 62"):::bucket
    Bucket1("Bucket 1 (listItem)<br /><br />ROOT __Item{1}ᐸ41ᐳ[42]"):::bucket
    Bucket2("Bucket 2 (listItem)<br /><br />ROOT __Item{2}ᐸ44ᐳ[45]"):::bucket
    Bucket3("Bucket 3 (listItem)<br /><br />ROOT __Item{3}ᐸ47ᐳ[48]"):::bucket
    Bucket4("Bucket 4 (listItem)<br /><br />ROOT __Item{4}ᐸ50ᐳ[51]"):::bucket
    Bucket5("Bucket 5 (listItem)<br /><br />ROOT __Item{5}ᐸ54ᐳ[55]"):::bucket
    Bucket6("Bucket 6 (listItem)<br /><br />ROOT __Item{6}ᐸ58ᐳ[59]"):::bucket
    Bucket7("Bucket 7 (listItem)<br />Deps: 103<br /><br />ROOT __Item{7}ᐸ62ᐳ[63]<br />1: <br />ᐳ: 64, 105, 81, 106<br />2: PgSelectRows[91]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 43<br /><br />ROOT PgSelectSingle{1}ᐸcompound_type_set_queryᐳ[43]"):::bucket
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 46<br /><br />ROOT PgSelectSingle{2}ᐸtable_set_queryᐳ[46]"):::bucket
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 49<br /><br />ROOT PgSelectSingle{3}ᐸtable_set_queryᐳ[49]"):::bucket
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 61<br /><br />ROOT PgClassExpression{6}ᐸ__query_in...al_set__.vᐳ[61]"):::bucket
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 71<br /><br />ROOT PgClassExpression{8}ᐸ__compound...uery__.”g”ᐳ[71]"):::bucket
    Bucket13("Bucket 13 (listItem)<br /><br />ROOT __Item{13}ᐸ91ᐳ[92]"):::bucket
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 94<br /><br />ROOT PgClassExpression{13}ᐸ__post_com...al_set__.vᐳ[94]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4 & Bucket5 & Bucket6 & Bucket7
    Bucket1 --> Bucket8
    Bucket2 --> Bucket9
    Bucket3 --> Bucket10
    Bucket6 --> Bucket11
    Bucket7 --> Bucket13
    Bucket8 --> Bucket12
    Bucket13 --> Bucket14

    %% plan dependencies
    PgSelect38[["PgSelect[38∈0] ➊<br />ᐸpostᐳ"]]:::plan
    Object12{{"Object[12∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant111{{"Constant[111∈0] ➊<br />ᐸ1ᐳ"}}:::plan
    PgFromExpression90{{"PgFromExpression[90∈0] ➊"}}:::plan
    PgSelectInlineApply102["PgSelectInlineApply[102∈0] ➊"]:::plan
    Object12 & Constant111 & PgFromExpression90 & PgSelectInlineApply102 --> PgSelect38
    PgSelect19[["PgSelect[19∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Constant109{{"Constant[109∈0] ➊<br />ᐸ2ᐳ"}}:::plan
    Object12 --> PgSelect19
    Constant109 -- 2 --> PgSelect19
    PgFromExpression27{{"PgFromExpression[27∈0] ➊"}}:::plan
    Constant108{{"Constant[108∈0] ➊<br />ᐸ5ᐳ"}}:::plan
    Constant110{{"Constant[110∈0] ➊<br />ᐸ6ᐳ"}}:::plan
    Constant108 & Constant110 --> PgFromExpression27
    PgSelect8[["PgSelect[8∈0] ➊<br />ᐸcompound_type_set_queryᐳ"]]:::plan
    Object12 & Constant108 --> PgSelect8
    Access9{{"Access[9∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access9 & Access11 --> Object12
    PgSelect24[["PgSelect[24∈0] ➊<br />ᐸint_set_queryᐳ"]]:::plan
    Object12 & PgFromExpression27 --> PgSelect24
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access9
    __Value2 --> Access11
    PgSelect14[["PgSelect[14∈0] ➊<br />ᐸtable_set_queryᐳ"]]:::plan
    Object12 --> PgSelect14
    PgSelect31[["PgSelect[31∈0] ➊<br />ᐸstatic_big_integerᐳ"]]:::plan
    Object12 --> PgSelect31
    PgSelect34[["PgSelect[34∈0] ➊<br />ᐸquery_interval_setᐳ"]]:::plan
    Object12 --> PgSelect34
    PgSelectRows41[["PgSelectRows[41∈0] ➊"]]:::plan
    PgSelect8 --> PgSelectRows41
    PgSelectRows44[["PgSelectRows[44∈0] ➊"]]:::plan
    PgSelect14 --> PgSelectRows44
    PgSelectRows47[["PgSelectRows[47∈0] ➊"]]:::plan
    PgSelect19 --> PgSelectRows47
    PgSelectRows50[["PgSelectRows[50∈0] ➊"]]:::plan
    PgSelect24 --> PgSelectRows50
    PgSelectRows54[["PgSelectRows[54∈0] ➊"]]:::plan
    PgSelect31 --> PgSelectRows54
    PgSelectRows58[["PgSelectRows[58∈0] ➊"]]:::plan
    PgSelect34 --> PgSelectRows58
    PgSelectRows62[["PgSelectRows[62∈0] ➊"]]:::plan
    PgSelect38 --> PgSelectRows62
    Access103{{"Access[103∈0] ➊<br />ᐸ38.m.subqueryDetailsFor83ᐳ"}}:::plan
    PgSelect38 --> Access103
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    __Item42[/"__Item[42∈1]<br />ᐸ41ᐳ"\]:::itemplan
    PgSelectRows41 ==> __Item42
    PgSelectSingle43{{"PgSelectSingle[43∈1]<br />ᐸcompound_type_set_queryᐳ"}}:::plan
    __Item42 --> PgSelectSingle43
    PgClassExpression65{{"PgClassExpression[65∈8]<br />ᐸ__compound...uery__.”a”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression65
    PgClassExpression66{{"PgClassExpression[66∈8]<br />ᐸ__compound...uery__.”b”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression66
    PgClassExpression67{{"PgClassExpression[67∈8]<br />ᐸ__compound...uery__.”c”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression67
    PgClassExpression68{{"PgClassExpression[68∈8]<br />ᐸ__compound...uery__.”d”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression68
    PgClassExpression69{{"PgClassExpression[69∈8]<br />ᐸ__compound...uery__.”e”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression69
    PgClassExpression70{{"PgClassExpression[70∈8]<br />ᐸ__compound...uery__.”f”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression70
    PgClassExpression71{{"PgClassExpression[71∈8]<br />ᐸ__compound...uery__.”g”ᐳ"}}:::plan
    PgSelectSingle43 --> PgClassExpression71
    __Item45[/"__Item[45∈2]<br />ᐸ44ᐳ"\]:::itemplan
    PgSelectRows44 ==> __Item45
    PgSelectSingle46{{"PgSelectSingle[46∈2]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item45 --> PgSelectSingle46
    PgClassExpression72{{"PgClassExpression[72∈9]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle46 --> PgClassExpression72
    __Item48[/"__Item[48∈3]<br />ᐸ47ᐳ"\]:::itemplan
    PgSelectRows47 ==> __Item48
    PgSelectSingle49{{"PgSelectSingle[49∈3]<br />ᐸtable_set_queryᐳ"}}:::plan
    __Item48 --> PgSelectSingle49
    PgClassExpression73{{"PgClassExpression[73∈10]<br />ᐸ__table_se...full_name”ᐳ"}}:::plan
    PgSelectSingle49 --> PgClassExpression73
    __Item51[/"__Item[51∈4]<br />ᐸ50ᐳ"\]:::itemplan
    PgSelectRows50 ==> __Item51
    PgSelectSingle52{{"PgSelectSingle[52∈4]<br />ᐸint_set_queryᐳ"}}:::plan
    __Item51 --> PgSelectSingle52
    PgClassExpression53{{"PgClassExpression[53∈4]<br />ᐸ__int_set_query__.vᐳ"}}:::plan
    PgSelectSingle52 --> PgClassExpression53
    __Item55[/"__Item[55∈5]<br />ᐸ54ᐳ"\]:::itemplan
    PgSelectRows54 ==> __Item55
    PgSelectSingle56{{"PgSelectSingle[56∈5]<br />ᐸstatic_big_integerᐳ"}}:::plan
    __Item55 --> PgSelectSingle56
    PgClassExpression57{{"PgClassExpression[57∈5]<br />ᐸ__static_b...nteger__.vᐳ"}}:::plan
    PgSelectSingle56 --> PgClassExpression57
    __Item59[/"__Item[59∈6]<br />ᐸ58ᐳ"\]:::itemplan
    PgSelectRows58 ==> __Item59
    PgSelectSingle60{{"PgSelectSingle[60∈6]<br />ᐸquery_interval_setᐳ"}}:::plan
    __Item59 --> PgSelectSingle60
    PgClassExpression61{{"PgClassExpression[61∈6]<br />ᐸ__query_in...al_set__.vᐳ"}}:::plan
    PgSelectSingle60 --> PgClassExpression61
    List105{{"List[105∈7]<br />ᐸ103,63ᐳ"}}:::plan
    __Item63[/"__Item[63∈7]<br />ᐸ62ᐳ"\]:::itemplan
    Access103 & __Item63 --> List105
    PgSelectRows62 ==> __Item63
    PgSelectSingle64{{"PgSelectSingle[64∈7]<br />ᐸpostᐳ"}}:::plan
    __Item63 --> PgSelectSingle64
    PgClassExpression81{{"PgClassExpression[81∈7]<br />ᐸ__post__.”id”ᐳ"}}:::plan
    PgSelectSingle64 --> PgClassExpression81
    PgSelectRows91[["PgSelectRows[91∈7]"]]:::plan
    Lambda106{{"Lambda[106∈7]<br />ᐸpgInlineViaSubqueryTransformᐳ"}}:::plan
    Lambda106 --> PgSelectRows91
    List105 --> Lambda106
    __Item92[/"__Item[92∈13]<br />ᐸ91ᐳ"\]:::itemplan
    PgSelectRows91 ==> __Item92
    PgSelectSingle93{{"PgSelectSingle[93∈13]<br />ᐸpost_computed_interval_setᐳ"}}:::plan
    __Item92 --> PgSelectSingle93
    PgClassExpression94{{"PgClassExpression[94∈13]<br />ᐸ__post_com...al_set__.vᐳ"}}:::plan
    PgSelectSingle93 --> PgClassExpression94

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,PgSelect8,Access9,Access11,Object12,PgSelect14,PgSelect19,PgSelect24,PgFromExpression27,PgSelect31,PgSelect34,PgSelect38,PgSelectRows41,PgSelectRows44,PgSelectRows47,PgSelectRows50,PgSelectRows54,PgSelectRows58,PgSelectRows62,PgFromExpression90,PgSelectInlineApply102,Access103,Constant108,Constant109,Constant110,Constant111 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item42,PgSelectSingle43 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item45,PgSelectSingle46 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item48,PgSelectSingle49 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item51,PgSelectSingle52,PgClassExpression53 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item55,PgSelectSingle56,PgClassExpression57 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,__Item59,PgSelectSingle60,PgClassExpression61 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,__Item63,PgSelectSingle64,PgClassExpression81,PgSelectRows91,List105,Lambda106 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression65,PgClassExpression66,PgClassExpression67,PgClassExpression68,PgClassExpression69,PgClassExpression70,PgClassExpression71 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgClassExpression72 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression73 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12 bucket12
    classDef bucket13 stroke:#3cb371
    class Bucket13,__Item92,PgSelectSingle93,PgClassExpression94 bucket13
    classDef bucket14 stroke:#a52a2a
    class Bucket14 bucket14

