%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for queries/polymorphic/person-app-vulns"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (nullableBoundary)<br />Deps: 12, 13, 284, 25<br /><br />ROOT Connectionᐸ9ᐳ[13]<br />1: PgSelect[15]<br />2: PgSelectRows[16]"):::bucket
    Bucket2("Bucket 2 (listItem)<br />Deps: 12, 25<br /><br />ROOT __Item{2}ᐸ16ᐳ[17]"):::bucket
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 18, 12, 25<br /><br />ROOT PgSelectSingle{2}ᐸpeopleᐳ[18]<br />1: <br />ᐳ: 19, 20<br />2: 26, 31, 32<br />ᐳ: 273, 274, 283, 27<br />3: PgUnionAllSingle[29]<br />ᐳ: PgClassExpression[30]"):::bucket
    Bucket4("Bucket 4 (listItem)<br />Deps: 31, 12<br /><br />ROOT __Item{4}ᐸ274ᐳ[34]"):::bucket
    Bucket5("Bucket 5 (listItem)<br />Deps: 12<br /><br />ROOT __Item{5}ᐸ283ᐳ[37]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 35, 56, 12<br /><br />ROOT PgUnionAllSingle{4}[35]"):::bucket
    Bucket7("Bucket 7 (polymorphic)<br />AwsApplication,GcpApplication<br />Deps: 39, 12, 38<br />ᐳAwsApplication<br />ᐳGcpApplication<br /><br />1: JSONParse[40]<br />ᐳ: 72, 87, 41<br />2: PgSelect[42], PgSelect[51]<br />3: PgSelectRows[47], PgSelectRows[54]<br />ᐳ: 46, 48, 53, 55, 58, 59, 60, 61, 62, 73, 74, 75, 76, 77<br />4: 63, 68, 78, 83, 168, 173, 195, 200<br />ᐳ: 275, 276, 277, 278, 279, 280, 281, 282, 65, 80, 169, 196<br />5: 67, 82, 171, 198<br />ᐳ: 105, 125, 172, 199"):::bucket
    Bucket8("Bucket 8 (polymorphic)<br />AwsApplication,GcpApplication<br />Deps: 88, 12, 35<br />ᐳAwsApplication<br />ᐳGcpApplication<br /><br />1: JSONParse[89]<br />ᐳ: Access[90]<br />2: PgSelect[91], PgSelect[100]<br />3: PgSelectRows[96], PgSelectRows[103]<br />ᐳ: 95, 97, 102, 104, 145, 146"):::bucket
    Bucket9("Bucket 9 (polymorphic)<br />Organization,Person<br />Deps: 105, 12, 67<br />ᐳAwsApplicationᐳOrganization<br />ᐳAwsApplicationᐳPerson<br /><br />1: JSONParse[106]<br />ᐳ: Access[107]<br />2: PgSelect[108], PgSelect[117]<br />3: PgSelectRows[113], PgSelectRows[120]<br />ᐳ: 112, 114, 119, 121, 147, 148, 149, 150"):::bucket
    Bucket10("Bucket 10 (listItem)<br />Deps: 12<br /><br />ROOT __Item{10}ᐸ275ᐳ[123]"):::bucket
    Bucket11("Bucket 11 (polymorphic)<br />Organization,Person<br />Deps: 125, 12, 82<br />ᐳGcpApplicationᐳOrganization<br />ᐳGcpApplicationᐳPerson<br /><br />1: JSONParse[126]<br />ᐳ: Access[127]<br />2: PgSelect[128], PgSelect[137]<br />3: PgSelectRows[133], PgSelectRows[140]<br />ᐳ: 132, 134, 139, 141, 174, 175, 176, 177"):::bucket
    Bucket12("Bucket 12 (listItem)<br />Deps: 12<br /><br />ROOT __Item{12}ᐸ279ᐳ[143]"):::bucket
    Bucket13("Bucket 13 (polymorphic)<br />FirstPartyVulnerability,ThirdPartyVulnerability<br />Deps: 151, 12, 124<br />ᐳAwsApplicationᐳFirstPartyVulnerability<br />ᐳAwsApplicationᐳThirdPartyVulnerability<br /><br />1: JSONParse[152]<br />ᐳ: Access[153]<br />2: PgSelect[154], PgSelect[163]<br />3: PgSelectRows[159], PgSelectRows[166]<br />ᐳ: 158, 160, 165, 167, 201, 202, 203, 204, 205, 206, 207, 208"):::bucket
    Bucket14("Bucket 14 (polymorphic)<br />FirstPartyVulnerability,ThirdPartyVulnerability<br />Deps: 178, 12, 144<br />ᐳGcpApplicationᐳFirstPartyVulnerability<br />ᐳGcpApplicationᐳThirdPartyVulnerability<br /><br />1: JSONParse[179]<br />ᐳ: Access[180]<br />2: PgSelect[181], PgSelect[190]<br />3: PgSelectRows[186], PgSelectRows[193]<br />ᐳ: 185, 187, 192, 194, 212, 213, 214, 215, 216, 217, 218, 219"):::bucket
    Bucket15("Bucket 15 (listItem)<br />Deps: 173, 12<br /><br />ROOT __Item{15}ᐸ277ᐳ[210]"):::bucket
    Bucket16("Bucket 16 (listItem)<br />Deps: 200, 12<br /><br />ROOT __Item{16}ᐸ281ᐳ[221]"):::bucket
    Bucket17("Bucket 17 (nullableBoundary)<br />Deps: 211, 223, 12<br /><br />ROOT PgUnionAllSingle{15}[211]"):::bucket
    Bucket18("Bucket 18 (nullableBoundary)<br />Deps: 222, 225, 12<br /><br />ROOT PgUnionAllSingle{16}[222]"):::bucket
    Bucket19("Bucket 19 (polymorphic)<br />FirstPartyVulnerability,ThirdPartyVulnerability<br />Deps: 227, 12, 211<br />ᐳAwsApplicationᐳFirstPartyVulnerability<br />ᐳAwsApplicationᐳThirdPartyVulnerability<br /><br />1: JSONParse[228]<br />ᐳ: Access[229]<br />2: PgSelect[230], PgSelect[239]<br />3: PgSelectRows[235], PgSelectRows[242]<br />ᐳ: 234, 236, 241, 243, 261, 262, 263, 264, 265, 266"):::bucket
    Bucket20("Bucket 20 (polymorphic)<br />FirstPartyVulnerability,ThirdPartyVulnerability<br />Deps: 244, 12, 222<br />ᐳGcpApplicationᐳFirstPartyVulnerability<br />ᐳGcpApplicationᐳThirdPartyVulnerability<br /><br />1: JSONParse[245]<br />ᐳ: Access[246]<br />2: PgSelect[247], PgSelect[256]<br />3: PgSelectRows[252], PgSelectRows[259]<br />ᐳ: 251, 253, 258, 260, 267, 268, 269, 270, 271, 272"):::bucket
    end
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4 & Bucket5
    Bucket4 --> Bucket6
    Bucket5 --> Bucket7
    Bucket6 --> Bucket8
    Bucket7 --> Bucket9 & Bucket10 & Bucket11 & Bucket12 & Bucket15 & Bucket16
    Bucket10 --> Bucket13
    Bucket12 --> Bucket14
    Bucket15 --> Bucket17
    Bucket16 --> Bucket18
    Bucket17 --> Bucket19
    Bucket18 --> Bucket20

    %% plan dependencies
    Object12{{"Object[12∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access10 & Access11 --> Object12
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access10
    __Value2 --> Access11
    Connection13{{"Connection[13∈0] ➊<br />ᐸ9ᐳ"}}:::plan
    Constant284{{"Constant[284∈0] ➊<br />ᐸ4ᐳ"}}:::plan
    Constant284 --> Connection13
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Connection25{{"Connection[25∈0] ➊<br />ᐸ21ᐳ"}}:::plan
    PgSelect15[["PgSelect[15∈1] ➊<br />ᐸpeopleᐳ"]]:::plan
    Object12 & Connection13 & Constant284 --> PgSelect15
    PgSelectRows16[["PgSelectRows[16∈1] ➊"]]:::plan
    PgSelect15 --> PgSelectRows16
    __Item17[/"__Item[17∈2]<br />ᐸ16ᐳ"\]:::itemplan
    PgSelectRows16 ==> __Item17
    PgSelectSingle18{{"PgSelectSingle[18∈2]<br />ᐸpeopleᐳ"}}:::plan
    __Item17 --> PgSelectSingle18
    PgUnionAll26[["PgUnionAll[26∈3]"]]:::plan
    PgClassExpression19{{"PgClassExpression[19∈3]<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    Object12 & PgClassExpression19 & Connection25 --> PgUnionAll26
    PgUnionAll31[["PgUnionAll[31∈3]"]]:::plan
    Object12 & PgClassExpression19 & Connection25 --> PgUnionAll31
    PgUnionAll32[["PgUnionAll[32∈3]"]]:::plan
    Object12 & PgClassExpression19 & Connection25 --> PgUnionAll32
    PgSelectSingle18 --> PgClassExpression19
    PgClassExpression20{{"PgClassExpression[20∈3]<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle18 --> PgClassExpression20
    First27{{"First[27∈3]"}}:::plan
    Access273{{"Access[273∈3]<br />ᐸ26.itemsᐳ"}}:::plan
    Access273 --> First27
    PgUnionAllSingle29["PgUnionAllSingle[29∈3]"]:::plan
    First27 --> PgUnionAllSingle29
    PgClassExpression30{{"PgClassExpression[30∈3]<br />ᐸcount(*)ᐳ"}}:::plan
    PgUnionAllSingle29 --> PgClassExpression30
    PgUnionAll26 --> Access273
    Access274{{"Access[274∈3]<br />ᐸ31.itemsᐳ"}}:::plan
    PgUnionAll31 --> Access274
    Access283{{"Access[283∈3]<br />ᐸ32.itemsᐳ"}}:::plan
    PgUnionAll32 --> Access283
    __Item34[/"__Item[34∈4]<br />ᐸ274ᐳ"\]:::itemplan
    Access274 ==> __Item34
    PgUnionAllSingle35["PgUnionAllSingle[35∈4]"]:::plan
    __Item34 --> PgUnionAllSingle35
    Access56{{"Access[56∈4]<br />ᐸ31.cursorDetailsᐳ"}}:::plan
    PgUnionAll31 --> Access56
    PgCursor57{{"PgCursor[57∈6]"}}:::plan
    PgUnionAllSingle35 & Access56 --> PgCursor57
    Access88{{"Access[88∈6]<br />ᐸ35.1ᐳ"}}:::plan
    PgUnionAllSingle35 --> Access88
    PgSelect91[["PgSelect[91∈8]<br />ᐸaws_applicationsᐳ<br />ᐳAwsApplication"]]:::plan
    Access90{{"Access[90∈8]^<br />ᐸ89.0ᐳ"}}:::plan
    Object12 & Access90 --> PgSelect91
    PgSelect100[["PgSelect[100∈8]<br />ᐸgcp_applicationsᐳ<br />ᐳGcpApplication"]]:::plan
    Object12 & Access90 --> PgSelect100
    JSONParse89[["JSONParse[89∈8]<br />ᐸ88ᐳ<br />ᐳAwsApplication<br />ᐳGcpApplication"]]:::plan
    Access88 --> JSONParse89
    JSONParse89 --> Access90
    First95{{"First[95∈8]^"}}:::plan
    PgSelectRows96[["PgSelectRows[96∈8]^"]]:::plan
    PgSelectRows96 --> First95
    PgSelect91 --> PgSelectRows96
    PgSelectSingle97{{"PgSelectSingle[97∈8]^<br />ᐸaws_applicationsᐳ"}}:::plan
    First95 --> PgSelectSingle97
    First102{{"First[102∈8]^"}}:::plan
    PgSelectRows103[["PgSelectRows[103∈8]^"]]:::plan
    PgSelectRows103 --> First102
    PgSelect100 --> PgSelectRows103
    PgSelectSingle104{{"PgSelectSingle[104∈8]^<br />ᐸgcp_applicationsᐳ"}}:::plan
    First102 --> PgSelectSingle104
    PgClassExpression145{{"PgClassExpression[145∈8]^<br />ᐸ__aws_appl...ons__.”id”ᐳ"}}:::plan
    PgSelectSingle97 --> PgClassExpression145
    PgClassExpression146{{"PgClassExpression[146∈8]^<br />ᐸ__gcp_appl...ons__.”id”ᐳ"}}:::plan
    PgSelectSingle104 --> PgClassExpression146
    __Item37[/"__Item[37∈5]<br />ᐸ283ᐳ"\]:::itemplan
    Access283 ==> __Item37
    PgUnionAllSingle38["PgUnionAllSingle[38∈5]"]:::plan
    __Item37 --> PgUnionAllSingle38
    Access39{{"Access[39∈5]<br />ᐸ38.1ᐳ"}}:::plan
    PgUnionAllSingle38 --> Access39
    PgUnionAll63[["PgUnionAll[63∈7]^"]]:::plan
    PgClassExpression61{{"PgClassExpression[61∈7]^<br />ᐸ__aws_appl...person_id”ᐳ"}}:::plan
    PgClassExpression62{{"PgClassExpression[62∈7]^<br />ᐸ__aws_appl...zation_id”ᐳ"}}:::plan
    Object12 & PgClassExpression61 & PgClassExpression62 --> PgUnionAll63
    PgUnionAll78[["PgUnionAll[78∈7]^"]]:::plan
    PgClassExpression76{{"PgClassExpression[76∈7]^<br />ᐸ__gcp_appl...person_id”ᐳ"}}:::plan
    PgClassExpression77{{"PgClassExpression[77∈7]^<br />ᐸ__gcp_appl...zation_id”ᐳ"}}:::plan
    Object12 & PgClassExpression76 & PgClassExpression77 --> PgUnionAll78
    PgUnionAll168[["PgUnionAll[168∈7]^"]]:::plan
    PgClassExpression59{{"PgClassExpression[59∈7]^<br />ᐸ__aws_appl...ons__.”id”ᐳ"}}:::plan
    Connection72{{"Connection[72∈7] ➊<br />ᐸ70ᐳ<br />ᐳAwsApplication"}}:::plan
    Object12 & PgClassExpression59 & Connection72 --> PgUnionAll168
    PgUnionAll173[["PgUnionAll[173∈7]^"]]:::plan
    Object12 & PgClassExpression59 & Connection72 --> PgUnionAll173
    PgUnionAll195[["PgUnionAll[195∈7]^"]]:::plan
    PgClassExpression74{{"PgClassExpression[74∈7]^<br />ᐸ__gcp_appl...ons__.”id”ᐳ"}}:::plan
    Connection87{{"Connection[87∈7] ➊<br />ᐸ85ᐳ<br />ᐳGcpApplication"}}:::plan
    Object12 & PgClassExpression74 & Connection87 --> PgUnionAll195
    PgUnionAll200[["PgUnionAll[200∈7]^"]]:::plan
    Object12 & PgClassExpression74 & Connection87 --> PgUnionAll200
    PgSelect42[["PgSelect[42∈7]<br />ᐸaws_applicationsᐳ<br />ᐳAwsApplication"]]:::plan
    Access41{{"Access[41∈7]^<br />ᐸ40.0ᐳ"}}:::plan
    Object12 & Access41 --> PgSelect42
    PgSelect51[["PgSelect[51∈7]<br />ᐸgcp_applicationsᐳ<br />ᐳGcpApplication"]]:::plan
    Object12 & Access41 --> PgSelect51
    PgUnionAll68[["PgUnionAll[68∈7]^"]]:::plan
    Object12 & PgClassExpression59 --> PgUnionAll68
    PgUnionAll83[["PgUnionAll[83∈7]^"]]:::plan
    Object12 & PgClassExpression74 --> PgUnionAll83
    JSONParse40[["JSONParse[40∈7]<br />ᐸ39ᐳ<br />ᐳAwsApplication<br />ᐳGcpApplication"]]:::plan
    Access39 --> JSONParse40
    JSONParse40 --> Access41
    First46{{"First[46∈7]^"}}:::plan
    PgSelectRows47[["PgSelectRows[47∈7]^"]]:::plan
    PgSelectRows47 --> First46
    PgSelect42 --> PgSelectRows47
    PgSelectSingle48{{"PgSelectSingle[48∈7]^<br />ᐸaws_applicationsᐳ"}}:::plan
    First46 --> PgSelectSingle48
    First53{{"First[53∈7]^"}}:::plan
    PgSelectRows54[["PgSelectRows[54∈7]^"]]:::plan
    PgSelectRows54 --> First53
    PgSelect51 --> PgSelectRows54
    PgSelectSingle55{{"PgSelectSingle[55∈7]^<br />ᐸgcp_applicationsᐳ"}}:::plan
    First53 --> PgSelectSingle55
    PgClassExpression58{{"PgClassExpression[58∈7]^<br />ᐸ__aws_appl..._.”aws_id”ᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression58
    PgSelectSingle48 --> PgClassExpression59
    PgClassExpression60{{"PgClassExpression[60∈7]^<br />ᐸ__aws_appl...s__.”name”ᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression60
    PgSelectSingle48 --> PgClassExpression61
    PgSelectSingle48 --> PgClassExpression62
    First65{{"First[65∈7]^"}}:::plan
    Access278{{"Access[278∈7]^<br />ᐸ63.itemsᐳ"}}:::plan
    Access278 --> First65
    PgUnionAllSingle67["PgUnionAllSingle[67∈7]^"]:::plan
    First65 --> PgUnionAllSingle67
    PgClassExpression73{{"PgClassExpression[73∈7]^<br />ᐸ__gcp_appl..._.”gcp_id”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression73
    PgSelectSingle55 --> PgClassExpression74
    PgClassExpression75{{"PgClassExpression[75∈7]^<br />ᐸ__gcp_appl...s__.”name”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression75
    PgSelectSingle55 --> PgClassExpression76
    PgSelectSingle55 --> PgClassExpression77
    First80{{"First[80∈7]^"}}:::plan
    Access282{{"Access[282∈7]^<br />ᐸ78.itemsᐳ"}}:::plan
    Access282 --> First80
    PgUnionAllSingle82["PgUnionAllSingle[82∈7]^"]:::plan
    First80 --> PgUnionAllSingle82
    Access105{{"Access[105∈7]^<br />ᐸ67.1ᐳ"}}:::plan
    PgUnionAllSingle67 --> Access105
    Access125{{"Access[125∈7]^<br />ᐸ82.1ᐳ"}}:::plan
    PgUnionAllSingle82 --> Access125
    First169{{"First[169∈7]^"}}:::plan
    Access276{{"Access[276∈7]^<br />ᐸ168.itemsᐳ"}}:::plan
    Access276 --> First169
    PgUnionAllSingle171["PgUnionAllSingle[171∈7]^"]:::plan
    First169 --> PgUnionAllSingle171
    PgClassExpression172{{"PgClassExpression[172∈7]^<br />ᐸcount(*)ᐳ"}}:::plan
    PgUnionAllSingle171 --> PgClassExpression172
    First196{{"First[196∈7]^"}}:::plan
    Access280{{"Access[280∈7]^<br />ᐸ195.itemsᐳ"}}:::plan
    Access280 --> First196
    PgUnionAllSingle198["PgUnionAllSingle[198∈7]^"]:::plan
    First196 --> PgUnionAllSingle198
    PgClassExpression199{{"PgClassExpression[199∈7]^<br />ᐸcount(*)ᐳ"}}:::plan
    PgUnionAllSingle198 --> PgClassExpression199
    Access275{{"Access[275∈7]^<br />ᐸ68.itemsᐳ"}}:::plan
    PgUnionAll68 --> Access275
    PgUnionAll168 --> Access276
    Access277{{"Access[277∈7]^<br />ᐸ173.itemsᐳ"}}:::plan
    PgUnionAll173 --> Access277
    PgUnionAll63 --> Access278
    Access279{{"Access[279∈7]^<br />ᐸ83.itemsᐳ"}}:::plan
    PgUnionAll83 --> Access279
    PgUnionAll195 --> Access280
    Access281{{"Access[281∈7]^<br />ᐸ200.itemsᐳ"}}:::plan
    PgUnionAll200 --> Access281
    PgUnionAll78 --> Access282
    PgSelect108[["PgSelect[108∈9]<br />ᐸorganizationsᐳ<br />ᐳAwsApplicationᐳOrganization"]]:::plan
    Access107{{"Access[107∈9]^<br />ᐸ106.0ᐳ"}}:::plan
    Object12 & Access107 --> PgSelect108
    PgSelect117[["PgSelect[117∈9]<br />ᐸpeopleᐳ<br />ᐳAwsApplicationᐳPerson"]]:::plan
    Object12 & Access107 --> PgSelect117
    JSONParse106[["JSONParse[106∈9]<br />ᐸ105ᐳ<br />ᐳAwsApplicationᐳOrganization<br />ᐳAwsApplicationᐳPerson"]]:::plan
    Access105 --> JSONParse106
    JSONParse106 --> Access107
    First112{{"First[112∈9]^"}}:::plan
    PgSelectRows113[["PgSelectRows[113∈9]^"]]:::plan
    PgSelectRows113 --> First112
    PgSelect108 --> PgSelectRows113
    PgSelectSingle114{{"PgSelectSingle[114∈9]^<br />ᐸorganizationsᐳ"}}:::plan
    First112 --> PgSelectSingle114
    First119{{"First[119∈9]^"}}:::plan
    PgSelectRows120[["PgSelectRows[120∈9]^"]]:::plan
    PgSelectRows120 --> First119
    PgSelect117 --> PgSelectRows120
    PgSelectSingle121{{"PgSelectSingle[121∈9]^<br />ᐸpeopleᐳ"}}:::plan
    First119 --> PgSelectSingle121
    PgClassExpression147{{"PgClassExpression[147∈9]^<br />ᐸ__organiza...zation_id”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression147
    PgClassExpression148{{"PgClassExpression[148∈9]^<br />ᐸ__organiza...s__.”name”ᐳ"}}:::plan
    PgSelectSingle114 --> PgClassExpression148
    PgClassExpression149{{"PgClassExpression[149∈9]^<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle121 --> PgClassExpression149
    PgClassExpression150{{"PgClassExpression[150∈9]^<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle121 --> PgClassExpression150
    __Item123[/"__Item[123∈10]<br />ᐸ275ᐳ<br />ᐳAwsApplication"\]:::itemplan
    Access275 ==> __Item123
    PgUnionAllSingle124["PgUnionAllSingle[124∈10]^"]:::plan
    __Item123 --> PgUnionAllSingle124
    Access151{{"Access[151∈10]^<br />ᐸ124.1ᐳ"}}:::plan
    PgUnionAllSingle124 --> Access151
    PgSelect154[["PgSelect[154∈13]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳAwsApplicationᐳFirstPartyVulnerability"]]:::plan
    Access153{{"Access[153∈13]^<br />ᐸ152.0ᐳ"}}:::plan
    Object12 & Access153 --> PgSelect154
    PgSelect163[["PgSelect[163∈13]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳAwsApplicationᐳThirdPartyVulnerability"]]:::plan
    Object12 & Access153 --> PgSelect163
    JSONParse152[["JSONParse[152∈13]<br />ᐸ151ᐳ<br />ᐳAwsApplicationᐳFirstPartyVulnerability<br />ᐳAwsApplicationᐳThirdPartyVulnerability"]]:::plan
    Access151 --> JSONParse152
    JSONParse152 --> Access153
    First158{{"First[158∈13]^"}}:::plan
    PgSelectRows159[["PgSelectRows[159∈13]^"]]:::plan
    PgSelectRows159 --> First158
    PgSelect154 --> PgSelectRows159
    PgSelectSingle160{{"PgSelectSingle[160∈13]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First158 --> PgSelectSingle160
    First165{{"First[165∈13]^"}}:::plan
    PgSelectRows166[["PgSelectRows[166∈13]^"]]:::plan
    PgSelectRows166 --> First165
    PgSelect163 --> PgSelectRows166
    PgSelectSingle167{{"PgSelectSingle[167∈13]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First165 --> PgSelectSingle167
    PgClassExpression201{{"PgClassExpression[201∈13]^<br />ᐸ__first_pa...team_name”ᐳ"}}:::plan
    PgSelectSingle160 --> PgClassExpression201
    PgClassExpression202{{"PgClassExpression[202∈13]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle160 --> PgClassExpression202
    PgClassExpression203{{"PgClassExpression[203∈13]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle160 --> PgClassExpression203
    PgClassExpression204{{"PgClassExpression[204∈13]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle160 --> PgClassExpression204
    PgClassExpression205{{"PgClassExpression[205∈13]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgSelectSingle167 --> PgClassExpression205
    PgClassExpression206{{"PgClassExpression[206∈13]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle167 --> PgClassExpression206
    PgClassExpression207{{"PgClassExpression[207∈13]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle167 --> PgClassExpression207
    PgClassExpression208{{"PgClassExpression[208∈13]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle167 --> PgClassExpression208
    PgSelect128[["PgSelect[128∈11]<br />ᐸorganizationsᐳ<br />ᐳGcpApplicationᐳOrganization"]]:::plan
    Access127{{"Access[127∈11]^<br />ᐸ126.0ᐳ"}}:::plan
    Object12 & Access127 --> PgSelect128
    PgSelect137[["PgSelect[137∈11]<br />ᐸpeopleᐳ<br />ᐳGcpApplicationᐳPerson"]]:::plan
    Object12 & Access127 --> PgSelect137
    JSONParse126[["JSONParse[126∈11]<br />ᐸ125ᐳ<br />ᐳGcpApplicationᐳOrganization<br />ᐳGcpApplicationᐳPerson"]]:::plan
    Access125 --> JSONParse126
    JSONParse126 --> Access127
    First132{{"First[132∈11]^"}}:::plan
    PgSelectRows133[["PgSelectRows[133∈11]^"]]:::plan
    PgSelectRows133 --> First132
    PgSelect128 --> PgSelectRows133
    PgSelectSingle134{{"PgSelectSingle[134∈11]^<br />ᐸorganizationsᐳ"}}:::plan
    First132 --> PgSelectSingle134
    First139{{"First[139∈11]^"}}:::plan
    PgSelectRows140[["PgSelectRows[140∈11]^"]]:::plan
    PgSelectRows140 --> First139
    PgSelect137 --> PgSelectRows140
    PgSelectSingle141{{"PgSelectSingle[141∈11]^<br />ᐸpeopleᐳ"}}:::plan
    First139 --> PgSelectSingle141
    PgClassExpression174{{"PgClassExpression[174∈11]^<br />ᐸ__organiza...zation_id”ᐳ"}}:::plan
    PgSelectSingle134 --> PgClassExpression174
    PgClassExpression175{{"PgClassExpression[175∈11]^<br />ᐸ__organiza...s__.”name”ᐳ"}}:::plan
    PgSelectSingle134 --> PgClassExpression175
    PgClassExpression176{{"PgClassExpression[176∈11]^<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle141 --> PgClassExpression176
    PgClassExpression177{{"PgClassExpression[177∈11]^<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle141 --> PgClassExpression177
    __Item143[/"__Item[143∈12]<br />ᐸ279ᐳ<br />ᐳGcpApplication"\]:::itemplan
    Access279 ==> __Item143
    PgUnionAllSingle144["PgUnionAllSingle[144∈12]^"]:::plan
    __Item143 --> PgUnionAllSingle144
    Access178{{"Access[178∈12]^<br />ᐸ144.1ᐳ"}}:::plan
    PgUnionAllSingle144 --> Access178
    PgSelect181[["PgSelect[181∈14]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳGcpApplicationᐳFirstPartyVulnerability"]]:::plan
    Access180{{"Access[180∈14]^<br />ᐸ179.0ᐳ"}}:::plan
    Object12 & Access180 --> PgSelect181
    PgSelect190[["PgSelect[190∈14]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳGcpApplicationᐳThirdPartyVulnerability"]]:::plan
    Object12 & Access180 --> PgSelect190
    JSONParse179[["JSONParse[179∈14]<br />ᐸ178ᐳ<br />ᐳGcpApplicationᐳFirstPartyVulnerability<br />ᐳGcpApplicationᐳThirdPartyVulnerability"]]:::plan
    Access178 --> JSONParse179
    JSONParse179 --> Access180
    First185{{"First[185∈14]^"}}:::plan
    PgSelectRows186[["PgSelectRows[186∈14]^"]]:::plan
    PgSelectRows186 --> First185
    PgSelect181 --> PgSelectRows186
    PgSelectSingle187{{"PgSelectSingle[187∈14]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First185 --> PgSelectSingle187
    First192{{"First[192∈14]^"}}:::plan
    PgSelectRows193[["PgSelectRows[193∈14]^"]]:::plan
    PgSelectRows193 --> First192
    PgSelect190 --> PgSelectRows193
    PgSelectSingle194{{"PgSelectSingle[194∈14]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First192 --> PgSelectSingle194
    PgClassExpression212{{"PgClassExpression[212∈14]^<br />ᐸ__first_pa...team_name”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression212
    PgClassExpression213{{"PgClassExpression[213∈14]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression213
    PgClassExpression214{{"PgClassExpression[214∈14]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression214
    PgClassExpression215{{"PgClassExpression[215∈14]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle187 --> PgClassExpression215
    PgClassExpression216{{"PgClassExpression[216∈14]^<br />ᐸ__third_pa...ndor_name”ᐳ"}}:::plan
    PgSelectSingle194 --> PgClassExpression216
    PgClassExpression217{{"PgClassExpression[217∈14]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle194 --> PgClassExpression217
    PgClassExpression218{{"PgClassExpression[218∈14]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle194 --> PgClassExpression218
    PgClassExpression219{{"PgClassExpression[219∈14]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle194 --> PgClassExpression219
    __Item210[/"__Item[210∈15]<br />ᐸ277ᐳ<br />ᐳAwsApplication"\]:::itemplan
    Access277 ==> __Item210
    PgUnionAllSingle211["PgUnionAllSingle[211∈15]^"]:::plan
    __Item210 --> PgUnionAllSingle211
    Access223{{"Access[223∈15]<br />ᐸ173.cursorDetailsᐳ<br />ᐳAwsApplication"}}:::plan
    PgUnionAll173 --> Access223
    PgCursor224{{"PgCursor[224∈17]<br />ᐳAwsApplication"}}:::plan
    PgUnionAllSingle211 & Access223 --> PgCursor224
    Access227{{"Access[227∈17]<br />ᐸ211.1ᐳ<br />ᐳAwsApplication"}}:::plan
    PgUnionAllSingle211 --> Access227
    PgSelect230[["PgSelect[230∈19]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳAwsApplicationᐳFirstPartyVulnerability"]]:::plan
    Access229{{"Access[229∈19]^<br />ᐸ228.0ᐳ"}}:::plan
    Object12 & Access229 --> PgSelect230
    PgSelect239[["PgSelect[239∈19]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳAwsApplicationᐳThirdPartyVulnerability"]]:::plan
    Object12 & Access229 --> PgSelect239
    JSONParse228[["JSONParse[228∈19]<br />ᐸ227ᐳ<br />ᐳAwsApplicationᐳFirstPartyVulnerability<br />ᐳAwsApplicationᐳThirdPartyVulnerability"]]:::plan
    Access227 --> JSONParse228
    JSONParse228 --> Access229
    First234{{"First[234∈19]^"}}:::plan
    PgSelectRows235[["PgSelectRows[235∈19]^"]]:::plan
    PgSelectRows235 --> First234
    PgSelect230 --> PgSelectRows235
    PgSelectSingle236{{"PgSelectSingle[236∈19]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First234 --> PgSelectSingle236
    First241{{"First[241∈19]^"}}:::plan
    PgSelectRows242[["PgSelectRows[242∈19]^"]]:::plan
    PgSelectRows242 --> First241
    PgSelect239 --> PgSelectRows242
    PgSelectSingle243{{"PgSelectSingle[243∈19]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First241 --> PgSelectSingle243
    PgClassExpression261{{"PgClassExpression[261∈19]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle236 --> PgClassExpression261
    PgClassExpression262{{"PgClassExpression[262∈19]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle236 --> PgClassExpression262
    PgClassExpression263{{"PgClassExpression[263∈19]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle236 --> PgClassExpression263
    PgClassExpression264{{"PgClassExpression[264∈19]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle243 --> PgClassExpression264
    PgClassExpression265{{"PgClassExpression[265∈19]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle243 --> PgClassExpression265
    PgClassExpression266{{"PgClassExpression[266∈19]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle243 --> PgClassExpression266
    __Item221[/"__Item[221∈16]<br />ᐸ281ᐳ<br />ᐳGcpApplication"\]:::itemplan
    Access281 ==> __Item221
    PgUnionAllSingle222["PgUnionAllSingle[222∈16]^"]:::plan
    __Item221 --> PgUnionAllSingle222
    Access225{{"Access[225∈16]<br />ᐸ200.cursorDetailsᐳ<br />ᐳGcpApplication"}}:::plan
    PgUnionAll200 --> Access225
    PgCursor226{{"PgCursor[226∈18]<br />ᐳGcpApplication"}}:::plan
    PgUnionAllSingle222 & Access225 --> PgCursor226
    Access244{{"Access[244∈18]<br />ᐸ222.1ᐳ<br />ᐳGcpApplication"}}:::plan
    PgUnionAllSingle222 --> Access244
    PgSelect247[["PgSelect[247∈20]<br />ᐸfirst_party_vulnerabilitiesᐳ<br />ᐳGcpApplicationᐳFirstPartyVulnerability"]]:::plan
    Access246{{"Access[246∈20]^<br />ᐸ245.0ᐳ"}}:::plan
    Object12 & Access246 --> PgSelect247
    PgSelect256[["PgSelect[256∈20]<br />ᐸthird_party_vulnerabilitiesᐳ<br />ᐳGcpApplicationᐳThirdPartyVulnerability"]]:::plan
    Object12 & Access246 --> PgSelect256
    JSONParse245[["JSONParse[245∈20]<br />ᐸ244ᐳ<br />ᐳGcpApplicationᐳFirstPartyVulnerability<br />ᐳGcpApplicationᐳThirdPartyVulnerability"]]:::plan
    Access244 --> JSONParse245
    JSONParse245 --> Access246
    First251{{"First[251∈20]^"}}:::plan
    PgSelectRows252[["PgSelectRows[252∈20]^"]]:::plan
    PgSelectRows252 --> First251
    PgSelect247 --> PgSelectRows252
    PgSelectSingle253{{"PgSelectSingle[253∈20]^<br />ᐸfirst_party_vulnerabilitiesᐳ"}}:::plan
    First251 --> PgSelectSingle253
    First258{{"First[258∈20]^"}}:::plan
    PgSelectRows259[["PgSelectRows[259∈20]^"]]:::plan
    PgSelectRows259 --> First258
    PgSelect256 --> PgSelectRows259
    PgSelectSingle260{{"PgSelectSingle[260∈20]^<br />ᐸthird_party_vulnerabilitiesᐳ"}}:::plan
    First258 --> PgSelectSingle260
    PgClassExpression267{{"PgClassExpression[267∈20]^<br />ᐸ__first_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle253 --> PgClassExpression267
    PgClassExpression268{{"PgClassExpression[268∈20]^<br />ᐸ__first_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle253 --> PgClassExpression268
    PgClassExpression269{{"PgClassExpression[269∈20]^<br />ᐸ__first_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle253 --> PgClassExpression269
    PgClassExpression270{{"PgClassExpression[270∈20]^<br />ᐸ__third_pa...vss_score”ᐳ"}}:::plan
    PgSelectSingle260 --> PgClassExpression270
    PgClassExpression271{{"PgClassExpression[271∈20]^<br />ᐸ__third_pa...ies__.”id”ᐳ"}}:::plan
    PgSelectSingle260 --> PgClassExpression271
    PgClassExpression272{{"PgClassExpression[272∈20]^<br />ᐸ__third_pa...s__.”name”ᐳ"}}:::plan
    PgSelectSingle260 --> PgClassExpression272

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access10,Access11,Object12,Connection13,Connection25,Constant284 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect15,PgSelectRows16 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item17,PgSelectSingle18 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression19,PgClassExpression20,PgUnionAll26,First27,PgUnionAllSingle29,PgClassExpression30,PgUnionAll31,PgUnionAll32,Access273,Access274,Access283 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item34,PgUnionAllSingle35,Access56 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item37,PgUnionAllSingle38,Access39 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgCursor57,Access88 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,JSONParse40,Access41,PgSelect42,First46,PgSelectRows47,PgSelectSingle48,PgSelect51,First53,PgSelectRows54,PgSelectSingle55,PgClassExpression58,PgClassExpression59,PgClassExpression60,PgClassExpression61,PgClassExpression62,PgUnionAll63,First65,PgUnionAllSingle67,PgUnionAll68,Connection72,PgClassExpression73,PgClassExpression74,PgClassExpression75,PgClassExpression76,PgClassExpression77,PgUnionAll78,First80,PgUnionAllSingle82,PgUnionAll83,Connection87,Access105,Access125,PgUnionAll168,First169,PgUnionAllSingle171,PgClassExpression172,PgUnionAll173,PgUnionAll195,First196,PgUnionAllSingle198,PgClassExpression199,PgUnionAll200,Access275,Access276,Access277,Access278,Access279,Access280,Access281,Access282 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,JSONParse89,Access90,PgSelect91,First95,PgSelectRows96,PgSelectSingle97,PgSelect100,First102,PgSelectRows103,PgSelectSingle104,PgClassExpression145,PgClassExpression146 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,JSONParse106,Access107,PgSelect108,First112,PgSelectRows113,PgSelectSingle114,PgSelect117,First119,PgSelectRows120,PgSelectSingle121,PgClassExpression147,PgClassExpression148,PgClassExpression149,PgClassExpression150 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item123,PgUnionAllSingle124,Access151 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,JSONParse126,Access127,PgSelect128,First132,PgSelectRows133,PgSelectSingle134,PgSelect137,First139,PgSelectRows140,PgSelectSingle141,PgClassExpression174,PgClassExpression175,PgClassExpression176,PgClassExpression177 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12,__Item143,PgUnionAllSingle144,Access178 bucket12
    classDef bucket13 stroke:#3cb371
    class Bucket13,JSONParse152,Access153,PgSelect154,First158,PgSelectRows159,PgSelectSingle160,PgSelect163,First165,PgSelectRows166,PgSelectSingle167,PgClassExpression201,PgClassExpression202,PgClassExpression203,PgClassExpression204,PgClassExpression205,PgClassExpression206,PgClassExpression207,PgClassExpression208 bucket13
    classDef bucket14 stroke:#a52a2a
    class Bucket14,JSONParse179,Access180,PgSelect181,First185,PgSelectRows186,PgSelectSingle187,PgSelect190,First192,PgSelectRows193,PgSelectSingle194,PgClassExpression212,PgClassExpression213,PgClassExpression214,PgClassExpression215,PgClassExpression216,PgClassExpression217,PgClassExpression218,PgClassExpression219 bucket14
    classDef bucket15 stroke:#ff00ff
    class Bucket15,__Item210,PgUnionAllSingle211,Access223 bucket15
    classDef bucket16 stroke:#f5deb3
    class Bucket16,__Item221,PgUnionAllSingle222,Access225 bucket16
    classDef bucket17 stroke:#696969
    class Bucket17,PgCursor224,Access227 bucket17
    classDef bucket18 stroke:#00bfff
    class Bucket18,PgCursor226,Access244 bucket18
    classDef bucket19 stroke:#7f007f
    class Bucket19,JSONParse228,Access229,PgSelect230,First234,PgSelectRows235,PgSelectSingle236,PgSelect239,First241,PgSelectRows242,PgSelectSingle243,PgClassExpression261,PgClassExpression262,PgClassExpression263,PgClassExpression264,PgClassExpression265,PgClassExpression266 bucket19
    classDef bucket20 stroke:#ffa500
    class Bucket20,JSONParse245,Access246,PgSelect247,First251,PgSelectRows252,PgSelectSingle253,PgSelect256,First258,PgSelectRows259,PgSelectSingle260,PgClassExpression267,PgClassExpression268,PgClassExpression269,PgClassExpression270,PgClassExpression271,PgClassExpression272 bucket20

