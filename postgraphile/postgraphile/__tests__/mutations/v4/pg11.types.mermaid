%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef sideeffectplan fill:#f00,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% define steps
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    __InputStaticLeaf9["__InputStaticLeaf[9∈0]"]:::plan
    __InputStaticLeaf12["__InputStaticLeaf[12∈0]"]:::plan
    __InputStaticLeaf13["__InputStaticLeaf[13∈0]"]:::plan
    __InputStaticLeaf15["__InputStaticLeaf[15∈0]"]:::plan
    __InputStaticLeaf16["__InputStaticLeaf[16∈0]"]:::plan
    __InputStaticLeaf17["__InputStaticLeaf[17∈0]"]:::plan
    __InputStaticLeaf20["__InputStaticLeaf[20∈0]"]:::plan
    Access35["Access[35∈0]<br />ᐸ3.pgSettingsᐳ"]:::plan
    Access36["Access[36∈0]<br />ᐸ3.withPgClientᐳ"]:::plan
    Object37["Object[37∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"]:::plan
    List39["List[39∈0]<br />ᐸ15,16,17ᐳ"]:::plan
    Object40["Object[40∈0]<br />ᐸ{a}ᐳ"]:::plan
    PgUpdate34[["PgUpdate[34∈1]"]]:::sideeffectplan
    Object38["Object[38∈1]<br />ᐸ{result}ᐳ"]:::plan
    PgClassExpression41["PgClassExpression[41∈3]<br />ᐸ__types__.”id”ᐳ"]:::plan
    PgClassExpression42["PgClassExpression[42∈3]<br />ᐸ__types__.”regrole”ᐳ"]:::plan
    PgClassExpression43["PgClassExpression[43∈3]<br />ᐸ__types__....namespace”ᐳ"]:::plan
    PgClassExpression44["PgClassExpression[44∈3]<br />ᐸ__types__....ay_domain”ᐳ"]:::plan
    __Item45>"__Item[45∈4]<br />ᐸ44ᐳ"]:::itemplan
    PgClassExpression46["PgClassExpression[46∈3]<br />ᐸ__types__....ound_type”ᐳ"]:::plan
    PgSelect47[["PgSelect[47∈3]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]]:::plan
    First51["First[51∈3]"]:::plan
    PgSelectSingle52["PgSelectSingle[52∈3]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]:::plan
    PgClassExpression53["PgClassExpression[53∈5]<br />ᐸ__frmcdc_d...pe_1__.”a”ᐳ"]:::plan
    PgClassExpression54["PgClassExpression[54∈5]<br />ᐸ__frmcdc_d...pe_1__.”b”ᐳ"]:::plan
    PgClassExpression55["PgClassExpression[55∈5]<br />ᐸ__frmcdc_d...pe_1__.”c”ᐳ"]:::plan
    PgClassExpression56["PgClassExpression[56∈5]<br />ᐸ__frmcdc_d...pe_1__.”d”ᐳ"]:::plan
    PgClassExpression57["PgClassExpression[57∈5]<br />ᐸ__frmcdc_d...pe_1__.”e”ᐳ"]:::plan
    PgClassExpression58["PgClassExpression[58∈5]<br />ᐸ__frmcdc_d...pe_1__.”f”ᐳ"]:::plan
    PgClassExpression59["PgClassExpression[59∈5]<br />ᐸ__frmcdc_d....”foo_bar”ᐳ"]:::plan
    __InputStaticLeaf64["__InputStaticLeaf[64∈0]"]:::plan
    __InputStaticLeaf65["__InputStaticLeaf[65∈0]"]:::plan
    __InputStaticLeaf67["__InputStaticLeaf[67∈0]"]:::plan
    __InputStaticLeaf68["__InputStaticLeaf[68∈0]"]:::plan
    __InputStaticLeaf69["__InputStaticLeaf[69∈0]"]:::plan
    __InputStaticLeaf72["__InputStaticLeaf[72∈0]"]:::plan
    List91["List[91∈0]<br />ᐸ67,68,69ᐳ"]:::plan
    Object92["Object[92∈0]<br />ᐸ{a}ᐳ"]:::plan
    PgInsert86[["PgInsert[86∈6]"]]:::sideeffectplan
    Object90["Object[90∈6]<br />ᐸ{result}ᐳ"]:::plan
    PgClassExpression93["PgClassExpression[93∈8]<br />ᐸ__types__.”id”ᐳ"]:::plan
    PgClassExpression94["PgClassExpression[94∈8]<br />ᐸ__types__.”regrole”ᐳ"]:::plan
    PgClassExpression95["PgClassExpression[95∈8]<br />ᐸ__types__....namespace”ᐳ"]:::plan
    PgClassExpression96["PgClassExpression[96∈8]<br />ᐸ__types__....ay_domain”ᐳ"]:::plan
    __Item97>"__Item[97∈9]<br />ᐸ96ᐳ"]:::itemplan
    PgClassExpression98["PgClassExpression[98∈8]<br />ᐸ__types__....ound_type”ᐳ"]:::plan
    PgSelect99[["PgSelect[99∈8]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]]:::plan
    First103["First[103∈8]"]:::plan
    PgSelectSingle104["PgSelectSingle[104∈8]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]:::plan
    PgClassExpression105["PgClassExpression[105∈10]<br />ᐸ__frmcdc_d...pe_1__.”a”ᐳ"]:::plan
    PgClassExpression106["PgClassExpression[106∈10]<br />ᐸ__frmcdc_d...pe_1__.”b”ᐳ"]:::plan
    PgClassExpression107["PgClassExpression[107∈10]<br />ᐸ__frmcdc_d...pe_1__.”c”ᐳ"]:::plan
    PgClassExpression108["PgClassExpression[108∈10]<br />ᐸ__frmcdc_d...pe_1__.”d”ᐳ"]:::plan
    PgClassExpression109["PgClassExpression[109∈10]<br />ᐸ__frmcdc_d...pe_1__.”e”ᐳ"]:::plan
    PgClassExpression110["PgClassExpression[110∈10]<br />ᐸ__frmcdc_d...pe_1__.”f”ᐳ"]:::plan
    PgClassExpression111["PgClassExpression[111∈10]<br />ᐸ__frmcdc_d....”foo_bar”ᐳ"]:::plan

    %% plan dependencies
    __Value3 --> Access35
    __Value3 --> Access36
    Access35 & Access36 --> Object37
    __InputStaticLeaf15 & __InputStaticLeaf16 & __InputStaticLeaf17 --> List39
    __InputStaticLeaf20 --> Object40
    Object37 & __InputStaticLeaf9 & __InputStaticLeaf12 & __InputStaticLeaf13 & List39 & Object40 --> PgUpdate34
    PgUpdate34 --> Object38
    PgUpdate34 --> PgClassExpression41
    PgUpdate34 --> PgClassExpression42
    PgUpdate34 --> PgClassExpression43
    PgUpdate34 --> PgClassExpression44
    PgClassExpression44 ==> __Item45
    PgUpdate34 --> PgClassExpression46
    Object37 & PgClassExpression46 --> PgSelect47
    PgSelect47 --> First51
    First51 --> PgSelectSingle52
    PgSelectSingle52 --> PgClassExpression53
    PgSelectSingle52 --> PgClassExpression54
    PgSelectSingle52 --> PgClassExpression55
    PgSelectSingle52 --> PgClassExpression56
    PgSelectSingle52 --> PgClassExpression57
    PgSelectSingle52 --> PgClassExpression58
    PgSelectSingle52 --> PgClassExpression59
    __InputStaticLeaf67 & __InputStaticLeaf68 & __InputStaticLeaf69 --> List91
    __InputStaticLeaf72 --> Object92
    Object37 & __InputStaticLeaf64 & __InputStaticLeaf65 & List91 & Object92 --> PgInsert86
    PgInsert86 --> Object90
    PgInsert86 --> PgClassExpression93
    PgInsert86 --> PgClassExpression94
    PgInsert86 --> PgClassExpression95
    PgInsert86 --> PgClassExpression96
    PgClassExpression96 ==> __Item97
    PgInsert86 --> PgClassExpression98
    Object37 & PgClassExpression98 --> PgSelect99
    PgSelect99 --> First103
    First103 --> PgSelectSingle104
    PgSelectSingle104 --> PgClassExpression105
    PgSelectSingle104 --> PgClassExpression106
    PgSelectSingle104 --> PgClassExpression107
    PgSelectSingle104 --> PgClassExpression108
    PgSelectSingle104 --> PgClassExpression109
    PgSelectSingle104 --> PgClassExpression110
    PgSelectSingle104 --> PgClassExpression111

    subgraph "Buckets for mutations/v4/pg11.types"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value3,__Value5,__InputStaticLeaf9,__InputStaticLeaf12,__InputStaticLeaf13,__InputStaticLeaf15,__InputStaticLeaf16,__InputStaticLeaf17,__InputStaticLeaf20,Access35,Access36,Object37,List39,Object40,__InputStaticLeaf64,__InputStaticLeaf65,__InputStaticLeaf67,__InputStaticLeaf68,__InputStaticLeaf69,__InputStaticLeaf72,List91,Object92 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 37, 9, 12, 13, 39, 40<br /><br />1: PgUpdate{1}[34]<br />2: Object{1}ᐸ{result}ᐳ[38]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgUpdate34,Object38 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 38, 34, 37<br /><br />ROOT Object{1}ᐸ{result}ᐳ[38]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 34, 37<br /><br />ROOT PgUpdate{1}[34]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression41,PgClassExpression42,PgClassExpression43,PgClassExpression44,PgClassExpression46,PgSelect47,First51,PgSelectSingle52 bucket3
    Bucket4("Bucket 4 (listItem)<br />ROOT __Item{4}ᐸ44ᐳ[45]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item45 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 52<br /><br />ROOT PgSelectSingle{3}ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ[52]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression53,PgClassExpression54,PgClassExpression55,PgClassExpression56,PgClassExpression57,PgClassExpression58,PgClassExpression59 bucket5
    Bucket6("Bucket 6 (mutationField)<br />Deps: 37, 64, 65, 91, 92<br /><br />1: PgInsert{6}[86]<br />2: Object{6}ᐸ{result}ᐳ[90]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgInsert86,Object90 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 90, 86, 37<br /><br />ROOT Object{6}ᐸ{result}ᐳ[90]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 86, 37<br /><br />ROOT PgInsert{6}[86]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression93,PgClassExpression94,PgClassExpression95,PgClassExpression96,PgClassExpression98,PgSelect99,First103,PgSelectSingle104 bucket8
    Bucket9("Bucket 9 (listItem)<br />ROOT __Item{9}ᐸ96ᐳ[97]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item97 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 104<br /><br />ROOT PgSelectSingle{8}ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ[104]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression105,PgClassExpression106,PgClassExpression107,PgClassExpression108,PgClassExpression109,PgClassExpression110,PgClassExpression111 bucket10
    Bucket0 --> Bucket1 & Bucket6
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4 & Bucket5
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket8 --> Bucket9 & Bucket10
    end
