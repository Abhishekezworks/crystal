%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object42{{"Object[42∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access40{{"Access[40∈0]<br />ᐸ3.pgSettingsᐳ"}}:::plan
    Access41{{"Access[41∈0]<br />ᐸ3.withPgClientᐳ"}}:::plan
    Access40 & Access41 --> Object42
    Lambda10{{"Lambda[10∈0]<br />ᐸdecodeNodeIdWithCodecsᐳ"}}:::plan
    Constant131{{"Constant[131∈0]<br />ᐸ'WyJyZWxhdGlvbmFsX3RvcGljcyIsMV0='ᐳ"}}:::plan
    Constant131 --> Lambda10
    Access130{{"Access[130∈0]<br />ᐸ10.base64JSON.1ᐳ"}}:::plan
    Lambda10 --> Access130
    List14{{"List[14∈0]<br />ᐸ130ᐳ"}}:::plan
    Access130 --> List14
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value3 --> Access40
    __Value3 --> Access41
    __Value0["__Value[0∈0]"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    List36{{"List[36∈1]<br />ᐸ15,20,25,30,35ᐳ"}}:::plan
    Object15{{"Object[15∈1]<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object20{{"Object[20∈1]<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object25{{"Object[25∈1]<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object30{{"Object[30∈1]<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object35{{"Object[35∈1]<br />ᐸ{match,pks}ᐳ"}}:::plan
    Object15 & Object20 & Object25 & Object30 & Object35 --> List36
    Lambda13[["Lambda[13∈1]"]]:::unbatchedplan
    Lambda13 & List14 --> Object15
    Lambda18[["Lambda[18∈1]"]]:::unbatchedplan
    Lambda18 & List14 --> Object20
    Lambda23[["Lambda[23∈1]"]]:::unbatchedplan
    Lambda23 & List14 --> Object25
    Lambda28[["Lambda[28∈1]"]]:::unbatchedplan
    Lambda28 & List14 --> Object30
    Lambda33[["Lambda[33∈1]"]]:::unbatchedplan
    Lambda33 & List14 --> Object35
    PgSelect39[["PgSelect[39∈1]<br />ᐸrelational_itemsᐳ"]]:::plan
    Access38{{"Access[38∈1]<br />ᐸ37.0ᐳ"}}:::plan
    Object42 & Access38 --> PgSelect39
    PgSelect46[["PgSelect[46∈1]<br />ᐸcustom_delete_relational_item(mutation)ᐳ"]]:::sideeffectplan
    PgClassExpression45{{"PgClassExpression[45∈1]<br />ᐸ__relational_items__ᐳ"}}:::plan
    Object42 & PgClassExpression45 --> PgSelect46
    Lambda10 --> Lambda13
    Lambda10 --> Lambda18
    Lambda10 --> Lambda23
    Lambda10 --> Lambda28
    Lambda10 --> Lambda33
    Lambda37{{"Lambda[37∈1]"}}:::plan
    List36 --> Lambda37
    Lambda37 --> Access38
    First43{{"First[43∈1]"}}:::plan
    PgSelect39 --> First43
    PgSelectSingle44{{"PgSelectSingle[44∈1]<br />ᐸrelational_itemsᐳ"}}:::plan
    First43 --> PgSelectSingle44
    PgSelectSingle44 --> PgClassExpression45
    First50{{"First[50∈1]"}}:::plan
    PgSelect46 --> First50
    PgSelectSingle51{{"PgSelectSingle[51∈1]<br />ᐸcustom_delete_relational_itemᐳ"}}:::plan
    First50 --> PgSelectSingle51
    PgClassExpression52{{"PgClassExpression[52∈1]<br />ᐸ__custom_d...l_item__.vᐳ"}}:::plan
    PgSelectSingle51 --> PgClassExpression52
    Object53{{"Object[53∈1]<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression52 --> Object53
    Connection66{{"Connection[66∈2]<br />ᐸ62ᐳ"}}:::plan
    Constant132{{"Constant[132∈2]<br />ᐸ1ᐳ"}}:::plan
    Constant132 --> Connection66
    PgSelect67[["PgSelect[67∈4]<br />ᐸrelational_itemsᐳ"]]:::plan
    Object42 & Connection66 --> PgSelect67
    __Item68[/"__Item[68∈5]<br />ᐸ67ᐳ"\]:::itemplan
    PgSelect67 ==> __Item68
    PgSelectSingle69{{"PgSelectSingle[69∈5]<br />ᐸrelational_itemsᐳ"}}:::plan
    __Item68 --> PgSelectSingle69
    PgClassExpression70{{"PgClassExpression[70∈5]<br />ᐸ__relation...ems__.”id”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression70
    PgClassExpression81{{"PgClassExpression[81∈5]<br />ᐸ__relation...s__.”type”ᐳ"}}:::plan
    PgSelectSingle69 --> PgClassExpression81
    PgSelect71[["PgSelect[71∈6]<br />ᐸrelational_topicsᐳ<br />ᐳRelationalTopic"]]:::plan
    Object42 & PgClassExpression70 --> PgSelect71
    List79{{"List[79∈6]<br />ᐸ77,78ᐳ<br />ᐳRelationalTopic"}}:::plan
    Constant77{{"Constant[77∈6]<br />ᐸ'relational_topics'ᐳ<br />ᐳRelationalTopic"}}:::plan
    PgClassExpression78{{"PgClassExpression[78∈6]<br />ᐸ__relation...c_item_id”ᐳ"}}:::plan
    Constant77 & PgClassExpression78 --> List79
    PgSelect83[["PgSelect[83∈6]<br />ᐸrelational_postsᐳ<br />ᐳRelationalPost"]]:::plan
    Object42 & PgClassExpression70 --> PgSelect83
    List91{{"List[91∈6]<br />ᐸ89,90ᐳ<br />ᐳRelationalPost"}}:::plan
    Constant89{{"Constant[89∈6]<br />ᐸ'relational_posts'ᐳ<br />ᐳRelationalPost"}}:::plan
    PgClassExpression90{{"PgClassExpression[90∈6]<br />ᐸ__relation...t_item_id”ᐳ"}}:::plan
    Constant89 & PgClassExpression90 --> List91
    PgSelect95[["PgSelect[95∈6]<br />ᐸrelational_dividersᐳ<br />ᐳRelationalDivider"]]:::plan
    Object42 & PgClassExpression70 --> PgSelect95
    List103{{"List[103∈6]<br />ᐸ101,102ᐳ<br />ᐳRelationalDivider"}}:::plan
    Constant101{{"Constant[101∈6]<br />ᐸ'relational_dividers'ᐳ<br />ᐳRelationalDivider"}}:::plan
    PgClassExpression102{{"PgClassExpression[102∈6]<br />ᐸ__relation...r_item_id”ᐳ"}}:::plan
    Constant101 & PgClassExpression102 --> List103
    PgSelect107[["PgSelect[107∈6]<br />ᐸrelational_checklistsᐳ<br />ᐳRelationalChecklist"]]:::plan
    Object42 & PgClassExpression70 --> PgSelect107
    List115{{"List[115∈6]<br />ᐸ113,114ᐳ<br />ᐳRelationalChecklist"}}:::plan
    Constant113{{"Constant[113∈6]<br />ᐸ'relational_checklists'ᐳ<br />ᐳRelationalChecklist"}}:::plan
    PgClassExpression114{{"PgClassExpression[114∈6]<br />ᐸ__relation...t_item_id”ᐳ"}}:::plan
    Constant113 & PgClassExpression114 --> List115
    PgSelect119[["PgSelect[119∈6]<br />ᐸrelational_checklist_itemsᐳ<br />ᐳRelationalChecklistItem"]]:::plan
    Object42 & PgClassExpression70 --> PgSelect119
    List127{{"List[127∈6]<br />ᐸ125,126ᐳ<br />ᐳRelationalChecklistItem"}}:::plan
    Constant125{{"Constant[125∈6]<br />ᐸ'relational_checklist_items'ᐳ<br />ᐳRelationalChecklistItem"}}:::plan
    PgClassExpression126{{"PgClassExpression[126∈6]<br />ᐸ__relation...m_item_id”ᐳ"}}:::plan
    Constant125 & PgClassExpression126 --> List127
    First75{{"First[75∈6]"}}:::plan
    PgSelect71 --> First75
    PgSelectSingle76{{"PgSelectSingle[76∈6]<br />ᐸrelational_topicsᐳ"}}:::plan
    First75 --> PgSelectSingle76
    PgSelectSingle76 --> PgClassExpression78
    Lambda80{{"Lambda[80∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List79 --> Lambda80
    First87{{"First[87∈6]"}}:::plan
    PgSelect83 --> First87
    PgSelectSingle88{{"PgSelectSingle[88∈6]<br />ᐸrelational_postsᐳ"}}:::plan
    First87 --> PgSelectSingle88
    PgSelectSingle88 --> PgClassExpression90
    Lambda92{{"Lambda[92∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List91 --> Lambda92
    First99{{"First[99∈6]"}}:::plan
    PgSelect95 --> First99
    PgSelectSingle100{{"PgSelectSingle[100∈6]<br />ᐸrelational_dividersᐳ"}}:::plan
    First99 --> PgSelectSingle100
    PgSelectSingle100 --> PgClassExpression102
    Lambda104{{"Lambda[104∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List103 --> Lambda104
    First111{{"First[111∈6]"}}:::plan
    PgSelect107 --> First111
    PgSelectSingle112{{"PgSelectSingle[112∈6]<br />ᐸrelational_checklistsᐳ"}}:::plan
    First111 --> PgSelectSingle112
    PgSelectSingle112 --> PgClassExpression114
    Lambda116{{"Lambda[116∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List115 --> Lambda116
    First123{{"First[123∈6]"}}:::plan
    PgSelect119 --> First123
    PgSelectSingle124{{"PgSelectSingle[124∈6]<br />ᐸrelational_checklist_itemsᐳ"}}:::plan
    First123 --> PgSelectSingle124
    PgSelectSingle124 --> PgClassExpression126
    Lambda128{{"Lambda[128∈6]<br />ᐸbase64JSONEncodeᐳ"}}:::plan
    List127 --> Lambda128

    %% define steps

    subgraph "Buckets for mutations/v4/polymorphic.relay.custom_delete"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value3,__Value5,Lambda10,List14,Access40,Access41,Object42,Access130,Constant131 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 10, 14, 42, 5<br /><br />1: Lambda[13]<br />2: Object[15]<br />3: Lambda[18]<br />4: Object[20]<br />5: Lambda[23]<br />6: Object[25]<br />7: Lambda[28]<br />8: Object[30]<br />9: Lambda[33]<br />10: Object[35]<br />11: List[36]<br />12: Lambda[37]<br />13: Access[38]<br />14: PgSelect[39]<br />15: First[43]<br />16: PgSelectSingle[44]<br />17: PgClassExpression[45]<br />18: PgSelect[46]<br />19: <br />ᐳ: 50, 51, 52, 53"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,Lambda13,Object15,Lambda18,Object20,Lambda23,Object25,Lambda28,Object30,Lambda33,Object35,List36,Lambda37,Access38,PgSelect39,First43,PgSelectSingle44,PgClassExpression45,PgSelect46,First50,PgSelectSingle51,PgClassExpression52,Object53 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 53, 5, 42, 52<br /><br />ROOT Object{1}ᐸ{result}ᐳ[53]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,Connection66,Constant132 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 5, 42, 66<br /><br />ROOT __ValueᐸrootValueᐳ[5]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 42, 66<br /><br />ROOT Connection{2}ᐸ62ᐳ[66]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect67 bucket4
    Bucket5("Bucket 5 (listItem)<br />Deps: 42<br /><br />ROOT __Item{5}ᐸ67ᐳ[68]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,__Item68,PgSelectSingle69,PgClassExpression70,PgClassExpression81 bucket5
    Bucket6("Bucket 6 (polymorphic)<br />RelationalTopic,RelationalPost,RelationalDivider,RelationalChecklist,RelationalChecklistItem<br />Deps: 42, 70, 69, 81<br />ᐳRelationalTopic<br />ᐳRelationalPost<br />ᐳRelationalDivider<br />ᐳRelationalChecklist<br />ᐳRelationalChecklistItem"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgSelect71,First75,PgSelectSingle76,Constant77,PgClassExpression78,List79,Lambda80,PgSelect83,First87,PgSelectSingle88,Constant89,PgClassExpression90,List91,Lambda92,PgSelect95,First99,PgSelectSingle100,Constant101,PgClassExpression102,List103,Lambda104,PgSelect107,First111,PgSelectSingle112,Constant113,PgClassExpression114,List115,Lambda116,PgSelect119,First123,PgSelectSingle124,Constant125,PgClassExpression126,List127,Lambda128 bucket6
    Bucket0 --> Bucket1
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket4 --> Bucket5
    Bucket5 --> Bucket6
    end
