%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for mutations/v4/enum_tables.mutations"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (mutationField)<br />Deps: 13, 63, 14<br /><br />1: PgDeleteSingle[9]<br />2: <br />ᐳ: Object[15]"):::bucket
    Bucket2("Bucket 2 (mutationField)<br />Deps: 27, 2<br /><br />1: Access[23]<br />2: Access[25]<br />3: Object[26]<br />4: PgInsertSingle[22]<br />5: <br />ᐳ: Object[28]"):::bucket
    Bucket3("Bucket 3 (mutationField)<br />Deps: 51, 2, 36<br /><br />1: Access[38]<br />2: Access[40]<br />3: Object[41]<br />4: PgFromExpression[43]<br />5: PgSelect[37]<br />6: PgSelectRows[46]<br />ᐳ: 45, 48, 49, 50"):::bucket
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 15, 9<br /><br />ROOT Object{1}ᐸ{result}ᐳ[15]"):::bucket
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 28, 22<br /><br />ROOT Object{2}ᐸ{result}ᐳ[28]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 50, 49<br /><br />ROOT Object{3}ᐸ{result}ᐳ[50]"):::bucket
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 9<br /><br />ROOT PgDeleteSingle{1}ᐸletter_descriptions(letter)ᐳ[9]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 22<br /><br />ROOT PgInsertSingle{2}ᐸletter_descriptions()ᐳ[22]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3
    Bucket1 --> Bucket4
    Bucket2 --> Bucket5
    Bucket3 --> Bucket6
    Bucket4 --> Bucket7
    Bucket5 --> Bucket8

    %% plan dependencies
    __InputObject31{{"__InputObject[31∈0] ➊"}}:::plan
    Constant65{{"Constant[65∈0] ➊<br />ᐸ'a1'ᐳ"}}:::plan
    Constant66{{"Constant[66∈0] ➊<br />ᐸ'b2'ᐳ"}}:::plan
    Constant67{{"Constant[67∈0] ➊<br />ᐸ'c4'ᐳ"}}:::plan
    Constant68{{"Constant[68∈0] ➊<br />ᐸ'Qux'ᐳ"}}:::plan
    Constant65 & Constant66 & Constant67 & Constant68 --> __InputObject31
    __InputObject18{{"__InputObject[18∈0] ➊"}}:::plan
    Constant63{{"Constant[63∈0] ➊<br />ᐸ'C'ᐳ"}}:::plan
    Constant64{{"Constant[64∈0] ➊<br />ᐸ'One does like to see the letter C'ᐳ"}}:::plan
    Constant64 --> __InputObject18
    Constant63 -- 2 --> __InputObject18
    __InputObject6{{"__InputObject[6∈0] ➊"}}:::plan
    Constant63 --> __InputObject6
    Object13{{"Object[13∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access10{{"Access[10∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access12{{"Access[12∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access10 & Access12 --> Object13
    __InputObject16{{"__InputObject[16∈0] ➊"}}:::plan
    __InputObject18 --> __InputObject16
    __InputObject29{{"__InputObject[29∈0] ➊"}}:::plan
    __InputObject31 --> __InputObject29
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access10
    __Value2 --> Access12
    ApplyInput14{{"ApplyInput[14∈0] ➊"}}:::plan
    __InputObject6 --> ApplyInput14
    ApplyInput27{{"ApplyInput[27∈0] ➊"}}:::plan
    __InputObject16 --> ApplyInput27
    BakedInput36{{"BakedInput[36∈0] ➊"}}:::plan
    __InputObject31 --> BakedInput36
    ApplyInput51{{"ApplyInput[51∈0] ➊"}}:::plan
    __InputObject29 --> ApplyInput51
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    PgDeleteSingle9[["PgDeleteSingle[9∈1] ➊<br />ᐸletter_descriptions(letter)ᐳ"]]:::sideeffectplan
    Object13 & Constant63 & ApplyInput14 --> PgDeleteSingle9
    Object15{{"Object[15∈1] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgDeleteSingle9 --> Object15
    PgClassExpression52{{"PgClassExpression[52∈7] ➊<br />ᐸ__letter_d...ons__.”id”ᐳ"}}:::plan
    Access53{{"Access[53∈7] ➊<br />ᐸ9.tᐳ"}}:::plan
    Access53 --> PgClassExpression52
    PgDeleteSingle9 --> Access53
    PgClassExpression55{{"PgClassExpression[55∈7] ➊<br />ᐸ__letter_d..._.”letter”ᐳ"}}:::plan
    Access53 --> PgClassExpression55
    PgClassExpression56{{"PgClassExpression[56∈7] ➊<br />ᐸ__letter_d..._via_view”ᐳ"}}:::plan
    Access53 --> PgClassExpression56
    PgInsertSingle22[["PgInsertSingle[22∈2] ➊<br />ᐸletter_descriptions()ᐳ"]]:::sideeffectplan
    Object26{{"Object[26∈2] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object26 & ApplyInput27 --> PgInsertSingle22
    Access23{{"Access[23∈2] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access25{{"Access[25∈2] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access23 & Access25 --> Object26
    __Value2 --> Access23
    __Value2 --> Access25
    Object28{{"Object[28∈2] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle22 --> Object28
    PgClassExpression57{{"PgClassExpression[57∈8] ➊<br />ᐸ__letter_d...ons__.”id”ᐳ"}}:::plan
    Access58{{"Access[58∈8] ➊<br />ᐸ22.tᐳ"}}:::plan
    Access58 --> PgClassExpression57
    PgInsertSingle22 --> Access58
    PgClassExpression60{{"PgClassExpression[60∈8] ➊<br />ᐸ__letter_d..._.”letter”ᐳ"}}:::plan
    Access58 --> PgClassExpression60
    PgClassExpression61{{"PgClassExpression[61∈8] ➊<br />ᐸ__letter_d..._via_view”ᐳ"}}:::plan
    Access58 --> PgClassExpression61
    PgClassExpression62{{"PgClassExpression[62∈8] ➊<br />ᐸ__letter_d...scription”ᐳ"}}:::plan
    Access58 --> PgClassExpression62
    PgSelect37[["PgSelect[37∈3] ➊<br />ᐸreferencing_table_mutation(mutation)ᐳ"]]:::sideeffectplan
    Object41{{"Object[41∈3] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    PgFromExpression43{{"PgFromExpression[43∈3] ➊"}}:::plan
    Object41 & PgFromExpression43 & ApplyInput51 --> PgSelect37
    Access38{{"Access[38∈3] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access40{{"Access[40∈3] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access38 & Access40 --> Object41
    __Value2 --> Access38
    __Value2 --> Access40
    BakedInput36 --> PgFromExpression43
    First45{{"First[45∈3] ➊"}}:::plan
    PgSelectRows46[["PgSelectRows[46∈3] ➊"]]:::plan
    PgSelectRows46 --> First45
    PgSelect37 --> PgSelectRows46
    PgSelectSingle48{{"PgSelectSingle[48∈3] ➊<br />ᐸreferencing_table_mutationᐳ"}}:::plan
    First45 --> PgSelectSingle48
    PgClassExpression49{{"PgClassExpression[49∈3] ➊<br />ᐸ__referenc...tation__.vᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression49
    Object50{{"Object[50∈3] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression49 --> Object50

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,__InputObject6,Access10,Access12,Object13,ApplyInput14,__InputObject16,__InputObject18,ApplyInput27,__InputObject29,__InputObject31,BakedInput36,ApplyInput51,Constant63,Constant64,Constant65,Constant66,Constant67,Constant68 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgDeleteSingle9,Object15 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgInsertSingle22,Access23,Access25,Object26,Object28 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect37,Access38,Access40,Object41,PgFromExpression43,First45,PgSelectRows46,PgSelectSingle48,PgClassExpression49,Object50 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression52,Access53,PgClassExpression55,PgClassExpression56 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression57,Access58,PgClassExpression60,PgClassExpression61,PgClassExpression62 bucket8

