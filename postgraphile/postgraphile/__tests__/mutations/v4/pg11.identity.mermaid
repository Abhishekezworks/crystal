%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for mutations/v4/pg11.identity"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (mutationField)<br />Deps: 14, 15<br /><br />1: PgInsertSingle[10]<br />2: <br />ᐳ: Object[16]"):::bucket
    Bucket2("Bucket 2 (mutationField)<br />Deps: 26, 2<br /><br />1: Access[22]<br />2: Access[24]<br />3: Object[25]<br />4: PgInsertSingle[21]<br />5: <br />ᐳ: Object[27]"):::bucket
    Bucket3("Bucket 3 (mutationField)<br />Deps: 38, 2<br /><br />1: Access[34]<br />2: Access[36]<br />3: Object[37]<br />4: PgInsertSingle[33]<br />5: <br />ᐳ: Object[39]"):::bucket
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 16, 10<br /><br />ROOT Object{1}ᐸ{result}ᐳ[16]"):::bucket
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 27, 21<br /><br />ROOT Object{2}ᐸ{result}ᐳ[27]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 39, 33<br /><br />ROOT Object{3}ᐸ{result}ᐳ[39]"):::bucket
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 10<br /><br />ROOT PgInsertSingle{1}ᐸalways_as_identity()ᐳ[10]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 21<br /><br />ROOT PgInsertSingle{2}ᐸby_default_as_identity()ᐳ[21]"):::bucket
    Bucket9("Bucket 9 (nullableBoundary)<br />Deps: 33<br /><br />ROOT PgInsertSingle{3}ᐸby_default_as_identity()ᐳ[33]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3
    Bucket1 --> Bucket4
    Bucket2 --> Bucket5
    Bucket3 --> Bucket6
    Bucket4 --> Bucket7
    Bucket5 --> Bucket8
    Bucket6 --> Bucket9

    %% plan dependencies
    __InputObject6{{"__InputObject[6∈0] ➊"}}:::plan
    __InputObject8{{"__InputObject[8∈0] ➊"}}:::plan
    __InputObject8 --> __InputObject6
    Object14{{"Object[14∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access11{{"Access[11∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access11 & Access13 --> Object14
    __InputObject17{{"__InputObject[17∈0] ➊"}}:::plan
    __InputObject19{{"__InputObject[19∈0] ➊"}}:::plan
    __InputObject19 --> __InputObject17
    Constant52{{"Constant[52∈0] ➊<br />ᐸ'test'ᐳ"}}:::plan
    Constant52 --> __InputObject19
    __InputObject28{{"__InputObject[28∈0] ➊"}}:::plan
    __InputObject30{{"__InputObject[30∈0] ➊"}}:::plan
    __InputObject30 --> __InputObject28
    Constant53{{"Constant[53∈0] ➊<br />ᐸ100ᐳ"}}:::plan
    Constant53 & Constant52 --> __InputObject30
    Constant52 --> __InputObject8
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access11
    __Value2 --> Access13
    ApplyInput15{{"ApplyInput[15∈0] ➊"}}:::plan
    __InputObject6 --> ApplyInput15
    ApplyInput26{{"ApplyInput[26∈0] ➊"}}:::plan
    __InputObject17 --> ApplyInput26
    ApplyInput38{{"ApplyInput[38∈0] ➊"}}:::plan
    __InputObject28 --> ApplyInput38
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    PgInsertSingle10[["PgInsertSingle[10∈1] ➊<br />ᐸalways_as_identity()ᐳ"]]:::sideeffectplan
    Object14 & ApplyInput15 --> PgInsertSingle10
    Object16{{"Object[16∈1] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle10 --> Object16
    PgClassExpression40{{"PgClassExpression[40∈7] ➊<br />ᐸ__always_a...ity__.”id”ᐳ"}}:::plan
    Access41{{"Access[41∈7] ➊<br />ᐸ10.tᐳ"}}:::plan
    Access41 --> PgClassExpression40
    PgInsertSingle10 --> Access41
    PgClassExpression43{{"PgClassExpression[43∈7] ➊<br />ᐸ__always_a...tity__.”t”ᐳ"}}:::plan
    Access41 --> PgClassExpression43
    PgInsertSingle21[["PgInsertSingle[21∈2] ➊<br />ᐸby_default_as_identity()ᐳ"]]:::sideeffectplan
    Object25{{"Object[25∈2] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object25 & ApplyInput26 --> PgInsertSingle21
    Access22{{"Access[22∈2] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access24{{"Access[24∈2] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access22 & Access24 --> Object25
    __Value2 --> Access22
    __Value2 --> Access24
    Object27{{"Object[27∈2] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle21 --> Object27
    PgClassExpression44{{"PgClassExpression[44∈8] ➊<br />ᐸ__by_defau...ity__.”id”ᐳ"}}:::plan
    Access45{{"Access[45∈8] ➊<br />ᐸ21.tᐳ"}}:::plan
    Access45 --> PgClassExpression44
    PgInsertSingle21 --> Access45
    PgClassExpression47{{"PgClassExpression[47∈8] ➊<br />ᐸ__by_defau...tity__.”t”ᐳ"}}:::plan
    Access45 --> PgClassExpression47
    PgInsertSingle33[["PgInsertSingle[33∈3] ➊<br />ᐸby_default_as_identity()ᐳ"]]:::sideeffectplan
    Object37{{"Object[37∈3] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object37 & ApplyInput38 --> PgInsertSingle33
    Access34{{"Access[34∈3] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access36{{"Access[36∈3] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access34 & Access36 --> Object37
    __Value2 --> Access34
    __Value2 --> Access36
    Object39{{"Object[39∈3] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle33 --> Object39
    PgClassExpression48{{"PgClassExpression[48∈9] ➊<br />ᐸ__by_defau...ity__.”id”ᐳ"}}:::plan
    Access49{{"Access[49∈9] ➊<br />ᐸ33.tᐳ"}}:::plan
    Access49 --> PgClassExpression48
    PgInsertSingle33 --> Access49
    PgClassExpression51{{"PgClassExpression[51∈9] ➊<br />ᐸ__by_defau...tity__.”t”ᐳ"}}:::plan
    Access49 --> PgClassExpression51

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,__InputObject6,__InputObject8,Access11,Access13,Object14,ApplyInput15,__InputObject17,__InputObject19,ApplyInput26,__InputObject28,__InputObject30,ApplyInput38,Constant52,Constant53 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgInsertSingle10,Object16 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgInsertSingle21,Access22,Access24,Object25,Object27 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgInsertSingle33,Access34,Access36,Object37,Object39 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression40,Access41,PgClassExpression43 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression44,Access45,PgClassExpression47 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgClassExpression48,Access49,PgClassExpression51 bucket9

