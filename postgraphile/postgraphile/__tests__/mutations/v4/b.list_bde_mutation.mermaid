%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left

    subgraph "Buckets for mutations/v4/b.list_bde_mutation"
    Bucket0("Bucket 0 (root)"):::bucket
    Bucket1("Bucket 1 (mutationField)<br />Deps: 16, 18, 28<br /><br />1: PgSelect[12]<br />2: PgSelectRows[23]<br />ᐳ: 22, 25, 26, 27"):::bucket
    Bucket2("Bucket 2 (mutationField)<br />Deps: 51, 2, 34, 104, 105<br /><br />1: Access[36]<br />2: Access[38]<br />3: Object[39]<br />4: PgFromExpression[41]<br />5: PgSelect[35]<br />6: PgSelectRows[46]<br />ᐳ: 45, 48, 49, 50"):::bucket
    Bucket3("Bucket 3 (mutationField)<br />Deps: 74, 2, 57, 106, 107<br /><br />1: Access[59]<br />2: Access[61]<br />3: Object[62]<br />4: PgFromExpression[64]<br />5: PgSelect[58]<br />6: PgSelectRows[69]<br />ᐳ: 68, 71, 72, 73"):::bucket
    Bucket4("Bucket 4 (mutationField)<br />Deps: 97, 2, 80, 104, 108<br /><br />1: Access[82]<br />2: Access[84]<br />3: Object[85]<br />4: PgFromExpression[87]<br />5: PgSelect[81]<br />6: PgSelectRows[92]<br />ᐳ: 91, 94, 95, 96"):::bucket
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 27, 26<br /><br />ROOT Object{1}ᐸ{result}ᐳ[27]"):::bucket
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 50, 49<br /><br />ROOT Object{2}ᐸ{result}ᐳ[50]"):::bucket
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 73, 72<br /><br />ROOT Object{3}ᐸ{result}ᐳ[73]"):::bucket
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 96, 95<br /><br />ROOT Object{4}ᐸ{result}ᐳ[96]"):::bucket
    Bucket9("Bucket 9 (listItem)<br /><br />ROOT __Item{9}ᐸ26ᐳ[98]"):::bucket
    Bucket10("Bucket 10 (listItem)<br /><br />ROOT __Item{10}ᐸ49ᐳ[99]"):::bucket
    Bucket11("Bucket 11 (listItem)<br /><br />ROOT __Item{11}ᐸ72ᐳ[100]"):::bucket
    Bucket12("Bucket 12 (listItem)<br /><br />ROOT __Item{12}ᐸ95ᐳ[101]"):::bucket
    end
    Bucket0 --> Bucket1 & Bucket2 & Bucket3 & Bucket4
    Bucket1 --> Bucket5
    Bucket2 --> Bucket6
    Bucket3 --> Bucket7
    Bucket4 --> Bucket8
    Bucket5 --> Bucket9
    Bucket6 --> Bucket10
    Bucket7 --> Bucket11
    Bucket8 --> Bucket12

    %% plan dependencies
    __InputObject6{{"__InputObject[6∈0] ➊"}}:::plan
    Constant8{{"Constant[8∈0] ➊<br />ᐸ[]ᐳ"}}:::plan
    Constant102{{"Constant[102∈0] ➊<br />ᐸ'bar'ᐳ"}}:::plan
    Constant103{{"Constant[103∈0] ➊<br />ᐸ'q0'ᐳ"}}:::plan
    Constant8 & Constant102 & Constant103 --> __InputObject6
    __InputObject29{{"__InputObject[29∈0] ➊"}}:::plan
    Constant31{{"Constant[31∈0] ➊<br />ᐸ[ 'option-1' ]ᐳ"}}:::plan
    Constant104{{"Constant[104∈0] ➊<br />ᐸ''ᐳ"}}:::plan
    Constant105{{"Constant[105∈0] ➊<br />ᐸ'q1'ᐳ"}}:::plan
    Constant31 & Constant104 & Constant105 --> __InputObject29
    __InputObject52{{"__InputObject[52∈0] ➊"}}:::plan
    Constant54{{"Constant[54∈0] ➊<br />ᐸ[]ᐳ"}}:::plan
    Constant106{{"Constant[106∈0] ➊<br />ᐸ'foo'ᐳ"}}:::plan
    Constant107{{"Constant[107∈0] ➊<br />ᐸ'q2'ᐳ"}}:::plan
    Constant54 & Constant106 & Constant107 --> __InputObject52
    __InputObject75{{"__InputObject[75∈0] ➊"}}:::plan
    Constant77{{"Constant[77∈0] ➊<br />ᐸ[ 'option-2' ]ᐳ"}}:::plan
    Constant108{{"Constant[108∈0] ➊<br />ᐸ'q3'ᐳ"}}:::plan
    Constant77 & Constant104 & Constant108 --> __InputObject75
    PgFromExpression18{{"PgFromExpression[18∈0] ➊"}}:::plan
    BakedInput11{{"BakedInput[11∈0] ➊"}}:::plan
    BakedInput11 & Constant102 & Constant103 --> PgFromExpression18
    Object16{{"Object[16∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access15{{"Access[15∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access13 & Access15 --> Object16
    Constant8 --> BakedInput11
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access13
    __Value2 --> Access15
    ApplyInput28{{"ApplyInput[28∈0] ➊"}}:::plan
    __InputObject6 --> ApplyInput28
    BakedInput34{{"BakedInput[34∈0] ➊"}}:::plan
    Constant31 --> BakedInput34
    ApplyInput51{{"ApplyInput[51∈0] ➊"}}:::plan
    __InputObject29 --> ApplyInput51
    BakedInput57{{"BakedInput[57∈0] ➊"}}:::plan
    Constant54 --> BakedInput57
    ApplyInput74{{"ApplyInput[74∈0] ➊"}}:::plan
    __InputObject52 --> ApplyInput74
    BakedInput80{{"BakedInput[80∈0] ➊"}}:::plan
    Constant77 --> BakedInput80
    ApplyInput97{{"ApplyInput[97∈0] ➊"}}:::plan
    __InputObject75 --> ApplyInput97
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    PgSelect12[["PgSelect[12∈1] ➊<br />ᐸlist_bde_mutation(mutation)ᐳ"]]:::sideeffectplan
    Object16 & PgFromExpression18 & ApplyInput28 --> PgSelect12
    First22{{"First[22∈1] ➊"}}:::plan
    PgSelectRows23[["PgSelectRows[23∈1] ➊"]]:::plan
    PgSelectRows23 --> First22
    PgSelect12 --> PgSelectRows23
    PgSelectSingle25{{"PgSelectSingle[25∈1] ➊<br />ᐸlist_bde_mutationᐳ"}}:::plan
    First22 --> PgSelectSingle25
    PgClassExpression26{{"PgClassExpression[26∈1] ➊<br />ᐸ__list_bde_mutation__.vᐳ"}}:::plan
    PgSelectSingle25 --> PgClassExpression26
    Object27{{"Object[27∈1] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression26 --> Object27
    __Item98[/"__Item[98∈9]<br />ᐸ26ᐳ"\]:::itemplan
    PgClassExpression26 ==> __Item98
    PgSelect35[["PgSelect[35∈2] ➊<br />ᐸlist_bde_mutation(mutation)ᐳ"]]:::sideeffectplan
    Object39{{"Object[39∈2] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    PgFromExpression41{{"PgFromExpression[41∈2] ➊"}}:::plan
    Object39 & PgFromExpression41 & ApplyInput51 --> PgSelect35
    BakedInput34 & Constant104 & Constant105 --> PgFromExpression41
    Access36{{"Access[36∈2] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access38{{"Access[38∈2] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access36 & Access38 --> Object39
    __Value2 --> Access36
    __Value2 --> Access38
    First45{{"First[45∈2] ➊"}}:::plan
    PgSelectRows46[["PgSelectRows[46∈2] ➊"]]:::plan
    PgSelectRows46 --> First45
    PgSelect35 --> PgSelectRows46
    PgSelectSingle48{{"PgSelectSingle[48∈2] ➊<br />ᐸlist_bde_mutationᐳ"}}:::plan
    First45 --> PgSelectSingle48
    PgClassExpression49{{"PgClassExpression[49∈2] ➊<br />ᐸ__list_bde_mutation__.vᐳ"}}:::plan
    PgSelectSingle48 --> PgClassExpression49
    Object50{{"Object[50∈2] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression49 --> Object50
    __Item99[/"__Item[99∈10]<br />ᐸ49ᐳ"\]:::itemplan
    PgClassExpression49 ==> __Item99
    PgSelect58[["PgSelect[58∈3] ➊<br />ᐸlist_bde_mutation(mutation)ᐳ"]]:::sideeffectplan
    Object62{{"Object[62∈3] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    PgFromExpression64{{"PgFromExpression[64∈3] ➊"}}:::plan
    Object62 & PgFromExpression64 & ApplyInput74 --> PgSelect58
    BakedInput57 & Constant106 & Constant107 --> PgFromExpression64
    Access59{{"Access[59∈3] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access61{{"Access[61∈3] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access59 & Access61 --> Object62
    __Value2 --> Access59
    __Value2 --> Access61
    First68{{"First[68∈3] ➊"}}:::plan
    PgSelectRows69[["PgSelectRows[69∈3] ➊"]]:::plan
    PgSelectRows69 --> First68
    PgSelect58 --> PgSelectRows69
    PgSelectSingle71{{"PgSelectSingle[71∈3] ➊<br />ᐸlist_bde_mutationᐳ"}}:::plan
    First68 --> PgSelectSingle71
    PgClassExpression72{{"PgClassExpression[72∈3] ➊<br />ᐸ__list_bde_mutation__.vᐳ"}}:::plan
    PgSelectSingle71 --> PgClassExpression72
    Object73{{"Object[73∈3] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression72 --> Object73
    __Item100[/"__Item[100∈11]<br />ᐸ72ᐳ"\]:::itemplan
    PgClassExpression72 ==> __Item100
    PgSelect81[["PgSelect[81∈4] ➊<br />ᐸlist_bde_mutation(mutation)ᐳ"]]:::sideeffectplan
    Object85{{"Object[85∈4] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    PgFromExpression87{{"PgFromExpression[87∈4] ➊"}}:::plan
    Object85 & PgFromExpression87 & ApplyInput97 --> PgSelect81
    BakedInput80 & Constant104 & Constant108 --> PgFromExpression87
    Access82{{"Access[82∈4] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access84{{"Access[84∈4] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access82 & Access84 --> Object85
    __Value2 --> Access82
    __Value2 --> Access84
    First91{{"First[91∈4] ➊"}}:::plan
    PgSelectRows92[["PgSelectRows[92∈4] ➊"]]:::plan
    PgSelectRows92 --> First91
    PgSelect81 --> PgSelectRows92
    PgSelectSingle94{{"PgSelectSingle[94∈4] ➊<br />ᐸlist_bde_mutationᐳ"}}:::plan
    First91 --> PgSelectSingle94
    PgClassExpression95{{"PgClassExpression[95∈4] ➊<br />ᐸ__list_bde_mutation__.vᐳ"}}:::plan
    PgSelectSingle94 --> PgClassExpression95
    Object96{{"Object[96∈4] ➊<br />ᐸ{result}ᐳ"}}:::plan
    PgClassExpression95 --> Object96
    __Item101[/"__Item[101∈12]<br />ᐸ95ᐳ"\]:::itemplan
    PgClassExpression95 ==> __Item101

    %% define steps
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,__InputObject6,Constant8,BakedInput11,Access13,Access15,Object16,PgFromExpression18,ApplyInput28,__InputObject29,Constant31,BakedInput34,ApplyInput51,__InputObject52,Constant54,BakedInput57,ApplyInput74,__InputObject75,Constant77,BakedInput80,ApplyInput97,Constant102,Constant103,Constant104,Constant105,Constant106,Constant107,Constant108 bucket0
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgSelect12,First22,PgSelectRows23,PgSelectSingle25,PgClassExpression26,Object27 bucket1
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgSelect35,Access36,Access38,Object39,PgFromExpression41,First45,PgSelectRows46,PgSelectSingle48,PgClassExpression49,Object50 bucket2
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgSelect58,Access59,Access61,Object62,PgFromExpression64,First68,PgSelectRows69,PgSelectSingle71,PgClassExpression72,Object73 bucket3
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgSelect81,Access82,Access84,Object85,PgFromExpression87,First91,PgSelectRows92,PgSelectSingle94,PgClassExpression95,Object96 bucket4
    classDef bucket5 stroke:#7fff00
    class Bucket5 bucket5
    classDef bucket6 stroke:#ff1493
    class Bucket6 bucket6
    classDef bucket7 stroke:#808000
    class Bucket7 bucket7
    classDef bucket8 stroke:#dda0dd
    class Bucket8 bucket8
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item98 bucket9
    classDef bucket10 stroke:#ffff00
    class Bucket10,__Item99 bucket10
    classDef bucket11 stroke:#00ffff
    class Bucket11,__Item100 bucket11
    classDef bucket12 stroke:#4169e1
    class Bucket12,__Item101 bucket12

