%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object15{{"Object[15∈0] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access13{{"Access[13∈0] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access14{{"Access[14∈0] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access13 & Access14 --> Object15
    __Value2["__Value[2∈0] ➊<br />ᐸcontextᐳ"]:::plan
    __Value2 --> Access13
    __Value2 --> Access14
    __Value4["__Value[4∈0] ➊<br />ᐸrootValueᐳ"]:::plan
    Constant238{{"Constant[238∈0] ➊<br />ᐸ4ᐳ"}}:::plan
    Constant239{{"Constant[239∈0] ➊<br />ᐸ'A description'ᐳ"}}:::plan
    Constant241{{"Constant[241∈0] ➊<br />ᐸ'A note'ᐳ"}}:::plan
    Constant243{{"Constant[243∈0] ➊<br />ᐸnullᐳ"}}:::plan
    Constant244{{"Constant[244∈0] ➊<br />ᐸ3141592ᐳ"}}:::plan
    PgUpdateSingle12[["PgUpdateSingle[12∈1] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object15 & Constant238 & Constant239 --> PgUpdateSingle12
    PgSelect18[["PgSelect[18∈2] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression16{{"PgClassExpression[16∈2] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object15 & PgClassExpression16 --> PgSelect18
    PgUpdateSingle12 --> PgClassExpression16
    First22{{"First[22∈2] ➊"}}:::plan
    PgSelect18 --> First22
    PgSelectSingle23{{"PgSelectSingle[23∈2] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First22 --> PgSelectSingle23
    PgClassExpression24{{"PgClassExpression[24∈3] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression24
    PgClassExpression25{{"PgClassExpression[25∈3] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression25
    PgClassExpression26{{"PgClassExpression[26∈3] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression26
    PgClassExpression27{{"PgClassExpression[27∈3] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle23 --> PgClassExpression27
    PgSelectSingle34{{"PgSelectSingle[34∈3] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys218{{"RemapKeys[218∈3] ➊<br />ᐸ23:{”0”:7}ᐳ"}}:::plan
    RemapKeys218 --> PgSelectSingle34
    PgClassExpression35{{"PgClassExpression[35∈3] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle34 --> PgClassExpression35
    PgSelectSingle41{{"PgSelectSingle[41∈3] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle23 --> PgSelectSingle41
    PgClassExpression42{{"PgClassExpression[42∈3] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle41 --> PgClassExpression42
    PgSelectSingle55{{"PgSelectSingle[55∈3] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys214{{"RemapKeys[214∈3] ➊<br />ᐸ41:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys214 --> PgSelectSingle55
    PgSelectSingle41 --> RemapKeys214
    PgSelectSingle23 --> RemapKeys218
    PgClassExpression56{{"PgClassExpression[56∈4] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression56
    PgClassExpression57{{"PgClassExpression[57∈4] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle55 --> PgClassExpression57
    PgUpdateSingle64[["PgUpdateSingle[64∈5] ➊<br />ᐸrelational_posts(id;note)ᐳ"]]:::sideeffectplan
    Object67{{"Object[67∈5] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object67 & Constant238 & Constant241 --> PgUpdateSingle64
    Access65{{"Access[65∈5] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access66{{"Access[66∈5] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access65 & Access66 --> Object67
    __Value2 --> Access65
    __Value2 --> Access66
    PgSelect70[["PgSelect[70∈6] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression68{{"PgClassExpression[68∈6] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object67 & PgClassExpression68 --> PgSelect70
    PgUpdateSingle64 --> PgClassExpression68
    First74{{"First[74∈6] ➊"}}:::plan
    PgSelect70 --> First74
    PgSelectSingle75{{"PgSelectSingle[75∈6] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First74 --> PgSelectSingle75
    PgClassExpression76{{"PgClassExpression[76∈7] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression76
    PgClassExpression77{{"PgClassExpression[77∈7] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression77
    PgClassExpression78{{"PgClassExpression[78∈7] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression78
    PgClassExpression79{{"PgClassExpression[79∈7] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle75 --> PgClassExpression79
    PgSelectSingle86{{"PgSelectSingle[86∈7] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys224{{"RemapKeys[224∈7] ➊<br />ᐸ75:{”0”:7}ᐳ"}}:::plan
    RemapKeys224 --> PgSelectSingle86
    PgClassExpression87{{"PgClassExpression[87∈7] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle86 --> PgClassExpression87
    PgSelectSingle93{{"PgSelectSingle[93∈7] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle75 --> PgSelectSingle93
    PgClassExpression94{{"PgClassExpression[94∈7] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle93 --> PgClassExpression94
    PgSelectSingle107{{"PgSelectSingle[107∈7] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys220{{"RemapKeys[220∈7] ➊<br />ᐸ93:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys220 --> PgSelectSingle107
    PgSelectSingle93 --> RemapKeys220
    PgSelectSingle75 --> RemapKeys224
    PgClassExpression108{{"PgClassExpression[108∈8] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle107 --> PgClassExpression108
    PgClassExpression109{{"PgClassExpression[109∈8] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle107 --> PgClassExpression109
    PgUpdateSingle116[["PgUpdateSingle[116∈9] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object119{{"Object[119∈9] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object119 & Constant238 & Constant243 --> PgUpdateSingle116
    Access117{{"Access[117∈9] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access118{{"Access[118∈9] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access117 & Access118 --> Object119
    __Value2 --> Access117
    __Value2 --> Access118
    PgSelect122[["PgSelect[122∈10] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression120{{"PgClassExpression[120∈10] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object119 & PgClassExpression120 --> PgSelect122
    PgUpdateSingle116 --> PgClassExpression120
    First126{{"First[126∈10] ➊"}}:::plan
    PgSelect122 --> First126
    PgSelectSingle127{{"PgSelectSingle[127∈10] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First126 --> PgSelectSingle127
    PgClassExpression128{{"PgClassExpression[128∈11] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle127 --> PgClassExpression128
    PgClassExpression129{{"PgClassExpression[129∈11] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle127 --> PgClassExpression129
    PgClassExpression130{{"PgClassExpression[130∈11] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle127 --> PgClassExpression130
    PgClassExpression131{{"PgClassExpression[131∈11] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle127 --> PgClassExpression131
    PgSelectSingle138{{"PgSelectSingle[138∈11] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys230{{"RemapKeys[230∈11] ➊<br />ᐸ127:{”0”:7}ᐳ"}}:::plan
    RemapKeys230 --> PgSelectSingle138
    PgClassExpression139{{"PgClassExpression[139∈11] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle138 --> PgClassExpression139
    PgSelectSingle145{{"PgSelectSingle[145∈11] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle127 --> PgSelectSingle145
    PgClassExpression146{{"PgClassExpression[146∈11] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle145 --> PgClassExpression146
    PgSelectSingle159{{"PgSelectSingle[159∈11] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys226{{"RemapKeys[226∈11] ➊<br />ᐸ145:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys226 --> PgSelectSingle159
    PgSelectSingle145 --> RemapKeys226
    PgSelectSingle127 --> RemapKeys230
    PgClassExpression160{{"PgClassExpression[160∈12] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle159 --> PgClassExpression160
    PgClassExpression161{{"PgClassExpression[161∈12] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle159 --> PgClassExpression161
    PgUpdateSingle168[["PgUpdateSingle[168∈13] ➊<br />ᐸrelational_posts(id;description)ᐳ"]]:::sideeffectplan
    Object171{{"Object[171∈13] ➊<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Object171 & Constant244 & Constant243 --> PgUpdateSingle168
    Access169{{"Access[169∈13] ➊<br />ᐸ2.pgSettingsᐳ"}}:::plan
    Access170{{"Access[170∈13] ➊<br />ᐸ2.withPgClientᐳ"}}:::plan
    Access169 & Access170 --> Object171
    __Value2 --> Access169
    __Value2 --> Access170
    PgSelect174[["PgSelect[174∈14] ➊<br />ᐸrelational_postsᐳ"]]:::plan
    PgClassExpression172{{"PgClassExpression[172∈14] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    Object171 & PgClassExpression172 --> PgSelect174
    PgUpdateSingle168 --> PgClassExpression172
    First178{{"First[178∈14] ➊"}}:::plan
    PgSelect174 --> First178
    PgSelectSingle179{{"PgSelectSingle[179∈14] ➊<br />ᐸrelational_postsᐳ"}}:::plan
    First178 --> PgSelectSingle179
    PgClassExpression180{{"PgClassExpression[180∈15] ➊<br />ᐸ__relation...sts__.”id”ᐳ"}}:::plan
    PgSelectSingle179 --> PgClassExpression180
    PgClassExpression181{{"PgClassExpression[181∈15] ➊<br />ᐸ__relation...__.”title”ᐳ"}}:::plan
    PgSelectSingle179 --> PgClassExpression181
    PgClassExpression182{{"PgClassExpression[182∈15] ➊<br />ᐸ__relation...scription”ᐳ"}}:::plan
    PgSelectSingle179 --> PgClassExpression182
    PgClassExpression183{{"PgClassExpression[183∈15] ➊<br />ᐸ__relation...s__.”note”ᐳ"}}:::plan
    PgSelectSingle179 --> PgClassExpression183
    PgSelectSingle190{{"PgSelectSingle[190∈15] ➊<br />ᐸtextᐳ"}}:::plan
    RemapKeys236{{"RemapKeys[236∈15] ➊<br />ᐸ179:{”0”:7}ᐳ"}}:::plan
    RemapKeys236 --> PgSelectSingle190
    PgClassExpression191{{"PgClassExpression[191∈15] ➊<br />ᐸ__relation..._lower__.vᐳ"}}:::plan
    PgSelectSingle190 --> PgClassExpression191
    PgSelectSingle197{{"PgSelectSingle[197∈15] ➊<br />ᐸrelational_itemsᐳ"}}:::plan
    PgSelectSingle179 --> PgSelectSingle197
    PgClassExpression198{{"PgClassExpression[198∈15] ➊<br />ᐸ__relation..._archived”ᐳ"}}:::plan
    PgSelectSingle197 --> PgClassExpression198
    PgSelectSingle211{{"PgSelectSingle[211∈15] ➊<br />ᐸpeopleᐳ"}}:::plan
    RemapKeys232{{"RemapKeys[232∈15] ➊<br />ᐸ197:{”0”:1,”1”:2}ᐳ"}}:::plan
    RemapKeys232 --> PgSelectSingle211
    PgSelectSingle197 --> RemapKeys232
    PgSelectSingle179 --> RemapKeys236
    PgClassExpression212{{"PgClassExpression[212∈16] ➊<br />ᐸ__people__.”person_id”ᐳ"}}:::plan
    PgSelectSingle211 --> PgClassExpression212
    PgClassExpression213{{"PgClassExpression[213∈16] ➊<br />ᐸ__people__.”username”ᐳ"}}:::plan
    PgSelectSingle211 --> PgClassExpression213

    %% define steps

    subgraph "Buckets for mutations/basics/update-relational-post"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value2,__Value4,Access13,Access14,Object15,Constant238,Constant239,Constant241,Constant243,Constant244 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 15, 238, 239"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgUpdateSingle12 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 12, 15<br /><br />ROOT PgUpdateSingle{1}ᐸrelational_posts(id;description)ᐳ[12]<br />1: <br />ᐳ: PgClassExpression[16]<br />2: PgSelect[18]<br />ᐳ: First[22], PgSelectSingle[23]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,PgClassExpression16,PgSelect18,First22,PgSelectSingle23 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 23<br /><br />ROOT PgSelectSingle{2}ᐸrelational_postsᐳ[23]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression24,PgClassExpression25,PgClassExpression26,PgClassExpression27,PgSelectSingle34,PgClassExpression35,PgSelectSingle41,PgClassExpression42,PgSelectSingle55,RemapKeys214,RemapKeys218 bucket3
    Bucket4("Bucket 4 (nullableBoundary)<br />Deps: 55<br /><br />ROOT PgSelectSingle{3}ᐸpeopleᐳ[55]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,PgClassExpression56,PgClassExpression57 bucket4
    Bucket5("Bucket 5 (mutationField)<br />Deps: 238, 241, 2<br /><br />1: Access[65]<br />2: Access[66]<br />3: Object[67]<br />4: PgUpdateSingle[64]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgUpdateSingle64,Access65,Access66,Object67 bucket5
    Bucket6("Bucket 6 (nullableBoundary)<br />Deps: 64, 67<br /><br />ROOT PgUpdateSingle{5}ᐸrelational_posts(id;note)ᐳ[64]<br />1: <br />ᐳ: PgClassExpression[68]<br />2: PgSelect[70]<br />ᐳ: First[74], PgSelectSingle[75]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgClassExpression68,PgSelect70,First74,PgSelectSingle75 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 75<br /><br />ROOT PgSelectSingle{6}ᐸrelational_postsᐳ[75]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7,PgClassExpression76,PgClassExpression77,PgClassExpression78,PgClassExpression79,PgSelectSingle86,PgClassExpression87,PgSelectSingle93,PgClassExpression94,PgSelectSingle107,RemapKeys220,RemapKeys224 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 107<br /><br />ROOT PgSelectSingle{7}ᐸpeopleᐳ[107]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression108,PgClassExpression109 bucket8
    Bucket9("Bucket 9 (mutationField)<br />Deps: 238, 243, 2<br /><br />1: Access[117]<br />2: Access[118]<br />3: Object[119]<br />4: PgUpdateSingle[116]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,PgUpdateSingle116,Access117,Access118,Object119 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 116, 119<br /><br />ROOT PgUpdateSingle{9}ᐸrelational_posts(id;description)ᐳ[116]<br />1: <br />ᐳ: PgClassExpression[120]<br />2: PgSelect[122]<br />ᐳ: First[126], PgSelectSingle[127]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression120,PgSelect122,First126,PgSelectSingle127 bucket10
    Bucket11("Bucket 11 (nullableBoundary)<br />Deps: 127<br /><br />ROOT PgSelectSingle{10}ᐸrelational_postsᐳ[127]"):::bucket
    classDef bucket11 stroke:#00ffff
    class Bucket11,PgClassExpression128,PgClassExpression129,PgClassExpression130,PgClassExpression131,PgSelectSingle138,PgClassExpression139,PgSelectSingle145,PgClassExpression146,PgSelectSingle159,RemapKeys226,RemapKeys230 bucket11
    Bucket12("Bucket 12 (nullableBoundary)<br />Deps: 159<br /><br />ROOT PgSelectSingle{11}ᐸpeopleᐳ[159]"):::bucket
    classDef bucket12 stroke:#4169e1
    class Bucket12,PgClassExpression160,PgClassExpression161 bucket12
    Bucket13("Bucket 13 (mutationField)<br />Deps: 244, 243, 2<br /><br />1: Access[169]<br />2: Access[170]<br />3: Object[171]<br />4: PgUpdateSingle[168]"):::bucket
    classDef bucket13 stroke:#3cb371
    class Bucket13,PgUpdateSingle168,Access169,Access170,Object171 bucket13
    Bucket14("Bucket 14 (nullableBoundary)<br />Deps: 168, 171<br /><br />ROOT PgUpdateSingle{13}ᐸrelational_posts(id;description)ᐳ[168]<br />1: <br />ᐳ: PgClassExpression[172]<br />2: PgSelect[174]<br />ᐳ: First[178], PgSelectSingle[179]"):::bucket
    classDef bucket14 stroke:#a52a2a
    class Bucket14,PgClassExpression172,PgSelect174,First178,PgSelectSingle179 bucket14
    Bucket15("Bucket 15 (nullableBoundary)<br />Deps: 179<br /><br />ROOT PgSelectSingle{14}ᐸrelational_postsᐳ[179]"):::bucket
    classDef bucket15 stroke:#ff00ff
    class Bucket15,PgClassExpression180,PgClassExpression181,PgClassExpression182,PgClassExpression183,PgSelectSingle190,PgClassExpression191,PgSelectSingle197,PgClassExpression198,PgSelectSingle211,RemapKeys232,RemapKeys236 bucket15
    Bucket16("Bucket 16 (nullableBoundary)<br />Deps: 211<br /><br />ROOT PgSelectSingle{15}ᐸpeopleᐳ[211]"):::bucket
    classDef bucket16 stroke:#f5deb3
    class Bucket16,PgClassExpression212,PgClassExpression213 bucket16
    Bucket0 --> Bucket1 & Bucket5 & Bucket9 & Bucket13
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4
    Bucket5 --> Bucket6
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket9 --> Bucket10
    Bucket10 --> Bucket11
    Bucket11 --> Bucket12
    Bucket13 --> Bucket14
    Bucket14 --> Bucket15
    Bucket15 --> Bucket16
    end
