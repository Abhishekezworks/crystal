graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:3px,color:#000
    classDef itemplan fill:#fff,stroke-width:6px,color:#000
    classDef sideeffectplan fill:#f00,stroke-width:6px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:6px,text-align:left


    %% define steps
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    __InputStaticLeaf14["__InputStaticLeaf[14∈0]"]:::plan
    Access21["Access[21∈0]<br />ᐸ3.pgSettingsᐳ"]:::plan
    Access22["Access[22∈0]<br />ᐸ3.withPgClientᐳ"]:::plan
    Object23["Object[23∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"]:::plan
    Connection24["Connection[24∈0]<br />ᐸ20ᐳ"]:::plan
    __InputStaticLeaf33["__InputStaticLeaf[33∈0]"]:::plan
    Connection42["Connection[42∈0]<br />ᐸ38ᐳ"]:::plan
    __InputStaticLeaf52["__InputStaticLeaf[52∈0]"]:::plan
    Connection60["Connection[60∈0]<br />ᐸ56ᐳ"]:::plan
    PgPageInfo61["PgPageInfo[61∈0]"]:::plan
    PgSelect62[["PgSelect[62∈0]<br />ᐸnetworkᐳ"]]:::plan
    First63["First[63∈0]"]:::plan
    PgSelectSingle64["PgSelectSingle[64∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression65["PgClassExpression[65∈0]<br />ᐸcount(*)ᐳ"]:::plan
    PgSelect66[["PgSelect[66∈0]<br />ᐸnetworkᐳ"]]:::plan
    First68["First[68∈0]"]:::plan
    PgSelectSingle69["PgSelectSingle[69∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression71["PgClassExpression[71∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List72["List[72∈0]<br />ᐸ71ᐳ"]:::plan
    PgCursor70["PgCursor[70∈0]"]:::plan
    Last74["Last[74∈0]"]:::plan
    PgSelectSingle75["PgSelectSingle[75∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression77["PgClassExpression[77∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List78["List[78∈0]<br />ᐸ77ᐳ"]:::plan
    PgCursor76["PgCursor[76∈0]"]:::plan
    Constant79["Constant[79∈0]"]:::plan
    Constant80["Constant[80∈0]"]:::plan
    __Item81>"__Item[81∈1]<br />ᐸ66ᐳ"]:::itemplan
    PgSelectSingle82["PgSelectSingle[82∈1]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression84["PgClassExpression[84∈1]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List85["List[85∈1]<br />ᐸ84ᐳ"]:::plan
    PgCursor83["PgCursor[83∈1]"]:::plan
    PgClassExpression87["PgClassExpression[87∈1]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression88["PgClassExpression[88∈1]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression89["PgClassExpression[89∈1]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan
    PgPageInfo90["PgPageInfo[90∈0]"]:::plan
    PgSelect91[["PgSelect[91∈0]<br />ᐸnetworkᐳ"]]:::plan
    First92["First[92∈0]"]:::plan
    PgSelectSingle93["PgSelectSingle[93∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression94["PgClassExpression[94∈0]<br />ᐸcount(*)ᐳ"]:::plan
    PgSelect95[["PgSelect[95∈0]<br />ᐸnetworkᐳ"]]:::plan
    First97["First[97∈0]"]:::plan
    PgSelectSingle98["PgSelectSingle[98∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression100["PgClassExpression[100∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List101["List[101∈0]<br />ᐸ100ᐳ"]:::plan
    PgCursor99["PgCursor[99∈0]"]:::plan
    Last103["Last[103∈0]"]:::plan
    PgSelectSingle104["PgSelectSingle[104∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression106["PgClassExpression[106∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List107["List[107∈0]<br />ᐸ106ᐳ"]:::plan
    PgCursor105["PgCursor[105∈0]"]:::plan
    Constant108["Constant[108∈0]"]:::plan
    Constant109["Constant[109∈0]"]:::plan
    __Item110>"__Item[110∈2]<br />ᐸ95ᐳ"]:::itemplan
    PgSelectSingle111["PgSelectSingle[111∈2]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression113["PgClassExpression[113∈2]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List114["List[114∈2]<br />ᐸ113ᐳ"]:::plan
    PgCursor112["PgCursor[112∈2]"]:::plan
    PgClassExpression116["PgClassExpression[116∈2]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression117["PgClassExpression[117∈2]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression118["PgClassExpression[118∈2]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan
    PgPageInfo119["PgPageInfo[119∈0]"]:::plan
    PgSelect120[["PgSelect[120∈0]<br />ᐸnetworkᐳ"]]:::plan
    First121["First[121∈0]"]:::plan
    PgSelectSingle122["PgSelectSingle[122∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression123["PgClassExpression[123∈0]<br />ᐸcount(*)ᐳ"]:::plan
    PgSelect124[["PgSelect[124∈0]<br />ᐸnetworkᐳ"]]:::plan
    First126["First[126∈0]"]:::plan
    PgSelectSingle127["PgSelectSingle[127∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression129["PgClassExpression[129∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List130["List[130∈0]<br />ᐸ129ᐳ"]:::plan
    PgCursor128["PgCursor[128∈0]"]:::plan
    Last132["Last[132∈0]"]:::plan
    PgSelectSingle133["PgSelectSingle[133∈0]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression135["PgClassExpression[135∈0]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List136["List[136∈0]<br />ᐸ135ᐳ"]:::plan
    PgCursor134["PgCursor[134∈0]"]:::plan
    Constant137["Constant[137∈0]"]:::plan
    Constant138["Constant[138∈0]"]:::plan
    __Item139>"__Item[139∈3]<br />ᐸ124ᐳ"]:::itemplan
    PgSelectSingle140["PgSelectSingle[140∈3]<br />ᐸnetworkᐳ"]:::plan
    PgClassExpression142["PgClassExpression[142∈3]<br />ᐸ__network__.”id”ᐳ"]:::plan
    List143["List[143∈3]<br />ᐸ142ᐳ"]:::plan
    PgCursor141["PgCursor[141∈3]"]:::plan
    PgClassExpression145["PgClassExpression[145∈3]<br />ᐸ__network__.”inet”ᐳ"]:::plan
    PgClassExpression146["PgClassExpression[146∈3]<br />ᐸ__network__.”cidr”ᐳ"]:::plan
    PgClassExpression147["PgClassExpression[147∈3]<br />ᐸ__network__.”macaddr”ᐳ"]:::plan

    %% plan dependencies
    __Value3 --> Access21
    __Value3 --> Access22
    Access21 & Access22 --> Object23
    Object23 & __InputStaticLeaf14 & Connection24 --> PgSelect62
    PgSelect62 --> First63
    First63 --> PgSelectSingle64
    PgSelectSingle64 --> PgClassExpression65
    Object23 & __InputStaticLeaf14 & Connection24 --> PgSelect66
    PgSelect66 --> First68
    First68 --> PgSelectSingle69
    PgSelectSingle69 --> PgClassExpression71
    PgClassExpression71 --> List72
    List72 --> PgCursor70
    PgSelect66 --> Last74
    Last74 --> PgSelectSingle75
    PgSelectSingle75 --> PgClassExpression77
    PgClassExpression77 --> List78
    List78 --> PgCursor76
    PgSelect66 ==> __Item81
    __Item81 --> PgSelectSingle82
    PgSelectSingle82 --> PgClassExpression84
    PgClassExpression84 --> List85
    List85 --> PgCursor83
    PgSelectSingle82 --> PgClassExpression87
    PgSelectSingle82 --> PgClassExpression88
    PgSelectSingle82 --> PgClassExpression89
    Object23 & __InputStaticLeaf33 & Connection42 --> PgSelect91
    PgSelect91 --> First92
    First92 --> PgSelectSingle93
    PgSelectSingle93 --> PgClassExpression94
    Object23 & __InputStaticLeaf33 & Connection42 --> PgSelect95
    PgSelect95 --> First97
    First97 --> PgSelectSingle98
    PgSelectSingle98 --> PgClassExpression100
    PgClassExpression100 --> List101
    List101 --> PgCursor99
    PgSelect95 --> Last103
    Last103 --> PgSelectSingle104
    PgSelectSingle104 --> PgClassExpression106
    PgClassExpression106 --> List107
    List107 --> PgCursor105
    PgSelect95 ==> __Item110
    __Item110 --> PgSelectSingle111
    PgSelectSingle111 --> PgClassExpression113
    PgClassExpression113 --> List114
    List114 --> PgCursor112
    PgSelectSingle111 --> PgClassExpression116
    PgSelectSingle111 --> PgClassExpression117
    PgSelectSingle111 --> PgClassExpression118
    Object23 & __InputStaticLeaf52 & Connection60 --> PgSelect120
    PgSelect120 --> First121
    First121 --> PgSelectSingle122
    PgSelectSingle122 --> PgClassExpression123
    Object23 & __InputStaticLeaf52 & Connection60 --> PgSelect124
    PgSelect124 --> First126
    First126 --> PgSelectSingle127
    PgSelectSingle127 --> PgClassExpression129
    PgClassExpression129 --> List130
    List130 --> PgCursor128
    PgSelect124 --> Last132
    Last132 --> PgSelectSingle133
    PgSelectSingle133 --> PgClassExpression135
    PgClassExpression135 --> List136
    List136 --> PgCursor134
    PgSelect124 ==> __Item139
    __Item139 --> PgSelectSingle140
    PgSelectSingle140 --> PgClassExpression142
    PgClassExpression142 --> List143
    List143 --> PgCursor141
    PgSelectSingle140 --> PgClassExpression145
    PgSelectSingle140 --> PgClassExpression146
    PgSelectSingle140 --> PgClassExpression147

    %% plan-to-path relationships

    subgraph "Buckets for queries/v4/network_types"
    Bucket0("Bucket 0<br />(root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value3,__Value5,__InputStaticLeaf14,Access21,Access22,Object23,Connection24,__InputStaticLeaf33,Connection42,__InputStaticLeaf52,Connection60,PgPageInfo61,PgSelect62,First63,PgSelectSingle64,PgClassExpression65,PgSelect66,First68,PgSelectSingle69,PgCursor70,PgClassExpression71,List72,Last74,PgSelectSingle75,PgCursor76,PgClassExpression77,List78,Constant79,Constant80,PgPageInfo90,PgSelect91,First92,PgSelectSingle93,PgClassExpression94,PgSelect95,First97,PgSelectSingle98,PgCursor99,PgClassExpression100,List101,Last103,PgSelectSingle104,PgCursor105,PgClassExpression106,List107,Constant108,Constant109,PgPageInfo119,PgSelect120,First121,PgSelectSingle122,PgClassExpression123,PgSelect124,First126,PgSelectSingle127,PgCursor128,PgClassExpression129,List130,Last132,PgSelectSingle133,PgCursor134,PgClassExpression135,List136,Constant137,Constant138 bucket0
    Bucket1("Bucket 1<br />(listItem)<br />Deps: 66<br /><br />ROOT __Item{1}ᐸ66ᐳ[81]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,__Item81,PgSelectSingle82,PgCursor83,PgClassExpression84,List85,PgClassExpression87,PgClassExpression88,PgClassExpression89 bucket1
    Bucket2("Bucket 2<br />(listItem)<br />Deps: 95<br /><br />ROOT __Item{2}ᐸ95ᐳ[110]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2,__Item110,PgSelectSingle111,PgCursor112,PgClassExpression113,List114,PgClassExpression116,PgClassExpression117,PgClassExpression118 bucket2
    Bucket3("Bucket 3<br />(listItem)<br />Deps: 124<br /><br />ROOT __Item{3}ᐸ124ᐳ[139]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,__Item139,PgSelectSingle140,PgCursor141,PgClassExpression142,List143,PgClassExpression145,PgClassExpression146,PgClassExpression147 bucket3
    Bucket0 --> Bucket1 & Bucket2 & Bucket3
    end
